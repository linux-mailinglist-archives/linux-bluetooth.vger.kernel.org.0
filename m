Return-Path: <linux-bluetooth-owner@vger.kernel.org>
X-Original-To: lists+linux-bluetooth@lfdr.de
Delivered-To: lists+linux-bluetooth@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 96B444D8D6
	for <lists+linux-bluetooth@lfdr.de>; Thu, 20 Jun 2019 20:30:40 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1727488AbfFTSCp (ORCPT <rfc822;lists+linux-bluetooth@lfdr.de>);
        Thu, 20 Jun 2019 14:02:45 -0400
Received: from mga01.intel.com ([192.55.52.88]:43435 "EHLO mga01.intel.com"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1726996AbfFTSCo (ORCPT <rfc822;linux-bluetooth@vger.kernel.org>);
        Thu, 20 Jun 2019 14:02:44 -0400
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga005.jf.intel.com ([10.7.209.41])
  by fmsmga101.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 20 Jun 2019 11:02:30 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,397,1557212400"; 
   d="scan'208";a="335576222"
Received: from orsmsx109.amr.corp.intel.com ([10.22.240.7])
  by orsmga005.jf.intel.com with ESMTP; 20 Jun 2019 11:02:29 -0700
Received: from orsmsx115.amr.corp.intel.com (10.22.240.11) by
 ORSMSX109.amr.corp.intel.com (10.22.240.7) with Microsoft SMTP Server (TLS)
 id 14.3.439.0; Thu, 20 Jun 2019 11:02:29 -0700
Received: from orsmsx103.amr.corp.intel.com ([169.254.5.135]) by
 ORSMSX115.amr.corp.intel.com ([169.254.4.13]) with mapi id 14.03.0439.000;
 Thu, 20 Jun 2019 11:02:29 -0700
From:   "Gix, Brian" <brian.gix@intel.com>
To:     "michal.lowas-rzechonek@silvair.com" 
        <michal.lowas-rzechonek@silvair.com>,
        "linux-bluetooth@vger.kernel.org" <linux-bluetooth@vger.kernel.org>
CC:     "Stotland, Inga" <inga.stotland@intel.com>
Subject: Re: [PATCH BlueZ 1/1] mesh: Move HCI handling to mesh-io-generic
Thread-Topic: [PATCH BlueZ 1/1] mesh: Move HCI handling to mesh-io-generic
Thread-Index: AQHVJcjDD6YNUyw2LEWkDp7JLm+F+6alTmkA
Date:   Thu, 20 Jun 2019 18:02:28 +0000
Message-ID: <1561053746.4417.14.camel@intel.com>
References: <20190618112655.19963-1-michal.lowas-rzechonek@silvair.com>
         <20190618112655.19963-2-michal.lowas-rzechonek@silvair.com>
In-Reply-To: <20190618112655.19963-2-michal.lowas-rzechonek@silvair.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [10.254.184.211]
Content-Type: text/plain; charset="utf-8"
Content-ID: <073B965F19878B469C4DEB9FF685CFF5@intel.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
Sender: linux-bluetooth-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-bluetooth.vger.kernel.org>
X-Mailing-List: linux-bluetooth@vger.kernel.org

SGkgTWljaGHFgiwgSSBsaWtlIHdoZXJlIHlvdSBhcmUgZ29pbmcgd2l0aCB0aGlzLg0KDQpPbiBU
dWUsIDIwMTktMDYtMTggYXQgMTM6MjYgKzAyMDAsIE1pY2hhxYIgTG93YXMtUnplY2hvbmVrIHdy
b3RlOg0KPiBUaGlzIHBhdGNoIHNlcGFyYXRlcyAnbWVzaCcgbW9kdWxlIGZyb20gJ21lc2hfaW8n
LCBwYXJ0aWN1bGFybHkNCj4gcmVnYXJkaW5nIGNvbmZpZ3VyYXRpb24gYW5kIGluaXRpYWxpemF0
aW9uLg0KPiANCj4gTWFpbiBjb2RlIGlzIG5vIGxvbmdlciBhd2FyZSBvZiBNR01UIGFuZCBIQ0kg
dXNhZ2UgLSBxdWVyeWluZyBhdmFpbGFibGUNCj4gSENJIGludGVyZmFjZXMgbm93IGhhcHBlbnMg
aW4gbWVzaC1pby1nZW5lcmljLg0KPiAtLS0NCj4gIG1lc2gvbWFpbi5jICAgICAgICAgICAgfCAg
IDQgKy0NCj4gIG1lc2gvbWVzaC1pby1hcGkuaCAgICAgfCAgIDMgKy0NCj4gIG1lc2gvbWVzaC1p
by1nZW5lcmljLmMgfCAyMDMgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0t
LS0NCj4gIG1lc2gvbWVzaC1pby5jICAgICAgICAgfCAgMTcgKystLQ0KPiAgbWVzaC9tZXNoLWlv
LmggICAgICAgICB8ICAgMiArLQ0KPiAgbWVzaC9tZXNoLmMgICAgICAgICAgICB8IDE4OSArKyst
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KPiAgbWVzaC9tZXNoLmggICAgICAg
ICAgICB8ICAgNCArLQ0KPiAgNyBmaWxlcyBjaGFuZ2VkLCAyMDkgaW5zZXJ0aW9ucygrKSwgMjEz
IGRlbGV0aW9ucygtKQ0KPiANCj4gZGlmZiAtLWdpdCBhL21lc2gvbWFpbi5jIGIvbWVzaC9tYWlu
LmMNCj4gaW5kZXggM2NlY2Q4ZmJmLi4yNjJlM2RhNDggMTAwNjQ0DQo+IC0tLSBhL21lc2gvbWFp
bi5jDQo+ICsrKyBiL21lc2gvbWFpbi5jDQo+IEBAIC0zNSw2ICszNSw3IEBADQo+ICANCj4gICNp
bmNsdWRlICJtZXNoL21lc2guaCINCj4gICNpbmNsdWRlICJtZXNoL2RidXMuaCINCj4gKyNpbmNs
dWRlICJtZXNoL21lc2gtaW8uaCINCj4gIA0KPiAgc3RhdGljIGNvbnN0IHN0cnVjdCBvcHRpb24g
bWFpbl9vcHRpb25zW10gPSB7DQo+ICAJeyAiaW5kZXgiLAlyZXF1aXJlZF9hcmd1bWVudCwJTlVM
TCwgJ2knIH0sDQo+IEBAIC0xNjYsNyArMTY3LDggQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIg
KmFyZ3ZbXSkNCj4gIAkJfQ0KPiAgCX0NCj4gIA0KPiAtCWlmICghbWVzaF9pbml0KGluZGV4LCBj
b25maWdfZGlyKSkgew0KPiArDQo+ICsJaWYgKCFtZXNoX2luaXQoY29uZmlnX2RpciwgTUVTSF9J
T19UWVBFX0dFTkVSSUMsICZpbmRleCkpIHsNCj4gIAkJbF9lcnJvcigiRmFpbGVkIHRvIGluaXRp
YWxpemUgbWVzaCIpOw0KPiAgCQlzdGF0dXMgPSBFWElUX0ZBSUxVUkU7DQo+ICAJCWdvdG8gZG9u
ZTsNCj4gZGlmZiAtLWdpdCBhL21lc2gvbWVzaC1pby1hcGkuaCBiL21lc2gvbWVzaC1pby1hcGku
aA0KPiBpbmRleCBhY2YxMjQ0NWQuLjRjZGYxZjgwYSAxMDA2NDQNCj4gLS0tIGEvbWVzaC9tZXNo
LWlvLWFwaS5oDQo+ICsrKyBiL21lc2gvbWVzaC1pby1hcGkuaA0KPiBAQCAtMTksNyArMTksNyBA
QA0KPiAgDQo+ICBzdHJ1Y3QgbWVzaF9pb19wcml2YXRlOw0KPiAgDQo+IC10eXBlZGVmIGJvb2wg
KCptZXNoX2lvX2luaXRfdCkodWludDE2X3QgaW5kZXgsIHN0cnVjdCBtZXNoX2lvICppbyk7DQo+
ICt0eXBlZGVmIGJvb2wgKCptZXNoX2lvX2luaXRfdCkoc3RydWN0IG1lc2hfaW8gKmlvLCB2b2lk
ICpvcHRzKTsNCj4gIHR5cGVkZWYgYm9vbCAoKm1lc2hfaW9fZGVzdHJveV90KShzdHJ1Y3QgbWVz
aF9pbyAqaW8pOw0KPiAgdHlwZWRlZiBib29sICgqbWVzaF9pb19jYXBzX3QpKHN0cnVjdCBtZXNo
X2lvICppbywgc3RydWN0IG1lc2hfaW9fY2FwcyAqY2Fwcyk7DQo+ICB0eXBlZGVmIGJvb2wgKCpt
ZXNoX2lvX3NlbmRfdCkoc3RydWN0IG1lc2hfaW8gKmlvLA0KPiBAQCAtNDcsNyArNDcsNiBAQCBz
dHJ1Y3QgbWVzaF9pb19hcGkgew0KPiAgDQo+ICBzdHJ1Y3QgbWVzaF9pbyB7DQo+ICAJZW51bSBt
ZXNoX2lvX3R5cGUJCXR5cGU7DQo+IC0JdWludDE2X3QJCQlpbmRleDsNCj4gIAljb25zdCBzdHJ1
Y3QgbWVzaF9pb19hcGkJKmFwaTsNCj4gIAlzdHJ1Y3QgbWVzaF9pb19wcml2YXRlCQkqcHZ0Ow0K
PiAgfTsNCj4gZGlmZiAtLWdpdCBhL21lc2gvbWVzaC1pby1nZW5lcmljLmMgYi9tZXNoL21lc2gt
aW8tZ2VuZXJpYy5jDQo+IGluZGV4IDc1NmRjZWFiYy4uNWJmZTQwNzAwIDEwMDY0NA0KPiAtLS0g
YS9tZXNoL21lc2gtaW8tZ2VuZXJpYy5jDQo+ICsrKyBiL21lc2gvbWVzaC1pby1nZW5lcmljLmMN
Cj4gQEAgLTI2LDYgKzI2LDkgQEANCj4gIA0KPiAgI2luY2x1ZGUgIm1vbml0b3IvYnQuaCINCj4g
ICNpbmNsdWRlICJzcmMvc2hhcmVkL2hjaS5oIg0KPiArI2luY2x1ZGUgImxpYi9ibHVldG9vdGgu
aCINCj4gKyNpbmNsdWRlICJsaWIvbWdtdC5oIg0KPiArI2luY2x1ZGUgInNyYy9zaGFyZWQvbWdt
dC5oIg0KPiAgDQo+ICAjaW5jbHVkZSAibWVzaC9tZXNoLWlvLmgiDQo+ICAjaW5jbHVkZSAibWVz
aC9tZXNoLWlvLWFwaS5oIg0KPiBAQCAtNjgsNiArNzEsMTkgQEAgc3RydWN0IHR4X3BhdHRlcm4g
ew0KPiAgCXVpbnQ4X3QJCQkJbGVuOw0KPiAgfTsNCj4gIA0KPiArc3RydWN0IHJlYWRfaW5mb19y
ZXEgew0KPiArCWludCBpbmRleDsNCj4gKwlzdHJ1Y3QgbWVzaF9pbyAqaW87DQo+ICt9Ow0KPiAr
DQo+ICtzdGF0aWMgc3RydWN0IGxfcXVldWUgKmNvbnRyb2xsZXJzOw0KPiArc3RhdGljIHN0cnVj
dCBtZ210ICptZ210X21lc2g7DQo+ICsNCj4gK3N0YXRpYyBib29sIHNpbXBsZV9tYXRjaChjb25z
dCB2b2lkICphLCBjb25zdCB2b2lkICpiKQ0KPiArew0KPiArCXJldHVybiBhID09IGI7DQo+ICt9
DQo+ICsNCj4gIHN0YXRpYyB1aW50MzJfdCBnZXRfaW5zdGFudCh2b2lkKQ0KPiAgew0KPiAgCXN0
cnVjdCB0aW1ldmFsIHRtOw0KPiBAQCAtMjc4LDQwICsyOTQsMTc5IEBAIHN0YXRpYyB2b2lkIGNv
bmZpZ3VyZV9oY2koc3RydWN0IG1lc2hfaW9fcHJpdmF0ZSAqaW8pDQo+ICAJCQkJc2l6ZW9mKGNt
ZCksIGhjaV9nZW5lcmljX2NhbGxiYWNrLCBOVUxMLCBOVUxMKTsNCj4gIH0NCj4gIA0KPiAtc3Rh
dGljIGJvb2wgZGV2X2luaXQodWludDE2X3QgaW5kZXgsIHN0cnVjdCBtZXNoX2lvICppbykNCj4g
K3N0YXRpYyBib29sIGhjaV9pbml0KHN0cnVjdCBtZXNoX2lvICppbykNCj4gIHsNCj4gLQlzdHJ1
Y3QgbWVzaF9pb19wcml2YXRlICp0bXA7DQo+IC0NCj4gLQlpZiAoIWlvIHx8IGlvLT5wdnQpDQo+
ICsJaW8tPnB2dC0+aGNpID0gYnRfaGNpX25ld191c2VyX2NoYW5uZWwoaW8tPnB2dC0+aW5kZXgp
Ow0KPiArCWlmICghaW8tPnB2dC0+aGNpKSB7DQo+ICsJCWxfZXJyb3IoIkZhaWxlZCB0byBzdGFy
dCBtZXNoIGlvIChoY2kgJXUpIiwgaW8tPnB2dC0+aW5kZXgpOw0KPiAgCQlyZXR1cm4gZmFsc2U7
DQo+ICsJfQ0KPiAgDQo+IC0JdG1wID0gbF9uZXcoc3RydWN0IG1lc2hfaW9fcHJpdmF0ZSwgMSk7
DQo+ICsJY29uZmlndXJlX2hjaShpby0+cHZ0KTsNCj4gIA0KPiAtCWlmICh0bXAgPT0gTlVMTCkN
Cj4gLQkJcmV0dXJuIGZhbHNlOw0KPiArCWJ0X2hjaV9yZWdpc3Rlcihpby0+cHZ0LT5oY2ksIEJU
X0hDSV9FVlRfTEVfTUVUQV9FVkVOVCwNCj4gKwkJCQkJCWV2ZW50X2NhbGxiYWNrLCBpbywgTlVM
TCk7DQo+ICANCj4gLQl0bXAtPnJ4X3JlZ3MgPSBsX3F1ZXVlX25ldygpOw0KPiAtCXRtcC0+dHhf
cGt0cyA9IGxfcXVldWVfbmV3KCk7DQo+IC0JaWYgKCF0bXAtPnJ4X3JlZ3MgfHwgIXRtcC0+dHhf
cGt0cykNCj4gLQkJZ290byBmYWlsOw0KPiArCWxfZGVidWcoIlN0YXJ0ZWQgbWVzaCBvbiBoY2kg
JXUiLCBpby0+cHZ0LT5pbmRleCk7DQo+ICsJcmV0dXJuIHRydWU7DQo+ICt9DQo+ICANCj4gLQl0
bXAtPmhjaSA9IGJ0X2hjaV9uZXdfdXNlcl9jaGFubmVsKGluZGV4KTsNCj4gLQlpZiAoIXRtcC0+
aGNpKQ0KPiAtCQlnb3RvIGZhaWw7DQo+ICtzdGF0aWMgdm9pZCByZWFkX2luZm9fY2IodWludDhf
dCBzdGF0dXMsIHVpbnQxNl90IGxlbmd0aCwNCj4gKwkJCQkJY29uc3Qgdm9pZCAqcGFyYW0sIHZv
aWQgKnVzZXJfZGF0YSkNCj4gK3sNCj4gKwlzdHJ1Y3QgcmVhZF9pbmZvX3JlcSAqcmVxID0gdXNl
cl9kYXRhOw0KPiArCWNvbnN0IHN0cnVjdCBtZ210X3JwX3JlYWRfaW5mbyAqcnAgPSBwYXJhbTsN
Cj4gKwl1aW50MzJfdCBjdXJyZW50X3NldHRpbmdzLCBzdXBwb3J0ZWRfc2V0dGluZ3M7DQo+ICAN
Cj4gLQljb25maWd1cmVfaGNpKHRtcCk7DQo+ICsJbF9kZWJ1ZygiaGNpICV1IHN0YXR1cyAweCUw
MngiLCByZXEtPmluZGV4LCBzdGF0dXMpOw0KPiAgDQo+IC0JYnRfaGNpX3JlZ2lzdGVyKHRtcC0+
aGNpLCBCVF9IQ0lfRVZUX0xFX01FVEFfRVZFTlQsDQo+IC0JCQkJCQlldmVudF9jYWxsYmFjaywg
aW8sIE5VTEwpOw0KPiArCWlmIChzdGF0dXMgIT0gTUdNVF9TVEFUVVNfU1VDQ0VTUykgew0KPiAr
CQlsX2Vycm9yKCJGYWlsZWQgdG8gcmVhZCBpbmZvIGZvciBoY2kgaW5kZXggJXU6ICVzICgweCUw
MngpIiwNCj4gKwkJCQlyZXEtPmluZGV4LCBtZ210X2VycnN0cihzdGF0dXMpLCBzdGF0dXMpOw0K
PiArCQlyZXR1cm47DQo+ICsJfQ0KPiArDQo+ICsJaWYgKGxlbmd0aCA8IHNpemVvZigqcnApKSB7
DQo+ICsJCWxfZXJyb3IoIlJlYWQgaW5mbyByZXNwb25zZSB0b28gc2hvcnQiKTsNCj4gKwkJcmV0
dXJuOw0KPiArCX0NCj4gKw0KPiArCWN1cnJlbnRfc2V0dGluZ3MgPSBidG9obChycC0+Y3VycmVu
dF9zZXR0aW5ncyk7DQo+ICsJc3VwcG9ydGVkX3NldHRpbmdzID0gYnRvaGwocnAtPnN1cHBvcnRl
ZF9zZXR0aW5ncyk7DQo+ICsNCj4gKwlsX2RlYnVnKCJzZXR0aW5nczogc3VwcCAlOC44eCBjdXJy
ICU4Ljh4IiwNCj4gKwkJCQkJc3VwcG9ydGVkX3NldHRpbmdzLCBjdXJyZW50X3NldHRpbmdzKTsN
Cj4gKw0KPiArCWlmIChjdXJyZW50X3NldHRpbmdzICYgTUdNVF9TRVRUSU5HX1BPV0VSRUQpIHsN
Cj4gKwkJbF9pbmZvKCJDb250cm9sbGVyIGhjaSAldSBpcyBpbiB1c2UiLCByZXEtPmluZGV4KTsN
Cj4gKwkJcmV0dXJuOw0KPiArCX0NCj4gKw0KPiArCWlmICghKHN1cHBvcnRlZF9zZXR0aW5ncyAm
IE1HTVRfU0VUVElOR19MRSkpIHsNCj4gKwkJbF9pbmZvKCJDb250cm9sbGVyIGhjaSAldSBkb2Vz
IG5vdCBzdXBwb3J0IExFIiwgcmVxLT5pbmRleCk7DQo+ICsJCXJldHVybjsNCj4gKwl9DQo+ICsN
Cj4gKwlpZiAocmVxLT5pby0+cHZ0LT5pbmRleCAhPSBNR01UX0lOREVYX05PTkUgJiYNCj4gKwkJ
CQkJcmVxLT5pbmRleCAhPSByZXEtPmlvLT5wdnQtPmluZGV4KSB7DQo+ICsJCWxfZGVidWcoIkln
bm9yZSBpbmRleCAlZCIsIHJlcS0+aW5kZXgpOw0KPiArCQlyZXR1cm47DQo+ICsJfQ0KPiArDQo+
ICsJcmVxLT5pby0+cHZ0LT5pbmRleCA9IHJlcS0+aW5kZXg7DQo+ICsJaGNpX2luaXQocmVxLT5p
byk7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIGluZGV4X2FkZGVkKHVpbnQxNl90IGluZGV4
LCB1aW50MTZfdCBsZW5ndGgsIGNvbnN0IHZvaWQgKnBhcmFtLA0KPiArCQkJCQkJCXZvaWQgKnVz
ZXJfZGF0YSkNCj4gK3sNCj4gKwlzdHJ1Y3QgcmVhZF9pbmZvX3JlcSAqcmVxOw0KPiArCXN0cnVj
dCBtZXNoX2lvICppbyA9IHVzZXJfZGF0YTsNCj4gKw0KPiArCWlmIChpby0+cHZ0LT5pbmRleCAh
PSBNR01UX0lOREVYX05PTkUgJiYNCj4gKwkJCQkJaW5kZXggIT0gaW8tPnB2dC0+aW5kZXgpIHsN
Cj4gKwkJbF9kZWJ1ZygiSWdub3JlIGluZGV4ICVkIiwgaW5kZXgpOw0KPiArCQlyZXR1cm47DQo+
ICsJfQ0KPiArDQo+ICsJaWYgKGxfcXVldWVfZmluZChjb250cm9sbGVycywgc2ltcGxlX21hdGNo
LCBMX1VJTlRfVE9fUFRSKGluZGV4KSkpDQo+ICsJCXJldHVybjsNCj4gKw0KPiArCWxfcXVldWVf
cHVzaF90YWlsKGNvbnRyb2xsZXJzLCBMX1VJTlRfVE9fUFRSKGluZGV4KSk7DQo+ICsNCj4gKwly
ZXEgPSBsX25ldyhzdHJ1Y3QgcmVhZF9pbmZvX3JlcSwgMSk7DQo+ICsJcmVxLT5pbmRleCA9IGlu
ZGV4Ow0KPiArCXJlcS0+aW8gPSBpbzsNCj4gKw0KPiArCWlmIChtZ210X3NlbmQobWdtdF9tZXNo
LCBNR01UX09QX1JFQURfSU5GTywgaW5kZXgsIDAsIE5VTEwsDQo+ICsJCQlyZWFkX2luZm9fY2Is
IHJlcSwgTlVMTCkgIT0gMCkNCj4gKwkJcmV0dXJuOw0KPiArDQo+ICsJbF9xdWV1ZV9yZW1vdmUo
Y29udHJvbGxlcnMsIExfVUlOVF9UT19QVFIoaW5kZXgpKTsNCj4gK30NCj4gKw0KPiArc3RhdGlj
IHZvaWQgaW5kZXhfcmVtb3ZlZCh1aW50MTZfdCBpbmRleCwgdWludDE2X3QgbGVuZ3RoLCBjb25z
dCB2b2lkICpwYXJhbSwNCj4gKwkJCQkJCQl2b2lkICp1c2VyX2RhdGEpDQo+ICt7DQo+ICsJbF93
YXJuKCJIY2kgZGV2ICU0LjR4IHJlbW92ZWQiLCBpbmRleCk7DQo+ICsJbF9xdWV1ZV9yZW1vdmUo
Y29udHJvbGxlcnMsIExfVUlOVF9UT19QVFIoaW5kZXgpKTsNCj4gK30NCj4gKw0KPiArc3RhdGlj
IHZvaWQgcmVhZF9pbmRleF9saXN0X2NiKHVpbnQ4X3Qgc3RhdHVzLCB1aW50MTZfdCBsZW5ndGgs
DQo+ICsJCQkJCWNvbnN0IHZvaWQgKnBhcmFtLCB2b2lkICp1c2VyX2RhdGEpDQo+ICt7DQo+ICsJ
Y29uc3Qgc3RydWN0IG1nbXRfcnBfcmVhZF9pbmRleF9saXN0ICpycCA9IHBhcmFtOw0KPiArCXVp
bnQxNl90IG51bTsNCj4gKwlpbnQgaTsNCj4gKw0KPiArCWlmIChzdGF0dXMgIT0gTUdNVF9TVEFU
VVNfU1VDQ0VTUykgew0KPiArCQlsX2Vycm9yKCJGYWlsZWQgdG8gcmVhZCBpbmRleCBsaXN0OiAl
cyAoMHglMDJ4KSIsDQo+ICsJCQkJCQltZ210X2VycnN0cihzdGF0dXMpLCBzdGF0dXMpOw0KPiAr
CQlyZXR1cm47DQo+ICsJfQ0KPiArDQo+ICsJaWYgKGxlbmd0aCA8IHNpemVvZigqcnApKSB7DQo+
ICsJCWxfZXJyb3IoIlJlYWQgaW5kZXggbGlzdCByZXNwb25zZSBzaXhlIHRvbyBzaG9ydCIpOw0K
PiArCQlyZXR1cm47DQo+ICsJfQ0KPiArDQo+ICsJbnVtID0gYnRvaHMocnAtPm51bV9jb250cm9s
bGVycyk7DQo+ICsNCj4gKwlsX2RlYnVnKCJOdW1iZXIgb2YgY29udHJvbGxlcnM6ICV1IiwgbnVt
KTsNCj4gKw0KPiArCWlmIChudW0gKiBzaXplb2YodWludDE2X3QpICsgc2l6ZW9mKCpycCkgIT0g
bGVuZ3RoKSB7DQo+ICsJCWxfZXJyb3IoIkluY29ycmVjdCBwYWNrZXQgc2l6ZSBmb3IgaW5kZXgg
bGlzdCByZXNwb25zZSIpOw0KPiArCQlyZXR1cm47DQo+ICsJfQ0KPiArDQo+ICsJZm9yIChpID0g
MDsgaSA8IG51bTsgaSsrKSB7DQo+ICsJCXVpbnQxNl90IGluZGV4Ow0KPiArDQo+ICsJCWluZGV4
ID0gYnRvaHMocnAtPmluZGV4W2ldKTsNCj4gKwkJaW5kZXhfYWRkZWQoaW5kZXgsIDAsIE5VTEws
IHVzZXJfZGF0YSk7DQo+ICsJfQ0KPiArfQ0KPiArDQo+ICtzdGF0aWMgYm9vbCBtZ210X2luaXQo
c3RydWN0IG1lc2hfaW8gKmlvKQ0KPiArew0KPiArCW1nbXRfbWVzaCA9IG1nbXRfbmV3X2RlZmF1
bHQoKTsNCj4gKwlpZiAoIW1nbXRfbWVzaCkgew0KPiArCQlsX2Vycm9yKCJGYWlsZWQgdG8gaW5p
dGlhbGl6ZSBtZXNoIG1hbmFnZW1lbnQiKTsNCj4gKwkJcmV0dXJuIGZhbHNlOw0KPiArCX0NCj4g
Kw0KPiArCWNvbnRyb2xsZXJzID0gbF9xdWV1ZV9uZXcoKTsNCj4gKw0KPiArCW1nbXRfcmVnaXN0
ZXIobWdtdF9tZXNoLCBNR01UX0VWX0lOREVYX0FEREVELCBNR01UX0lOREVYX05PTkUsDQo+ICsJ
CQkJCQlpbmRleF9hZGRlZCwgaW8sIE5VTEwpOw0KPiArCW1nbXRfcmVnaXN0ZXIobWdtdF9tZXNo
LCBNR01UX0VWX0lOREVYX1JFTU9WRUQsIE1HTVRfSU5ERVhfTk9ORSwNCj4gKwkJCQkJCWluZGV4
X3JlbW92ZWQsIGlvLCBOVUxMKTsNCj4gKw0KPiArCS8qIFVzZSBNR01UIHRvIGZpbmQgYSBjYW5k
aWRhdGUgY29udHJvbGxlciAqLw0KPiArCWxfZGVidWcoInNlbmQgcmVhZCBpbmRleF9saXN0Iik7
DQo+ICsJaWYgKG1nbXRfc2VuZChtZ210X21lc2gsIE1HTVRfT1BfUkVBRF9JTkRFWF9MSVNULA0K
PiArCQkJCQlNR01UX0lOREVYX05PTkUsIDAsIE5VTEwsDQo+ICsJCQkJCXJlYWRfaW5kZXhfbGlz
dF9jYiwgaW8sIE5VTEwpIDw9IDApDQo+ICsJCXJldHVybiBmYWxzZTsNCj4gIA0KPiAtCWlvLT5w
dnQgPSB0bXA7DQo+ICAJcmV0dXJuIHRydWU7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBib29sIGRl
dl9pbml0KHN0cnVjdCBtZXNoX2lvICppbywgdm9pZCAqb3B0cykNCj4gK3sNCj4gKwlpZiAoIWlv
IHx8IGlvLT5wdnQpDQo+ICsJCXJldHVybiBmYWxzZTsNCj4gKw0KPiArCWlvLT5wdnQgPSBsX25l
dyhzdHJ1Y3QgbWVzaF9pb19wcml2YXRlLCAxKTsNCj4gKwlpby0+cHZ0LT5pbmRleCA9ICooaW50
ICopb3B0czsNCj4gIA0KPiAtZmFpbDoNCj4gLQlsX3F1ZXVlX2Rlc3Ryb3kodG1wLT5yeF9yZWdz
LCBsX2ZyZWUpOw0KPiAtCWxfcXVldWVfZGVzdHJveSh0bXAtPnR4X3BrdHMsIGxfZnJlZSk7DQo+
IC0JbF9mcmVlKHRtcCk7DQo+IC0JcmV0dXJuIGZhbHNlOw0KPiArCWlvLT5wdnQtPnJ4X3JlZ3Mg
PSBsX3F1ZXVlX25ldygpOw0KPiArCWlvLT5wdnQtPnR4X3BrdHMgPSBsX3F1ZXVlX25ldygpOw0K
PiArDQo+ICsJaWYgKGlvLT5wdnQtPmluZGV4ID09IE1HTVRfSU5ERVhfTk9ORSkNCj4gKwkJcmV0
dXJuIG1nbXRfaW5pdChpbyk7DQo+ICsJZWxzZQ0KPiArCQlyZXR1cm4gaGNpX2luaXQoaW8pOw0K
PiAgfQ0KPiAgDQo+ICBzdGF0aWMgYm9vbCBkZXZfZGVzdHJveShzdHJ1Y3QgbWVzaF9pbyAqaW8p
DQo+IEBAIC0zMjcsNiArNDgyLDggQEAgc3RhdGljIGJvb2wgZGV2X2Rlc3Ryb3koc3RydWN0IG1l
c2hfaW8gKmlvKQ0KPiAgCWxfcXVldWVfZGVzdHJveShwdnQtPnR4X3BrdHMsIGxfZnJlZSk7DQo+
ICAJbF9mcmVlKHB2dCk7DQo+ICAJaW8tPnB2dCA9IE5VTEw7DQo+ICsJbF9xdWV1ZV9kZXN0cm95
KGNvbnRyb2xsZXJzLCBOVUxMKTsNCj4gKwltZ210X3VucmVmKG1nbXRfbWVzaCk7DQoNClRoZXNl
IGFyZSBzdGF0aWNzLCBzbyBpZiB0aGV5IG5lZWQgdG8gYmUgdG90YWxseSBkZXN0cm95ZWQsIHRo
ZXkgc2hvdWxkIGJlIHNldCBiYWNrIHRvIE5VTEwgYWZ0ZXJ3b3Jkcy4NCg0KPiAgDQo+ICAJcmV0
dXJuIHRydWU7DQo+ICB9DQo+IGRpZmYgLS1naXQgYS9tZXNoL21lc2gtaW8uYyBiL21lc2gvbWVz
aC1pby5jDQo+IGluZGV4IDM3MTUzZWE5ZC4uYjZhZDJmOTk1IDEwMDY0NA0KPiAtLS0gYS9tZXNo
L21lc2gtaW8uYw0KPiArKysgYi9tZXNoL21lc2gtaW8uYw0KPiBAQCAtMzksMjYgKzM5LDI2IEBA
IHN0YXRpYyBjb25zdCBzdHJ1Y3QgbWVzaF9pb190YWJsZSB0YWJsZVtdID0gew0KPiAgDQo+ICBz
dGF0aWMgc3RydWN0IGxfcXVldWUgKmlvX2xpc3Q7DQo+ICANCj4gKw0KDQpTdHlsZSBHdWlkZTog
cmVtb3ZlIGV4dHJhIGJsYW5rIGxpbmUNCg0KPiAgc3RhdGljIGJvb2wgbWF0Y2hfYnlfaW8oY29u
c3Qgdm9pZCAqYSwgY29uc3Qgdm9pZCAqYikNCj4gIHsNCj4gIAlyZXR1cm4gYSA9PSBiOw0KPiAg
fQ0KPiAgDQo+IC1zdGF0aWMgYm9vbCBtYXRjaF9ieV9pbmRleChjb25zdCB2b2lkICphLCBjb25z
dCB2b2lkICpiKQ0KPiArc3RhdGljIGJvb2wgbWF0Y2hfYnlfdHlwZShjb25zdCB2b2lkICphLCBj
b25zdCB2b2lkICpiKQ0KPiAgew0KPiAgCWNvbnN0IHN0cnVjdCBtZXNoX2lvICppbyA9IGE7DQo+
ICsJY29uc3QgZW51bSBtZXNoX2lvX3R5cGUgKnR5cGUgPSBiOw0KPiAgDQo+IC0JcmV0dXJuIGlv
LT5pbmRleCA9PSBMX1BUUl9UT19VSU5UKGIpOw0KPiArCXJldHVybiBpby0+dHlwZSA9PSAqdHlw
ZTsNCj4gIH0NCg0KVGhpcyBpcyBhbiBpcnJlZ3VsYXIgdXNlIG9mIHRoZSAibWF0Y2hfYnkiIGNv
bnZlbnRpb24uLi4NCg0KVHJ5IHVzaW5nIHNvbWV0aGluZyBsaWtlOg0KZW51bSBtZXNoX2lvX3R5
cGUgdHlwZSA9IChlbnVtIG1lc2hfaW9fdHlwZSkgTF9QVFJfVE9fVUlOVChiKTsNCg0KcmV0dXJu
IGlvLT50eXBlID09IHR5cGUuDQoNClRoZW4gYmVsb3cgd2hlbiBpdCBpcyB1c2VkLCBwYXNzIHRo
ZSB0eXBlIGFzIExfVUlOVF9UT19QVFIodHlwZSkuICBJIGFtIG5vdCBjZXJ0YWluIGl0IHdpbGwg
d29yaywgYnV0IGl0IHNob3VsZA0KYmUgdHJpZWQuDQoNCg0KPiAgDQo+IC1zdHJ1Y3QgbWVzaF9p
byAqbWVzaF9pb19uZXcodWludDE2X3QgaW5kZXgsIGVudW0gbWVzaF9pb190eXBlIHR5cGUpDQo+
ICtzdHJ1Y3QgbWVzaF9pbyAqbWVzaF9pb19uZXcoZW51bSBtZXNoX2lvX3R5cGUgdHlwZSwgdm9p
ZCAqb3B0cykNCj4gIHsNCj4gIAljb25zdCBzdHJ1Y3QgbWVzaF9pb19hcGkgKmFwaSA9IE5VTEw7
DQo+ICAJc3RydWN0IG1lc2hfaW8gKmlvOw0KPiAgCXVpbnQxNl90IGk7DQo+ICANCj4gLQlsX2lu
Zm8oIiVzICVkXG4iLCBfX2Z1bmNfXywgdHlwZSk7DQo+IC0NCj4gIAlmb3IgKGkgPSAwOyBpIDwg
TF9BUlJBWV9TSVpFKHRhYmxlKTsgaSsrKSB7DQo+ICAJCWlmICh0YWJsZVtpXS50eXBlID09IHR5
cGUpIHsNCj4gIAkJCWFwaSA9IHRhYmxlW2ldLmFwaTsNCj4gQEAgLTY2LDcgKzY2LDggQEAgc3Ry
dWN0IG1lc2hfaW8gKm1lc2hfaW9fbmV3KHVpbnQxNl90IGluZGV4LCBlbnVtIG1lc2hfaW9fdHlw
ZSB0eXBlKQ0KPiAgCQl9DQo+ICAJfQ0KPiAgDQo+IC0JaW8gPSBsX3F1ZXVlX2ZpbmQoaW9fbGlz
dCwgbWF0Y2hfYnlfaW5kZXgsIExfVUlOVF9UT19QVFIoaW5kZXgpKTsNCj4gKw0KPiArCWlvID0g
bF9xdWV1ZV9maW5kKGlvX2xpc3QsIG1hdGNoX2J5X3R5cGUsICZ0eXBlKTsNCj4gIA0KPiAgCWlm
ICghYXBpIHx8ICFhcGktPmluaXQgfHwgaW8pDQo+ICAJCXJldHVybiBOVUxMOw0KPiBAQCAtNzcs
OSArNzgsOSBAQCBzdHJ1Y3QgbWVzaF9pbyAqbWVzaF9pb19uZXcodWludDE2X3QgaW5kZXgsIGVu
dW0gbWVzaF9pb190eXBlIHR5cGUpDQo+ICAJCXJldHVybiBOVUxMOw0KPiAgDQo+ICAJaW8tPnR5
cGUgPSB0eXBlOw0KPiAtCWlvLT5pbmRleCA9IGluZGV4Ow0KPiArDQo+ICAJaW8tPmFwaSA9IGFw
aTsNCj4gLQlpZiAoIWFwaS0+aW5pdChpbmRleCwgaW8pKQ0KPiArCWlmICghYXBpLT5pbml0KGlv
LCBvcHRzKSkNCj4gIAkJZ290byBmYWlsOw0KPiAgDQo+ICAJaWYgKCFpb19saXN0KQ0KPiBkaWZm
IC0tZ2l0IGEvbWVzaC9tZXNoLWlvLmggYi9tZXNoL21lc2gtaW8uaA0KPiBpbmRleCA3MWQzY2I5
ODAuLjY1ODUyMDVjNyAxMDA2NDQNCj4gLS0tIGEvbWVzaC9tZXNoLWlvLmgNCj4gKysrIGIvbWVz
aC9tZXNoLWlvLmgNCj4gQEAgLTgwLDcgKzgwLDcgQEAgdHlwZWRlZiB2b2lkICgqbWVzaF9pb19y
ZWN2X2Z1bmNfdCkodm9pZCAqdXNlcl9kYXRhLA0KPiAgdHlwZWRlZiB2b2lkICgqbWVzaF9pb19z
dGF0dXNfZnVuY190KSh2b2lkICp1c2VyX2RhdGEsIGludCBzdGF0dXMsDQo+ICAJCQkJCQkJdWlu
dDhfdCBmaWx0ZXJfaWQpOw0KPiAgDQo+IC1zdHJ1Y3QgbWVzaF9pbyAqbWVzaF9pb19uZXcodWlu
dDE2X3QgaW5kZXgsIGVudW0gbWVzaF9pb190eXBlIHR5cGUpOw0KPiArc3RydWN0IG1lc2hfaW8g
Km1lc2hfaW9fbmV3KGVudW0gbWVzaF9pb190eXBlIHR5cGUsIHZvaWQgKm9wdHMpOw0KPiAgdm9p
ZCBtZXNoX2lvX2Rlc3Ryb3koc3RydWN0IG1lc2hfaW8gKmlvKTsNCj4gIA0KPiAgYm9vbCBtZXNo
X2lvX2dldF9jYXBzKHN0cnVjdCBtZXNoX2lvICppbywgc3RydWN0IG1lc2hfaW9fY2FwcyAqY2Fw
cyk7DQo+IGRpZmYgLS1naXQgYS9tZXNoL21lc2guYyBiL21lc2gvbWVzaC5jDQo+IGluZGV4IDIz
MWE2YmNhNC4uMjZhY2ZkNGRjIDEwMDY0NA0KPiAtLS0gYS9tZXNoL21lc2guYw0KPiArKysgYi9t
ZXNoL21lc2guYw0KPiBAQCAtMjQsMTEgKzI0LDYgQEANCj4gICNkZWZpbmUgX0dOVV9TT1VSQ0UN
Cj4gICNpbmNsdWRlIDxlbGwvZWxsLmg+DQo+ICANCj4gLSNpbmNsdWRlICJsaWIvYmx1ZXRvb3Ro
LmgiDQo+IC0jaW5jbHVkZSAibGliL21nbXQuaCINCj4gLQ0KPiAtI2luY2x1ZGUgInNyYy9zaGFy
ZWQvbWdtdC5oIg0KPiAtDQo+ICAjaW5jbHVkZSAibWVzaC9tZXNoLWlvLmgiDQo+ICAjaW5jbHVk
ZSAibWVzaC9ub2RlLmgiDQo+ICAjaW5jbHVkZSAibWVzaC9uZXQuaCINCj4gQEAgLTc2LDkgKzcx
LDYgQEAgc3RydWN0IGpvaW5fZGF0YXsNCj4gIH07DQo+ICANCj4gIHN0YXRpYyBzdHJ1Y3QgYnRf
bWVzaCBtZXNoOw0KPiAtc3RhdGljIHN0cnVjdCBsX3F1ZXVlICpjb250cm9sbGVyczsNCj4gLXN0
YXRpYyBzdHJ1Y3QgbWdtdCAqbWdtdF9tZXNoOw0KPiAtc3RhdGljIGJvb2wgaW5pdGlhbGl6ZWQ7
DQo+ICANCj4gIC8qIFdlIGFsbG93IG9ubHkgb25lIG91dHN0YW5kaW5nIEpvaW4gcmVxdWVzdCAq
Lw0KPiAgc3RhdGljIHN0cnVjdCBqb2luX2RhdGEgKmpvaW5fcGVuZGluZzsNCj4gQEAgLTkxLDI5
ICs4Myw2IEBAIHN0YXRpYyBib29sIHNpbXBsZV9tYXRjaChjb25zdCB2b2lkICphLCBjb25zdCB2
b2lkICpiKQ0KPiAgCXJldHVybiBhID09IGI7DQo+ICB9DQo+ICANCj4gLXN0YXRpYyB2b2lkIHN0
YXJ0X2lvKHVpbnQxNl90IGluZGV4KQ0KPiAtew0KPiAtCXN0cnVjdCBtZXNoX2lvICppbzsNCj4g
LQlzdHJ1Y3QgbWVzaF9pb19jYXBzIGNhcHM7DQo+IC0NCj4gLQlsX2RlYnVnKCJTdGFydGluZyBt
ZXNoIG9uIGhjaSAldSIsIGluZGV4KTsNCj4gLQ0KPiAtCWlvID0gbWVzaF9pb19uZXcoaW5kZXgs
IE1FU0hfSU9fVFlQRV9HRU5FUklDKTsNCj4gLQlpZiAoIWlvKSB7DQo+IC0JCWxfZXJyb3IoIkZh
aWxlZCB0byBzdGFydCBtZXNoIGlvIChoY2kgJXUpIiwgaW5kZXgpOw0KPiAtCQlyZXR1cm47DQo+
IC0JfQ0KPiAtDQo+IC0JbWVzaF9pb19nZXRfY2FwcyhpbywgJmNhcHMpOw0KPiAtCW1lc2gubWF4
X2ZpbHRlcnMgPSBjYXBzLm1heF9udW1fZmlsdGVyczsNCj4gLQ0KPiAtCW1lc2guaW8gPSBpbzsN
Cj4gLQ0KPiAtCWxfZGVidWcoIlN0YXJ0ZWQgbWVzaCAoaW8gJXApIG9uIGhjaSAldSIsIG1lc2gu
aW8sIGluZGV4KTsNCj4gLQ0KPiAtCW5vZGVfYXR0YWNoX2lvX2FsbChpbyk7DQo+IC19DQo+IC0N
Cj4gIC8qIFVzZWQgZm9yIGFueSBvdXRib3VuZCB0cmFmZmljIHRoYXQgZG9lc24ndCBoYXZlIEZy
aWVuZHNoaXAgQ29uc3RyYWludHMgKi8NCj4gIC8qIFRoaXMgaW5jbHVkZXMgQmVhY29ucywgUHJv
dmlzaW9uaW5nIGFuZCB1bnJlc3RyaWN0ZWQgTmV0d29yayBUcmFmZmljICovDQo+ICBib29sIG1l
c2hfc2VuZF9wa3QodWludDhfdCBjb3VudCwgdWludDE2X3QgaW50ZXJ2YWwsDQo+IEBAIC0xNjcs
MTQzICsxMzYsMTMgQEAgdm9pZCBtZXNoX3VucmVnX3Byb3ZfcngocHJvdl9yeF9jYl90IGNiKQ0K
PiAgCW1lc2hfaW9fZGVyZWdpc3Rlcl9yZWN2X2NiKG1lc2guaW8sIE1FU0hfSU9fRklMVEVSX1BS
T1YpOw0KPiAgfQ0KPiAgDQo+IC1zdGF0aWMgdm9pZCByZWFkX2luZm9fY2IodWludDhfdCBzdGF0
dXMsIHVpbnQxNl90IGxlbmd0aCwNCj4gLQkJCQkJY29uc3Qgdm9pZCAqcGFyYW0sIHZvaWQgKnVz
ZXJfZGF0YSkNCj4gK2Jvb2wgbWVzaF9pbml0KGNvbnN0IGNoYXIgKmNvbmZpZ19kaXIsIGVudW0g
bWVzaF9pb190eXBlIHR5cGUsIHZvaWQgKm9wdHMpDQo+ICB7DQo+IC0JdWludDE2X3QgaW5kZXgg
PSBMX1BUUl9UT19VSU5UKHVzZXJfZGF0YSk7DQo+IC0JY29uc3Qgc3RydWN0IG1nbXRfcnBfcmVh
ZF9pbmZvICpycCA9IHBhcmFtOw0KPiAtCXVpbnQzMl90IGN1cnJlbnRfc2V0dGluZ3MsIHN1cHBv
cnRlZF9zZXR0aW5nczsNCj4gKwlzdHJ1Y3QgbWVzaF9pb19jYXBzIGNhcHM7DQo+ICANCj4gIAlp
ZiAobWVzaC5pbykNCj4gLQkJLyogQWxyZWFkeSBpbml0aWFsaXplZCAqLw0KPiAtCQlyZXR1cm47
DQo+IC0NCj4gLQlsX2RlYnVnKCJoY2kgJXUgc3RhdHVzIDB4JTAyeCIsIGluZGV4LCBzdGF0dXMp
Ow0KPiAtDQo+IC0JaWYgKHN0YXR1cyAhPSBNR01UX1NUQVRVU19TVUNDRVNTKSB7DQo+IC0JCWxf
ZXJyb3IoIkZhaWxlZCB0byByZWFkIGluZm8gZm9yIGhjaSBpbmRleCAldTogJXMgKDB4JTAyeCki
LA0KPiAtCQkJCQlpbmRleCwgbWdtdF9lcnJzdHIoc3RhdHVzKSwgc3RhdHVzKTsNCj4gLQkJcmV0
dXJuOw0KPiAtCX0NCj4gLQ0KPiAtCWlmIChsZW5ndGggPCBzaXplb2YoKnJwKSkgew0KPiAtCQls
X2Vycm9yKCJSZWFkIGluZm8gcmVzcG9uc2UgdG9vIHNob3J0Iik7DQo+IC0JCXJldHVybjsNCj4g
LQl9DQo+IC0NCj4gLQljdXJyZW50X3NldHRpbmdzID0gYnRvaGwocnAtPmN1cnJlbnRfc2V0dGlu
Z3MpOw0KPiAtCXN1cHBvcnRlZF9zZXR0aW5ncyA9IGJ0b2hsKHJwLT5zdXBwb3J0ZWRfc2V0dGlu
Z3MpOw0KPiAtDQo+IC0JbF9kZWJ1Zygic2V0dGluZ3M6IHN1cHAgJTguOHggY3VyciAlOC44eCIs
DQo+IC0JCQkJCXN1cHBvcnRlZF9zZXR0aW5ncywgY3VycmVudF9zZXR0aW5ncyk7DQo+IC0NCj4g
LQlpZiAoY3VycmVudF9zZXR0aW5ncyAmIE1HTVRfU0VUVElOR19QT1dFUkVEKSB7DQo+IC0JCWxf
aW5mbygiQ29udHJvbGxlciBoY2kgJXUgaXMgaW4gdXNlIiwgaW5kZXgpOw0KPiAtCQlyZXR1cm47
DQo+IC0JfQ0KPiAtDQo+IC0JaWYgKCEoc3VwcG9ydGVkX3NldHRpbmdzICYgTUdNVF9TRVRUSU5H
X0xFKSkgew0KPiAtCQlsX2luZm8oIkNvbnRyb2xsZXIgaGNpICV1IGRvZXMgbm90IHN1cHBvcnQg
TEUiLCBpbmRleCk7DQo+IC0JCXJldHVybjsNCj4gLQl9DQo+IC0NCj4gLQlzdGFydF9pbyhpbmRl
eCk7DQo+IC19DQo+IC0NCj4gLXN0YXRpYyB2b2lkIGluZGV4X2FkZGVkKHVpbnQxNl90IGluZGV4
LCB1aW50MTZfdCBsZW5ndGgsIGNvbnN0IHZvaWQgKnBhcmFtLA0KPiAtCQkJCQkJCXZvaWQgKnVz
ZXJfZGF0YSkNCj4gLXsNCj4gLQlsX2RlYnVnKCJoY2kgZGV2aWNlICV1IiwgaW5kZXgpOw0KPiAt
DQo+IC0JaWYgKG1lc2gucmVxX2luZGV4ICE9IE1HTVRfSU5ERVhfTk9ORSAmJg0KPiAtCQkJCQlp
bmRleCAhPSBtZXNoLnJlcV9pbmRleCkgew0KPiAtCQlsX2RlYnVnKCJJZ25vcmUgaW5kZXggJWQi
LCBpbmRleCk7DQo+IC0JCXJldHVybjsNCj4gLQl9DQo+IC0NCj4gLQlpZiAobF9xdWV1ZV9maW5k
KGNvbnRyb2xsZXJzLCBzaW1wbGVfbWF0Y2gsIExfVUlOVF9UT19QVFIoaW5kZXgpKSkNCj4gLQkJ
cmV0dXJuOw0KPiAtDQo+IC0JbF9xdWV1ZV9wdXNoX3RhaWwoY29udHJvbGxlcnMsIExfVUlOVF9U
T19QVFIoaW5kZXgpKTsNCj4gLQ0KPiAtCWlmIChtZ210X3NlbmQobWdtdF9tZXNoLCBNR01UX09Q
X1JFQURfSU5GTywgaW5kZXgsIDAsIE5VTEwsDQo+IC0JCQlyZWFkX2luZm9fY2IsIExfVUlOVF9U
T19QVFIoaW5kZXgpLCBOVUxMKSA+IDApDQo+IC0JCXJldHVybjsNCj4gLQ0KPiAtCWxfcXVldWVf
cmVtb3ZlKGNvbnRyb2xsZXJzLCBMX1VJTlRfVE9fUFRSKGluZGV4KSk7DQo+IC19DQo+IC0NCj4g
LXN0YXRpYyB2b2lkIGluZGV4X3JlbW92ZWQodWludDE2X3QgaW5kZXgsIHVpbnQxNl90IGxlbmd0
aCwgY29uc3Qgdm9pZCAqcGFyYW0sDQo+IC0JCQkJCQkJdm9pZCAqdXNlcl9kYXRhKQ0KPiAtew0K
PiAtCWxfd2FybigiSGNpIGRldiAlNC40eCByZW1vdmVkIiwgaW5kZXgpOw0KPiAtCWxfcXVldWVf
cmVtb3ZlKGNvbnRyb2xsZXJzLCBMX1VJTlRfVE9fUFRSKGluZGV4KSk7DQo+IC19DQo+IC0NCj4g
LXN0YXRpYyB2b2lkIHJlYWRfaW5kZXhfbGlzdF9jYih1aW50OF90IHN0YXR1cywgdWludDE2X3Qg
bGVuZ3RoLA0KPiAtCQkJCQljb25zdCB2b2lkICpwYXJhbSwgdm9pZCAqdXNlcl9kYXRhKQ0KPiAt
ew0KPiAtCWNvbnN0IHN0cnVjdCBtZ210X3JwX3JlYWRfaW5kZXhfbGlzdCAqcnAgPSBwYXJhbTsN
Cj4gLQl1aW50MTZfdCBudW07DQo+IC0JaW50IGk7DQo+IC0NCj4gLQlpZiAoc3RhdHVzICE9IE1H
TVRfU1RBVFVTX1NVQ0NFU1MpIHsNCj4gLQkJbF9lcnJvcigiRmFpbGVkIHRvIHJlYWQgaW5kZXgg
bGlzdDogJXMgKDB4JTAyeCkiLA0KPiAtCQkJCQkJbWdtdF9lcnJzdHIoc3RhdHVzKSwgc3RhdHVz
KTsNCj4gLQkJcmV0dXJuOw0KPiAtCX0NCj4gLQ0KPiAtCWlmIChsZW5ndGggPCBzaXplb2YoKnJw
KSkgew0KPiAtCQlsX2Vycm9yKCJSZWFkIGluZGV4IGxpc3QgcmVzcG9uc2Ugc2l4ZSB0b28gc2hv
cnQiKTsNCj4gLQkJcmV0dXJuOw0KPiAtCX0NCj4gLQ0KPiAtCW51bSA9IGJ0b2hzKHJwLT5udW1f
Y29udHJvbGxlcnMpOw0KPiAtDQo+IC0JbF9kZWJ1ZygiTnVtYmVyIG9mIGNvbnRyb2xsZXJzOiAl
dSIsIG51bSk7DQo+IC0NCj4gLQlpZiAobnVtICogc2l6ZW9mKHVpbnQxNl90KSArIHNpemVvZigq
cnApICE9IGxlbmd0aCkgew0KPiAtCQlsX2Vycm9yKCJJbmNvcnJlY3QgcGFja2V0IHNpemUgZm9y
IGluZGV4IGxpc3QgcmVzcG9uc2UiKTsNCj4gLQkJcmV0dXJuOw0KPiAtCX0NCj4gLQ0KPiAtCWZv
ciAoaSA9IDA7IGkgPCBudW07IGkrKykgew0KPiAtCQl1aW50MTZfdCBpbmRleDsNCj4gLQ0KPiAt
CQlpbmRleCA9IGJ0b2hzKHJwLT5pbmRleFtpXSk7DQo+IC0JCWluZGV4X2FkZGVkKGluZGV4LCAw
LCBOVUxMLCB1c2VyX2RhdGEpOw0KPiAtCX0NCj4gLX0NCj4gLQ0KPiAtc3RhdGljIGJvb2wgaW5p
dF9tZ210KHZvaWQpDQo+IC17DQo+IC0JbWdtdF9tZXNoID0gbWdtdF9uZXdfZGVmYXVsdCgpOw0K
PiAtCWlmICghbWdtdF9tZXNoKQ0KPiAtCQlyZXR1cm4gZmFsc2U7DQo+IC0NCj4gLQljb250cm9s
bGVycyA9IGxfcXVldWVfbmV3KCk7DQo+IC0JaWYgKCFjb250cm9sbGVycykNCj4gLQkJcmV0dXJu
IGZhbHNlOw0KPiAtDQo+IC0JbWdtdF9yZWdpc3RlcihtZ210X21lc2gsIE1HTVRfRVZfSU5ERVhf
QURERUQsIE1HTVRfSU5ERVhfTk9ORSwNCj4gLQkJCQkJCWluZGV4X2FkZGVkLCBOVUxMLCBOVUxM
KTsNCj4gLQltZ210X3JlZ2lzdGVyKG1nbXRfbWVzaCwgTUdNVF9FVl9JTkRFWF9SRU1PVkVELCBN
R01UX0lOREVYX05PTkUsDQo+IC0JCQkJCQlpbmRleF9yZW1vdmVkLCBOVUxMLCBOVUxMKTsNCj4g
LQlyZXR1cm4gdHJ1ZTsNCj4gLX0NCj4gLQ0KPiAtYm9vbCBtZXNoX2luaXQodWludDE2X3QgaW5k
ZXgsIGNvbnN0IGNoYXIgKmNvbmZpZ19kaXIpDQo+IC17DQo+IC0JaWYgKGluaXRpYWxpemVkKQ0K
PiAgCQlyZXR1cm4gdHJ1ZTsNCj4gIA0KPiAtCWlmIChpbmRleCA9PSBNR01UX0lOREVYX05PTkUg
JiYgIWluaXRfbWdtdCgpKSB7DQo+IC0JCWxfZXJyb3IoIkZhaWxlZCB0byBpbml0aWFsaXplIG1l
c2ggbWFuYWdlbWVudCIpOw0KPiAtCQlyZXR1cm4gZmFsc2U7DQo+IC0JfQ0KPiAtDQo+IC0JbWVz
aC5yZXFfaW5kZXggPSBpbmRleDsNCj4gLQ0KPiAgCW1lc2hfbW9kZWxfaW5pdCgpOw0KPiAgCW1l
c2hfYWdlbnRfaW5pdCgpOw0KPiAgDQo+IEBAIC0zMTksMTggKzE1OCwxNiBAQCBib29sIG1lc2hf
aW5pdCh1aW50MTZfdCBpbmRleCwgY29uc3QgY2hhciAqY29uZmlnX2RpcikNCj4gIAlpZiAoIXN0
b3JhZ2VfbG9hZF9ub2Rlcyhjb25maWdfZGlyKSkNCj4gIAkJcmV0dXJuIGZhbHNlOw0KPiAgDQo+
IC0JaWYgKGluZGV4ID09IE1HTVRfSU5ERVhfTk9ORSkgew0KPiAtCQkvKiBVc2UgTUdNVCB0byBm
aW5kIGEgY2FuZGlkYXRlIGNvbnRyb2xsZXIgKi8NCj4gLQkJbF9kZWJ1Zygic2VuZCByZWFkIGlu
ZGV4X2xpc3QiKTsNCj4gLQkJaWYgKG1nbXRfc2VuZChtZ210X21lc2gsIE1HTVRfT1BfUkVBRF9J
TkRFWF9MSVNULA0KPiAtCQkJCQlNR01UX0lOREVYX05PTkUsIDAsIE5VTEwsDQo+IC0JCQkJCXJl
YWRfaW5kZXhfbGlzdF9jYiwgTlVMTCwgTlVMTCkgPD0gMCkNCj4gLQkJCXJldHVybiBmYWxzZTsN
Cj4gLQl9IGVsc2Ugew0KPiAtCQkvKiBPcGVuIHNwZWNpZmllZCBjb250cm9sbGVyIHdpdGhvdXQg
c2VhcmNoaW5nICovDQo+IC0JCXN0YXJ0X2lvKG1lc2gucmVxX2luZGV4KTsNCj4gLQkJcmV0dXJu
IG1lc2guaW8gIT0gTlVMTDsNCj4gLQl9DQo+ICsJbWVzaC5pbyA9IG1lc2hfaW9fbmV3KHR5cGUs
IG9wdHMpOw0KPiArCWlmICghbWVzaC5pbykNCj4gKwkJcmV0dXJuIGZhbHNlOw0KPiArDQo+ICsJ
bF9kZWJ1ZygiaW8gJXAiLCBtZXNoLmlvKTsNCj4gKwltZXNoX2lvX2dldF9jYXBzKG1lc2guaW8s
ICZjYXBzKTsNCj4gKwltZXNoLm1heF9maWx0ZXJzID0gY2Fwcy5tYXhfbnVtX2ZpbHRlcnM7DQo+
ICsNCj4gKwlub2RlX2F0dGFjaF9pb19hbGwobWVzaC5pbyk7DQo+ICsNCj4gIAlyZXR1cm4gdHJ1
ZTsNCj4gIH0NCj4gIA0KPiBAQCAtMzY2LDcgKzIwMyw2IEBAIHZvaWQgbWVzaF9jbGVhbnVwKHZv
aWQpDQo+ICAJc3RydWN0IGxfZGJ1c19tZXNzYWdlICpyZXBseTsNCj4gIA0KPiAgCW1lc2hfaW9f
ZGVzdHJveShtZXNoLmlvKTsNCj4gLQltZ210X3VucmVmKG1nbXRfbWVzaCk7DQo+ICANCj4gIAlp
ZiAoam9pbl9wZW5kaW5nKSB7DQo+ICANCj4gQEAgLTM4NCw3ICsyMjAsNiBAQCB2b2lkIG1lc2hf
Y2xlYW51cCh2b2lkKQ0KPiAgCW5vZGVfY2xlYW51cF9hbGwoKTsNCj4gIAltZXNoX21vZGVsX2Ns
ZWFudXAoKTsNCj4gIA0KPiAtCWxfcXVldWVfZGVzdHJveShjb250cm9sbGVycywgTlVMTCk7DQo+
ICAJbF9kYnVzX29iamVjdF9yZW1vdmVfaW50ZXJmYWNlKGRidXNfZ2V0X2J1cygpLCBCTFVFWl9N
RVNIX1BBVEgsDQo+ICAJCQkJCQkJTUVTSF9ORVRXT1JLX0lOVEVSRkFDRSk7DQo+ICAJbF9kYnVz
X3VucmVnaXN0ZXJfaW50ZXJmYWNlKGRidXNfZ2V0X2J1cygpLCBNRVNIX05FVFdPUktfSU5URVJG
QUNFKTsNCj4gZGlmZiAtLWdpdCBhL21lc2gvbWVzaC5oIGIvbWVzaC9tZXNoLmgNCj4gaW5kZXgg
MzIwYTEwOGVkLi4xNGIxZmI1MTcgMTAwNjQ0DQo+IC0tLSBhL21lc2gvbWVzaC5oDQo+ICsrKyBi
L21lc2gvbWVzaC5oDQo+IEBAIC0yOCw5ICsyOCwxMSBAQA0KPiAgI2RlZmluZSBNRVNIX1BST1ZJ
U0lPTkVSX0lOVEVSRkFDRSAib3JnLmJsdWV6Lm1lc2guUHJvdmlzaW9uZXIxIg0KPiAgI2RlZmlu
ZSBFUlJPUl9JTlRFUkZBQ0UgIm9yZy5ibHVlei5tZXNoLkVycm9yIg0KPiAgDQo+ICtlbnVtIG1l
c2hfaW9fdHlwZTsNCj4gKw0KPiAgdHlwZWRlZiB2b2lkICgqcHJvdl9yeF9jYl90KSh2b2lkICp1
c2VyX2RhdGEsIGNvbnN0IHVpbnQ4X3QgKmRhdGEsDQo+ICAJCQkJCQkJCXVpbnQxNl90IGxlbik7
DQo+IC1ib29sIG1lc2hfaW5pdCh1aW50MTZfdCBpbmRleCwgY29uc3QgY2hhciAqaW5fY29uZmln
X25hbWUpOw0KPiArYm9vbCBtZXNoX2luaXQoY29uc3QgY2hhciAqaW5fY29uZmlnX25hbWUsIGVu
dW0gbWVzaF9pb190eXBlIHR5cGUsIHZvaWQgKm9wdHMpOw0KPiAgdm9pZCBtZXNoX2NsZWFudXAo
dm9pZCk7DQo+ICBib29sIG1lc2hfZGJ1c19pbml0KHN0cnVjdCBsX2RidXMgKmRidXMpOw0KPiAg
DQoNCg0KT3RoZXJ3aXNlLCBJIGxpa2UgaXQgYSBsb3QuLi4uICBNYWtlIHN1cmUgaXQgY29udGlu
dWVzIHRvIHdvcms6DQoxLiBPbiBwbGF0Zm9ybXMgd2l0aCBtdWx0aXBsZSBjb250cm9sbGVycywg
d2l0aCB0aGUgLWkgaGNpWCBvcHRpb24gYnlwYXNzaW5nIHRoZSBNR01UIGNhbGxzDQoyLiBPbiBw
bGF0Zm9ybXMgd2l0aCBtdWx0aXBsZSBjb250cm9sbGVycyB3aXRob3V0IHRoZSAtaSwgd2hlcmUg
TUdNVCBpbnRlcmZhY2UgcGlja3Mgb25lDQozLiBPbiBzaW5nbGUgYW5kIFplcm8gY29udHJvbGxl
ciBzeXN0ZW1zIHdpdGggYm90aCBjYXNlcyAxIGFuZCAyIGFib3ZlLg0KDQpCZXN0IFJlZ2FyZHMs
IA0KQnJpYW4NCg==
