Return-Path: <linux-bluetooth-owner@vger.kernel.org>
X-Original-To: lists+linux-bluetooth@lfdr.de
Delivered-To: lists+linux-bluetooth@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 87EEA5E80C
	for <lists+linux-bluetooth@lfdr.de>; Wed,  3 Jul 2019 17:45:27 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726736AbfGCPp0 (ORCPT <rfc822;lists+linux-bluetooth@lfdr.de>);
        Wed, 3 Jul 2019 11:45:26 -0400
Received: from mga06.intel.com ([134.134.136.31]:27658 "EHLO mga06.intel.com"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1725847AbfGCPp0 (ORCPT <rfc822;linux-bluetooth@vger.kernel.org>);
        Wed, 3 Jul 2019 11:45:26 -0400
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga007.fm.intel.com ([10.253.24.52])
  by orsmga104.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 03 Jul 2019 08:45:25 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.63,446,1557212400"; 
   d="scan'208";a="166022148"
Received: from orsmsx106.amr.corp.intel.com ([10.22.225.133])
  by fmsmga007.fm.intel.com with ESMTP; 03 Jul 2019 08:45:25 -0700
Received: from orsmsx103.amr.corp.intel.com ([169.254.5.135]) by
 ORSMSX106.amr.corp.intel.com ([169.254.1.113]) with mapi id 14.03.0439.000;
 Wed, 3 Jul 2019 08:45:24 -0700
From:   "Gix, Brian" <brian.gix@intel.com>
To:     "michal.lowas-rzechonek@silvair.com" 
        <michal.lowas-rzechonek@silvair.com>,
        "linux-bluetooth@vger.kernel.org" <linux-bluetooth@vger.kernel.org>
CC:     "Stotland, Inga" <inga.stotland@intel.com>
Subject: Re: [PATCH BlueZ v4 3/3] mesh: Handle messages encrypted with a
 remote device key
Thread-Topic: [PATCH BlueZ v4 3/3] mesh: Handle messages encrypted with a
 remote device key
Thread-Index: AQHVMZRs+4eCeG3eF0ycWZvV9eNijKa5ftUA
Date:   Wed, 3 Jul 2019 15:45:24 +0000
Message-ID: <1562168722.23933.25.camel@intel.com>
References: <20190703114214.22320-1-michal.lowas-rzechonek@silvair.com>
         <20190703114214.22320-4-michal.lowas-rzechonek@silvair.com>
In-Reply-To: <20190703114214.22320-4-michal.lowas-rzechonek@silvair.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [10.254.20.71]
Content-Type: text/plain; charset="utf-8"
Content-ID: <141795BDD029C8418BB1C5AC50F6668C@intel.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
Sender: linux-bluetooth-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-bluetooth.vger.kernel.org>
X-Mailing-List: linux-bluetooth@vger.kernel.org

T24gV2VkLCAyMDE5LTA3LTAzIGF0IDEzOjQyICswMjAwLCBNaWNoYcWCIExvd2FzLVJ6ZWNob25l
ayB3cm90ZToNCj4gVGhpcyBhZGRzIGFiaWxpdHkgdG8gcmVjZWl2ZSBtZXNzYWdlcyBlbmNyeXB0
ZWQgdXNpbmcga25vd24gcmVtb3RlDQo+IGRldmljZSBrZXkuIFN1Y2ggYSBrZXkgbXVzdCBiZSBh
ZGRlZCB0byB0aGUgbm9kZSdzIGtleXJpbmcgdXNpbmcNCj4gSW1wb3J0UmVtb3RlTm9kZSgpIG1l
dGhvZCBvZiBvcmcuYmx1ZXoubWVzaC5NYW5hZ2VtZW50MSBpbnRlcmZhY2UuDQo+IA0KPiBEZWNy
eXB0ZWQgbWVzc2FnZXMgYXJlIHRoZW4gZm9yd2FyZGVkIHRvIHRoZSBhcHBsaWNhdGlvbiB1c2lu
Zw0KPiBEZXZLZXlNZXNzYWdlUmVjZWl2ZWQoKSBELUJ1cyBBUEkuDQo+IA0KPiBBbHNvLCBtZXNz
YWdlcyBvcmlnaW5hdGluZyBmcm9tIGEgbG9jYWwgbm9kZSBhbmQgZW5jcnlwdGVkIHVzaW5nIGxv
Y2FsDQo+IGRldmljZSBrZXkgYXJlIGZvcndhcmRlIHRvIHRoZSBhcHBsaWNhdGlvbiBhcyB3ZWxs
LCBpZiB0aGV5IHdlcmVuJ3QNCj4gaGFuZGxlZCBieSBpbnRlcm5hbCBtb2RlbC4gVGhpcyBhbGxv
d3MgZS5nLiByZWNlaXZpbmcgc3RhdHVzIG1lc3NhZ2VzDQo+IGZyb20gYSBsb2NhbCBDb25maWcg
U2VydmVyIGluIHRoZSBhcHBsaWNhdGlvbi4NCj4gLS0tDQo+ICBtZXNoL21vZGVsLmMgfCA2OSAr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tDQo+ICAx
IGZpbGUgY2hhbmdlZCwgNjMgaW5zZXJ0aW9ucygrKSwgNiBkZWxldGlvbnMoLSkNCj4gDQo+IGRp
ZmYgLS1naXQgYS9tZXNoL21vZGVsLmMgYi9tZXNoL21vZGVsLmMNCj4gaW5kZXggYWFlOTEzZDky
Li4wZWE0NTk4N2YgMTAwNjQ0DQo+IC0tLSBhL21lc2gvbW9kZWwuYw0KPiArKysgYi9tZXNoL21v
ZGVsLmMNCj4gQEAgLTMwOCw3ICszMDgsNyBAQCBzdGF0aWMgdm9pZCBmb3J3YXJkX21vZGVsKHZv
aWQgKmEsIHZvaWQgKmIpDQo+ICANCj4gIAlsX2RlYnVnKCJtb2RlbCAlOC44eCB3aXRoIGlkeCAl
My4zeCIsIG1vZC0+aWQsIGZ3ZC0+aWR4KTsNCj4gIA0KPiAtCWlmIChmd2QtPmlkeCAhPSBBUFBf
SURYX0RFVl9MT0NBTCAmJg0KPiArCWlmIChmd2QtPmlkeCAhPSBBUFBfSURYX0RFVl9MT0NBTCAm
JiBmd2QtPmlkeCAhPSBBUFBfSURYX0RFVl9SRU1PVEUgJiYNCj4gIAkJCQkJIWhhc19iaW5kaW5n
KG1vZC0+YmluZGluZ3MsIGZ3ZC0+aWR4KSkNCj4gIAkJcmV0dXJuOw0KPiAgDQo+IEBAIC0zNTks
MTYgKzM1OSwyNSBAQCBzdGF0aWMgaW50IGRldl9wYWNrZXRfZGVjcnlwdChzdHJ1Y3QgbWVzaF9u
b2RlICpub2RlLCBjb25zdCB1aW50OF90ICpkYXRhLA0KPiAgCQkJCXVpbnQxNl90IGRzdCwgdWlu
dDhfdCBrZXlfaWQsIHVpbnQzMl90IHNlcSwNCj4gIAkJCQl1aW50MzJfdCBpdl9pZHgsIHVpbnQ4
X3QgKm91dCkNCj4gIHsNCj4gKwl1aW50OF90IGRldl9rZXlbMTZdOw0KPiAgCWNvbnN0IHVpbnQ4
X3QgKmtleTsNCj4gIA0KPiAgCWtleSA9IG5vZGVfZ2V0X2RldmljZV9rZXkobm9kZSk7DQo+ICAJ
aWYgKCFrZXkpDQo+IC0JCXJldHVybiBmYWxzZTsNCj4gKwkJcmV0dXJuIC0xOw0KPiAgDQo+ICAJ
aWYgKG1lc2hfY3J5cHRvX3BheWxvYWRfZGVjcnlwdChOVUxMLCAwLCBkYXRhLCBzaXplLCBzem1p
Y3QsIHNyYywNCj4gIAkJCQkJZHN0LCBrZXlfaWQsIHNlcSwgaXZfaWR4LCBvdXQsIGtleSkpDQo+
ICAJCXJldHVybiBBUFBfSURYX0RFVl9MT0NBTDsNCj4gIA0KPiArCWlmICgha2V5cmluZ19nZXRf
cmVtb3RlX2Rldl9rZXkobm9kZSwgc3JjLCBkZXZfa2V5KSkNCj4gKwkJcmV0dXJuIC0xOw0KPiAr
DQo+ICsJa2V5ID0gZGV2X2tleTsNCj4gKwlpZiAobWVzaF9jcnlwdG9fcGF5bG9hZF9kZWNyeXB0
KE5VTEwsIDAsIGRhdGEsIHNpemUsIHN6bWljdCwgc3JjLA0KPiArCQkJCQlkc3QsIGtleV9pZCwg
c2VxLCBpdl9pZHgsIG91dCwga2V5KSkNCj4gKwkJcmV0dXJuIEFQUF9JRFhfREVWX1JFTU9URTsN
Cj4gKw0KPiAgCXJldHVybiAtMTsNCj4gIH0NCj4gIA0KPiBAQCAtNjk1LDYgKzcwNCw0NyBAQCBz
dGF0aWMgaW50IGFkZF9zdWIoc3RydWN0IG1lc2hfbmV0ICpuZXQsIHN0cnVjdCBtZXNoX21vZGVs
ICptb2QsDQo+ICAJcmV0dXJuIE1FU0hfU1RBVFVTX1NVQ0NFU1M7DQo+ICB9DQo+ICANCj4gK3N0
YXRpYyB2b2lkIHNlbmRfZGV2X2tleV9tc2dfcmN2ZChzdHJ1Y3QgbWVzaF9ub2RlICpub2RlLCB1
aW50OF90IGVsZV9pZHgsDQo+ICsJCQkJCXVpbnQxNl90IHNyYywgdWludDE2X3QgbmV0X2lkeCwN
Cj4gKwkJCQkJdWludDE2X3Qgc2l6ZSwgY29uc3QgdWludDhfdCAqZGF0YSkNCj4gK3sNCj4gKwlz
dHJ1Y3QgbF9kYnVzICpkYnVzID0gZGJ1c19nZXRfYnVzKCk7DQo+ICsJc3RydWN0IGxfZGJ1c19t
ZXNzYWdlICptc2c7DQo+ICsJc3RydWN0IGxfZGJ1c19tZXNzYWdlX2J1aWxkZXIgKmJ1aWxkZXI7
DQo+ICsJY29uc3QgY2hhciAqb3duZXI7DQo+ICsJY29uc3QgY2hhciAqcGF0aDsNCj4gKw0KPiAr
CW93bmVyID0gbm9kZV9nZXRfb3duZXIobm9kZSk7DQo+ICsJcGF0aCA9IG5vZGVfZ2V0X2VsZW1l
bnRfcGF0aChub2RlLCBlbGVfaWR4KTsNCj4gKwlpZiAoIXBhdGggfHwgIW93bmVyKQ0KPiArCQly
ZXR1cm47DQo+ICsNCj4gKwlsX2RlYnVnKCJTZW5kIFwiRGV2S2V5TWVzc2FnZVJlY2VpdmVkXCIi
KTsNCj4gKw0KPiArCW1zZyA9IGxfZGJ1c19tZXNzYWdlX25ld19tZXRob2RfY2FsbChkYnVzLCBv
d25lciwgcGF0aCwNCj4gKwkJCQkJCU1FU0hfRUxFTUVOVF9JTlRFUkZBQ0UsDQo+ICsJCQkJCQki
RGV2S2V5TWVzc2FnZVJlY2VpdmVkIik7DQo+ICsNCj4gKwlidWlsZGVyID0gbF9kYnVzX21lc3Nh
Z2VfYnVpbGRlcl9uZXcobXNnKTsNCj4gKw0KPiArCWlmICghbF9kYnVzX21lc3NhZ2VfYnVpbGRl
cl9hcHBlbmRfYmFzaWMoYnVpbGRlciwgJ3EnLCAmc3JjKSkNCj4gKwkJZ290byBlcnJvcjsNCj4g
Kw0KPiArCWlmICghbF9kYnVzX21lc3NhZ2VfYnVpbGRlcl9hcHBlbmRfYmFzaWMoYnVpbGRlciwg
J3EnLCAmbmV0X2lkeCkpDQo+ICsJCWdvdG8gZXJyb3I7DQo+ICsNCj4gKwlpZiAoIWRidXNfYXBw
ZW5kX2J5dGVfYXJyYXkoYnVpbGRlciwgZGF0YSwgc2l6ZSkpDQo+ICsJCWdvdG8gZXJyb3I7DQo+
ICsNCj4gKwlpZiAoIWxfZGJ1c19tZXNzYWdlX2J1aWxkZXJfZmluYWxpemUoYnVpbGRlcikpDQo+
ICsJCWdvdG8gZXJyb3I7DQo+ICsNCj4gKwlsX2RidXNfc2VuZChkYnVzLCBtc2cpOw0KPiArDQo+
ICtlcnJvcjoNCj4gKwlsX2RidXNfbWVzc2FnZV9idWlsZGVyX2Rlc3Ryb3koYnVpbGRlcik7DQoN
CkkgdGhpbmsgdGhlcmUgaXMgYSBwb3RlbnRpYWwgbWVtb3J5IGxlYWssIG5vdCBqdXN0IGhlcmUg
YnV0IGluIHRoZSBvdGhlciBtZXRob2RzIHRoYXQgdXNlIHRoaXMgdGVjaG5pcXVlIHRvDQpjb25z
dHJ1Y3QgbWV0aG9kIGNhbGxzIHRvIHRoZSBBcHAgIChzb3JyeSBJIGRpZCBub3QgY2F0Y2ggdGhp
cyBpbiBlYXJsaWVyIHNpdHVhdGlvbnMpDQoNClRvIGdldCB0byB0aGUgZXJyb3IgbGFiZWwsIHdl
IHdpbGwgaGF2ZSBhICJtc2ciIHdoaWNoIGlzIG5ldmVyIHNlbnQgb3IgZnJlZWQuLi4gICBJIHRo
aW5rIGhlcmUsIGFuZCBldmVyeSB3aGVyZQ0KZWxzZSB3aGVyZSB3ZSBoYXZlIGEgcG90ZW50aWFs
bHkgZmFpbGVkIGJ1aWxkZXIsIFdlIG5lZWQgdG8gY2FsbCBsX2RidXNfbWVzc2FnZV91bnJlZiht
c2cpIGlmIHdlIGRvbid0IGVuZCB1cA0Kc2VuZGluZyB0aGUgbXNnLg0KDQpCdXQgSSB3b3VsZCBs
aWtlIEluZ2EncyBvcGluaW9uIG9uIHRoaXMganVkZ2VtZW50IG9uIHRoaXMgYXMgd2VsbC4NCg0K
T3RoZXJ3aXNlLCBJIHRoaW5rIEkgd2lsbCBiZSByZWFkeSB0byBhcHBseSB0aGlzIHdob2xlIHBh
dGNoLXNldC4NCg0KDQo+ICt9DQo+ICsNCj4gIHN0YXRpYyB2b2lkIHNlbmRfbXNnX3JjdmQoc3Ry
dWN0IG1lc2hfbm9kZSAqbm9kZSwgdWludDhfdCBlbGVfaWR4LCBib29sIGlzX3N1YiwNCj4gIAkJ
CQkJdWludDE2X3Qgc3JjLCB1aW50MTZfdCBrZXlfaWR4LA0KPiAgCQkJCQl1aW50MTZfdCBzaXpl
LCBjb25zdCB1aW50OF90ICpkYXRhKQ0KPiBAQCAtODQzLDEwICs4OTMsMTcgQEAgYm9vbCBtZXNo
X21vZGVsX3J4KHN0cnVjdCBtZXNoX25vZGUgKm5vZGUsIGJvb2wgc3ptaWN0LCB1aW50MzJfdCBz
ZXEwLA0KPiAgCQkgKiBDeWNsZSB0aHJvdWdoIGV4dGVybmFsIG1vZGVscyBpZiB0aGUgbWVzc2Fn
ZSBoYXMgbm90IGJlZW4NCj4gIAkJICogaGFuZGxlZCBieSBpbnRlcm5hbCBtb2RlbHMNCj4gIAkJ
ICovDQo+IC0JCWlmIChmb3J3YXJkLmhhc19kc3QgJiYgIWZvcndhcmQuZG9uZSkNCj4gLQkJCXNl
bmRfbXNnX3JjdmQobm9kZSwgaSwgaXNfc3Vic2NyaXB0aW9uLCBzcmMsDQo+IC0JCQkJCWZvcndh
cmQuaWR4LCBmb3J3YXJkLnNpemUsDQo+IC0JCQkJCWZvcndhcmQuZGF0YSk7DQo+ICsJCWlmIChm
b3J3YXJkLmhhc19kc3QgJiYgIWZvcndhcmQuZG9uZSkgew0KPiArCQkJaWYgKChkZWNyeXB0X2lk
eCAmIEFQUF9JRFhfTUFTSykgPT0gZGVjcnlwdF9pZHgpDQo+ICsJCQkJc2VuZF9tc2dfcmN2ZChu
b2RlLCBpLCBpc19zdWJzY3JpcHRpb24sIHNyYywNCj4gKwkJCQkJCWZvcndhcmQuaWR4LCBmb3J3
YXJkLnNpemUsDQo+ICsJCQkJCQlmb3J3YXJkLmRhdGEpOw0KPiArCQkJZWxzZSBpZiAoZGVjcnlw
dF9pZHggPT0gQVBQX0lEWF9ERVZfUkVNT1RFIHx8DQo+ICsJCQkJKGRlY3J5cHRfaWR4ID09IEFQ
UF9JRFhfREVWX0xPQ0FMICYmDQo+ICsJCQkJIG1lc2hfbmV0X2lzX2xvY2FsX2FkZHJlc3MobmV0
LCBzcmMpKSkNCj4gKwkJCQlzZW5kX2Rldl9rZXlfbXNnX3JjdmQobm9kZSwgaSwgc3JjLCAwLA0K
PiArCQkJCQkJZm9yd2FyZC5zaXplLCBmb3J3YXJkLmRhdGEpOw0KPiArCQl9DQo+ICANCj4gIAkJ
LyoNCj4gIAkJICogRWl0aGVyIHRoZSBtZXNzYWdlIGhhcyBiZWVuIHByb2Nlc3NlZCBpbnRlcm5h
bGx5IG9y
