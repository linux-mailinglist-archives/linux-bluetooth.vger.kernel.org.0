Return-Path: <linux-bluetooth-owner@vger.kernel.org>
X-Original-To: lists+linux-bluetooth@lfdr.de
Delivered-To: lists+linux-bluetooth@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 9064B120F70
	for <lists+linux-bluetooth@lfdr.de>; Mon, 16 Dec 2019 17:29:27 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726133AbfLPQ3Z (ORCPT <rfc822;lists+linux-bluetooth@lfdr.de>);
        Mon, 16 Dec 2019 11:29:25 -0500
Received: from mga05.intel.com ([192.55.52.43]:38854 "EHLO mga05.intel.com"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1726092AbfLPQ3Y (ORCPT <rfc822;linux-bluetooth@vger.kernel.org>);
        Mon, 16 Dec 2019 11:29:24 -0500
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
  by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 16 Dec 2019 08:29:23 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,322,1571727600"; 
   d="scan'208";a="415128302"
Received: from orsmsx106.amr.corp.intel.com ([10.22.225.133])
  by fmsmga005.fm.intel.com with ESMTP; 16 Dec 2019 08:29:23 -0800
Received: from orsmsx123.amr.corp.intel.com (10.22.240.116) by
 ORSMSX106.amr.corp.intel.com (10.22.225.133) with Microsoft SMTP Server (TLS)
 id 14.3.439.0; Mon, 16 Dec 2019 08:29:22 -0800
Received: from ORSEDG001.ED.cps.intel.com (10.7.248.4) by
 ORSMSX123.amr.corp.intel.com (10.22.240.116) with Microsoft SMTP Server (TLS)
 id 14.3.439.0; Mon, 16 Dec 2019 08:29:22 -0800
Received: from NAM12-BN8-obe.outbound.protection.outlook.com (104.47.55.171)
 by edgegateway.intel.com (134.134.137.100) with Microsoft SMTP Server (TLS)
 id 14.3.439.0; Mon, 16 Dec 2019 08:29:22 -0800
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=QOdcYJ6gcRjAC7OBN7nuRT3Cizre54sztcq+0yNub8PKwjsPPOFvnHOCcXP0MB+QgZVS+2KLFUHsjld5IrmWA8yA7yRFIlEQL74Q3CO++OL9KV1RR8WDtW2ScN1hV0diNd8//2IwxLyg1sDbU+N/rL4A1z6VAm5NptpqfvCwBGY0LCWT8UHPNIUhgB+hihvm/rh0qOFFl5fnxXrQPRGkRJAQKplESH2Sbjqa+qe1MJODliRrYpbTw8knEgzpABIYlMJhssEQ7dMA9vAE0sg7G+PdVSs5GQX5whBxgG9lnJbjCzFK562OIrX5iv0BiajCcHLExY/bO0gHQYBXpvZuIg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=hf/NsgQrCWO8j5AaldL37h8cahWN3oUPmSW8ILNU4zs=;
 b=QJcaeaIrKB6s9n76mHqgEFUtzESUNMU3/TRij6cGbWEqzW8xQq+dZYgvXhfCaB4ThoMCVYzugCyM2fJ1qGdpA/HM1vrYVWau1oXmHo1lw3GvVa+/DJfp7DbRzTZwVdmL1V68mw0PD94YGytwPyBOnijYcnVnw2mfYIA+25G1/Dh/9hy/lv9PwAhWhLYl18Tj1tLy7IP+OKE5uJOMuobqB50FnAitgANUtYNqQBNXozqeUG+m1sG+Snr1b7L4iWNGj4j40d1xbcWU6mObVemep2jQs84yLtcBw/Mpygfjtejb9AbkVV/1z3wDqdbVcqcfpMw2OdV7JTlE5HVq16D1fA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=intel.com; dmarc=pass action=none header.from=intel.com;
 dkim=pass header.d=intel.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=intel.onmicrosoft.com;
 s=selector2-intel-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=hf/NsgQrCWO8j5AaldL37h8cahWN3oUPmSW8ILNU4zs=;
 b=I744noRAE8NJWGA9LyUqEw8zxCSem/mtkb+wyZZWt8UIj6BNIy76b8e9g0ONwL3FWyJHhZsQrJucro0f0DAZ/jy+FuJuc2zsLjGK6n0sLWGhQSuqRSxVzh2DXRena0zdHWJIEQi+qgM/8QW5e92pP/NReHM/MNVMoWsm5FDnYKA=
Received: from BN6PR11MB1265.namprd11.prod.outlook.com (10.173.32.12) by
 BN6PR11MB0017.namprd11.prod.outlook.com (10.161.157.34) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2538.15; Mon, 16 Dec 2019 16:29:20 +0000
Received: from BN6PR11MB1265.namprd11.prod.outlook.com
 ([fe80::24f7:813e:ce6b:b8e0]) by BN6PR11MB1265.namprd11.prod.outlook.com
 ([fe80::24f7:813e:ce6b:b8e0%11]) with mapi id 15.20.2538.019; Mon, 16 Dec
 2019 16:29:20 +0000
From:   "Gix, Brian" <brian.gix@intel.com>
To:     "linux-bluetooth@vger.kernel.org" <linux-bluetooth@vger.kernel.org>
CC:     "Stotland, Inga" <inga.stotland@intel.com>
Subject: Re: [PATCH BlueZ v2] mesh: Refactor Secure Network Beaconing
Thread-Topic: [PATCH BlueZ v2] mesh: Refactor Secure Network Beaconing
Thread-Index: AQHVsfIcksi42JgdfUW1vOukmKba/Ke8+AqA
Date:   Mon, 16 Dec 2019 16:29:20 +0000
Message-ID: <7e474fddda27eff7d4771cbbe7588a210e8bd534.camel@intel.com>
References: <20191213201505.32480-1-brian.gix@intel.com>
In-Reply-To: <20191213201505.32480-1-brian.gix@intel.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=brian.gix@intel.com; 
x-originating-ip: [192.55.54.40]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: bf6e594f-2982-47b1-d724-08d782451a94
x-ms-traffictypediagnostic: BN6PR11MB0017:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <BN6PR11MB0017B91B170495A8448461C2E1510@BN6PR11MB0017.namprd11.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:7219;
x-forefront-prvs: 02530BD3AA
x-forefront-antispam-report: SFV:NSPM;SFS:(10019020)(366004)(376002)(346002)(136003)(396003)(39860400002)(199004)(189003)(316002)(6512007)(66946007)(36756003)(26005)(6486002)(6916009)(76116006)(478600001)(4326008)(86362001)(6506007)(66476007)(66556008)(2616005)(186003)(8936002)(8676002)(30864003)(81156014)(2906002)(5660300002)(81166006)(66446008)(64756008)(4001150100001)(107886003)(71200400001)(91956017)(579004)(559001)(309714004);DIR:OUT;SFP:1102;SCL:1;SRVR:BN6PR11MB0017;H:BN6PR11MB1265.namprd11.prod.outlook.com;FPR:;SPF:None;LANG:en;PTR:InfoNoRecords;A:1;MX:1;
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: dexoDiZUKYzc7R96Z9zHEDMVBJhE2nb76z5fDW6p1B0hERR+864CJMp7/MVEuoGiqkcd0xxL1hjfAqd6ofB4nuyE2+jX5qUhNLg8Htk0+WVIsfJQGu7XFMLMtlYU+w4NVXQp5FLphCmhGs5hAPNouEB6Y4M386HJ9F2Z1fgOx1Hnw9Qejqj0dTaUcKBjFGswRY0/X5jWIHNNtVE+UoLrH6qj8atCIBlpz27SeHb+2FupojGS50CScTpDubUwoIKZ2ArMviX/mEjEPpVUZ7FldTvdnKjiaTU8xCJmV/3bQqU/8GJ9oppz4vVDTRXrmyFApaxeClm+bXs9/5oUPB1P1xjc1kP6cJ13wXydGpea85tBcPL6SO2qGxK8Qu1gX9CYsil2c78s5kLEXY2gtE11eubb8vxPl/rNVZvN8XqHhXasTBxUZRXecJ98jDKr57/OCtC4ovzypvolrJ4HhvVbpIfa7oKvkgueb7NNIAm2NcYzVU76osPcAds0hGpP+rkc
Content-Type: text/plain; charset="utf-8"
Content-ID: <CAF35BBD7B697E46B0962C1F3C11068C@namprd11.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-Network-Message-Id: bf6e594f-2982-47b1-d724-08d782451a94
X-MS-Exchange-CrossTenant-originalarrivaltime: 16 Dec 2019 16:29:20.4041
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 46c98d88-e344-4ed4-8496-4ed7712e255d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: BemyYDmr8jCgiqwHKVPfD2WtLxD9vjKqq6YFr6tR+0Vx/i/V6bPBIKXkEgQGq1598OlTcsY9KPQTUbFNMokGpQ==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BN6PR11MB0017
X-OriginatorOrg: intel.com
Sender: linux-bluetooth-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-bluetooth.vger.kernel.org>
X-Mailing-List: linux-bluetooth@vger.kernel.org

QXBwbGllZA0KDQpPbiBGcmksIDIwMTktMTItMTMgYXQgMTI6MTUgLTA4MDAsIEJyaWFuIEdpeCB3
cm90ZToNCj4gVGhlIGRhZW1vbiBoYW5kbGVzIG11bHRpcGxlIG5vZGVzLCB0aGF0IG1heSBvciBt
YXkgbm90IGJlIG9uIHRoZSBzYW1lDQo+IG1lc2ggbmV0d29yay4gIFdoaWxlIGVhY2ggbm9kZSBt
eSBiZSBzZXBlcmF0ZWx5IGNvbmZpZ3VyZWQgdG8gYmVhY29uIG9yDQo+IG5vdCBiZWFjb24sIHRo
ZXJlIGlzIG5vdGhpbmcgZ2FpbmVkIChleGNlcHQgcmVkdW5kZW50IHRyYWZmaWMpIGZvciBlYWNo
DQo+IG5vZGUgdG8gYmVhY29uIHNlcGVyYXRlbHkuICBCZWFjb25pbmcgaXMgdGhlcmVmb3JlIGNl
bnRyYWxpemVkIHdpdGggdGhlDQo+IE5ldHdvcmsgS2V5IHRoZSBTTkIgcmVwcmVzZW50cywgd2l0
aCBlYWNoICpyZWNlaXZlZCogYmVhY29uIGRlbGl2ZXJlZA0KPiB0byBlYWNoIG5vZGUuIEJ1dCBm
b3IgU05CcyBnZW5lcmF0ZWQsIHdlIGtlZXAgYSBjb3VudCBvZiBob3cgbWFueSBub2Rlcw0KPiB3
YW50IGJlYWNvbnMgc2VudCBmb3IgYSBzcGVjaWZpYyBrZXkuIElmIDEgb3IgbW9yZSwgd2UgYmVh
Y29uLCBpZiAwDQo+IG5vZGVzIHdhbnQgdGhlIGJlYWNvbiBzZW50LCB0aGVuIHdlIGRvIG5vdCBi
ZWFjb24uDQo+IC0tLQ0KPiAgbWVzaC9tZXNoLWlvLmMgIHwgICAzICsNCj4gIG1lc2gvbmV0LWtl
eXMuYyB8IDIwNCArKysrKysrKysrKysrKysrKysrKysrKysrKystDQo+ICBtZXNoL25ldC1rZXlz
LmggfCAgIDggKysNCj4gIG1lc2gvbmV0LmMgICAgICB8IDM1MCArKysrKysrKysrKysrKysrLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCj4gIG1lc2gvbmV0LmggICAgICB8ICAgMyAr
DQo+ICA1IGZpbGVzIGNoYW5nZWQsIDMyNiBpbnNlcnRpb25zKCspLCAyNDIgZGVsZXRpb25zKC0p
DQo+IA0KPiBkaWZmIC0tZ2l0IGEvbWVzaC9tZXNoLWlvLmMgYi9tZXNoL21lc2gtaW8uYw0KPiBp
bmRleCA5NWE5OWI2YTUuLjFhYjE3M2Q5YyAxMDA2NDQNCj4gLS0tIGEvbWVzaC9tZXNoLWlvLmMN
Cj4gKysrIGIvbWVzaC9tZXNoLWlvLmMNCj4gQEAgLTE3MSw2ICsxNzEsOSBAQCBib29sIG1lc2hf
aW9fc2VuZChzdHJ1Y3QgbWVzaF9pbyAqaW8sIHN0cnVjdCBtZXNoX2lvX3NlbmRfaW5mbyAqaW5m
bywNCj4gIHsNCj4gIAlpbyA9IGxfcXVldWVfZmluZChpb19saXN0LCBtYXRjaF9ieV9pbywgaW8p
Ow0KPiAgDQo+ICsJaWYgKCFpbykNCj4gKwkJaW8gPSBsX3F1ZXVlX3BlZWtfaGVhZChpb19saXN0
KTsNCj4gKw0KPiAgCWlmIChpbyAmJiBpby0+YXBpICYmIGlvLT5hcGktPnNlbmQpDQo+ICAJCXJl
dHVybiBpby0+YXBpLT5zZW5kKGlvLCBpbmZvLCBkYXRhLCBsZW4pOw0KPiAgDQo+IGRpZmYgLS1n
aXQgYS9tZXNoL25ldC1rZXlzLmMgYi9tZXNoL25ldC1rZXlzLmMNCj4gaW5kZXggNWJlN2UwYjU4
Li42NWYwODA4ZGQgMTAwNjQ0DQo+IC0tLSBhL21lc2gvbmV0LWtleXMuYw0KPiArKysgYi9tZXNo
L25ldC1rZXlzLmMNCj4gQEAgLTIzLDE2ICsyMywzNSBAQA0KPiAgDQo+ICAjaW5jbHVkZSA8ZWxs
L2VsbC5oPg0KPiAgDQo+ICsjaW5jbHVkZSAibWVzaC9tZXNoLWRlZnMuaCINCj4gKyNpbmNsdWRl
ICJtZXNoL3V0aWwuaCINCj4gICNpbmNsdWRlICJtZXNoL2NyeXB0by5oIg0KPiArI2luY2x1ZGUg
Im1lc2gvbWVzaC1pby5oIg0KPiArI2luY2x1ZGUgIm1lc2gvbmV0LmgiDQo+ICAjaW5jbHVkZSAi
bWVzaC9uZXQta2V5cy5oIg0KPiAgDQo+ICAjZGVmaW5lIEJFQUNPTl9UWVBFX1NOQgkJMHgwMQ0K
PiAgI2RlZmluZSBLRVlfUkVGUkVTSAkJMHgwMQ0KPiAgI2RlZmluZSBJVl9JTkRFWF9VUERBVEUJ
CTB4MDINCj4gIA0KPiArI2RlZmluZSBCRUFDT05fSU5URVJWQUxfTUlOCTEwDQo+ICsjZGVmaW5l
IEJFQUNPTl9JTlRFUlZBTF9NQVgJNjAwDQo+ICsNCj4gK3N0cnVjdCBuZXRfYmVhY29uIHsNCj4g
KwlzdHJ1Y3QgbF90aW1lb3V0ICp0aW1lb3V0Ow0KPiArCXVpbnQzMl90IHRzOw0KPiArCXVpbnQx
Nl90IG9ic2VydmVfcGVyaW9kOw0KPiArCXVpbnQxNl90IG9ic2VydmVkOw0KPiArCXVpbnQxNl90
IGV4cGVjdGVkOw0KPiArCWJvb2wgaGFsZl9wZXJpb2Q7DQo+ICsJdWludDhfdCBiZWFjb25bMjNd
Ow0KPiArfTsNCj4gKw0KPiAgc3RydWN0IG5ldF9rZXkgew0KPiAgCXVpbnQzMl90IGlkOw0KPiAr
CXN0cnVjdCBuZXRfYmVhY29uIHNuYjsNCj4gIAl1aW50MTZfdCByZWZfY250Ow0KPiArCXVpbnQx
Nl90IGJlYWNvbl9lbmFibGVzOw0KPiAgCXVpbnQ4X3QgZnJpZW5kX2tleTsNCj4gIAl1aW50OF90
IG5pZDsNCj4gIAl1aW50OF90IG1hc3RlclsxNl07DQo+IEBAIC0xNTcsNiArMTc2LDcgQEAgdm9p
ZCBuZXRfa2V5X3VucmVmKHVpbnQzMl90IGlkKQ0KPiAgDQo+ICAJaWYgKGtleSAmJiBrZXktPnJl
Zl9jbnQpIHsNCj4gIAkJaWYgKC0ta2V5LT5yZWZfY250ID09IDApIHsNCj4gKwkJCWxfdGltZW91
dF9yZW1vdmUoa2V5LT5zbmIudGltZW91dCk7DQo+ICAJCQlsX3F1ZXVlX3JlbW92ZShrZXlzLCBr
ZXkpOw0KPiAgCQkJbF9mcmVlKGtleSk7DQo+ICAJCX0NCj4gQEAgLTMwNSwxOCArMzI1LDE4OCBA
QCBib29sIG5ldF9rZXlfc25iX2NvbXBvc2UodWludDMyX3QgaWQsIHVpbnQzMl90IGl2X2luZGV4
LCBib29sIGtyLCBib29sIGl2dSwNCj4gIAkJcmV0dXJuIGZhbHNlOw0KPiAgCX0NCj4gIA0KPiAt
CXNuYlswXSA9IEJFQUNPTl9UWVBFX1NOQjsNCj4gLQlzbmJbMV0gPSAwOw0KPiArCXNuYlswXSA9
IE1FU0hfQURfVFlQRV9CRUFDT047DQo+ICsJc25iWzFdID0gQkVBQ09OX1RZUEVfU05COw0KPiAr
CXNuYlsyXSA9IDA7DQo+ICANCj4gIAlpZiAoa3IpDQo+IC0JCXNuYlsxXSB8PSBLRVlfUkVGUkVT
SDsNCj4gKwkJc25iWzJdIHw9IEtFWV9SRUZSRVNIOw0KPiAgDQo+ICAJaWYgKGl2dSkNCj4gLQkJ
c25iWzFdIHw9IElWX0lOREVYX1VQREFURTsNCj4gKwkJc25iWzJdIHw9IElWX0lOREVYX1VQREFU
RTsNCj4gIA0KPiAtCW1lbWNweShzbmIgKyAyLCBrZXktPm5ldHdvcmssIDgpOw0KPiAtCWxfcHV0
X2JlMzIoaXZfaW5kZXgsIHNuYiArIDEwKTsNCj4gLQlsX3B1dF9iZTY0KGNtYWMsIHNuYiArIDE0
KTsNCj4gKwltZW1jcHkoc25iICsgMywga2V5LT5uZXR3b3JrLCA4KTsNCj4gKwlsX3B1dF9iZTMy
KGl2X2luZGV4LCBzbmIgKyAxMSk7DQo+ICsJbF9wdXRfYmU2NChjbWFjLCBzbmIgKyAxNSk7DQo+
ICANCj4gIAlyZXR1cm4gdHJ1ZTsNCj4gIH0NCj4gKw0KPiArc3RhdGljIHZvaWQgc2VuZF9uZXR3
b3JrX2JlYWNvbihzdHJ1Y3QgbmV0X2tleSAqa2V5KQ0KPiArew0KPiArCXN0cnVjdCBtZXNoX2lv
X3NlbmRfaW5mbyBpbmZvID0gew0KPiArCQkudHlwZSA9IE1FU0hfSU9fVElNSU5HX1RZUEVfR0VO
RVJBTCwNCj4gKwkJLnUuZ2VuLmludGVydmFsID0gMTAwLA0KPiArCQkudS5nZW4uY250ID0gMSwN
Cj4gKwkJLnUuZ2VuLm1pbl9kZWxheSA9IERFRkFVTFRfTUlOX0RFTEFZLA0KPiArCQkudS5nZW4u
bWF4X2RlbGF5ID0gREVGQVVMVF9NQVhfREVMQVkNCj4gKwl9Ow0KPiArDQo+ICsJbWVzaF9pb19z
ZW5kKE5VTEwsICZpbmZvLCBrZXktPnNuYi5iZWFjb24sIHNpemVvZihrZXktPnNuYi5iZWFjb24p
KTsNCj4gK30NCj4gKw0KPiArc3RhdGljIHZvaWQgc25iX3RpbWVvdXQoc3RydWN0IGxfdGltZW91
dCAqdGltZW91dCwgdm9pZCAqdXNlcl9kYXRhKQ0KPiArew0KPiArCXN0cnVjdCBuZXRfa2V5ICpr
ZXkgPSB1c2VyX2RhdGE7DQo+ICsJdWludDMyX3QgaW50ZXJ2YWwsIHNjYWxlX2ZhY3RvcjsNCj4g
Kw0KPiArCS8qIEFsd2F5cyBzZW5kIGF0IGxlYXN0IG9uZSBiZWFjb24gKi8NCj4gKwlzZW5kX25l
dHdvcmtfYmVhY29uKGtleSk7DQo+ICsNCj4gKwkvKiBDb3VudCBvdXIgb3duIGJlYWNvbnMgdG93
YXJkcyB0aGUgdmljaW5pdHkgdG90YWwgKi8NCj4gKwlrZXktPnNuYi5vYnNlcnZlZCsrOw0KPiAr
DQo+ICsJaWYgKCFrZXktPnNuYi5oYWxmX3BlcmlvZCkgew0KPiArDQo+ICsJCWxfZGVidWcoImJl
YWNvbiAlZCBmb3IgJWQgbm9kZXMsIHBlcmlvZCAlZCwgb2JzICVkLCBleHAgJWQiLA0KPiArCQkJ
CQkJa2V5LT5pZCwNCj4gKwkJCQkJCWtleS0+YmVhY29uX2VuYWJsZXMsDQo+ICsJCQkJCQlrZXkt
PnNuYi5vYnNlcnZlX3BlcmlvZCwNCj4gKwkJCQkJCWtleS0+c25iLm9ic2VydmVkLA0KPiArCQkJ
CQkJa2V5LT5zbmIuZXhwZWN0ZWQpOw0KPiArDQo+ICsNCj4gKwkJaW50ZXJ2YWwgPSAoa2V5LT5z
bmIub2JzZXJ2ZV9wZXJpb2QgKiBrZXktPnNuYi5vYnNlcnZlZCkNCj4gKwkJCQkJCQkvIGtleS0+
c25iLmV4cGVjdGVkOw0KPiArDQo+ICsJCS8qIExpbWl0IEluY3JlYXNlcyBhbmQgRGVjcmVhc2Vz
IGJ5IDEwIHNlY29uZHMgVXAgYW5kDQo+ICsJCSAqIDIwIHNlY29uZHMgZG93biBlYWNoIHN0ZXAs
IHRvIGF2b2lkIGdvaW5nIG5lYXJseSBzaWxlbnQNCj4gKwkJICogaW4gaGlnaGx5IHBvcHVsYXRl
ZCBlbnZpcm9ubWVudHMuDQo+ICsJCSAqLw0KPiArCQlpZiAoaW50ZXJ2YWwgLSAxMCA+IGtleS0+
c25iLm9ic2VydmVfcGVyaW9kKQ0KPiArCQkJaW50ZXJ2YWwgPSBrZXktPnNuYi5vYnNlcnZlX3Bl
cmlvZCArIDEwOw0KPiArCQllbHNlIGlmIChpbnRlcnZhbCArIDIwIDwga2V5LT5zbmIub2JzZXJ2
ZV9wZXJpb2QpDQo+ICsJCQlpbnRlcnZhbCA9IGtleS0+c25iLm9ic2VydmVfcGVyaW9kIC0gMjA7
DQo+ICsNCj4gKwkJLyogQmVhY29uaW5nIG11c3QgYmUgbm8gKnNsb3dlciogdGhhbiBvbmNlIGV2
ZXJ5IDEwIG1pbnV0ZXMsDQo+ICsJCSAqIGFuZCBubyAqZmFzdGVyKiB0aGFuIG9uY2UgZXZlcnkg
MTAgc2Vjb25kcywgcGVyIHNwZWMuDQo+ICsJCSAqIE9ic2VydmF0aW9uIHBlcmlvZCBpcyB0d2lj
ZSBiZWFjb25pbmcgcGVyaW9kLg0KPiArCQkgKi8NCj4gKwkJaWYgKGludGVydmFsIDwgQkVBQ09O
X0lOVEVSVkFMX01JTiAqIDIpDQo+ICsJCQlpbnRlcnZhbCA9IEJFQUNPTl9JTlRFUlZBTF9NSU4g
KiAyOw0KPiArCQllbHNlIGlmIChpbnRlcnZhbCA+IEJFQUNPTl9JTlRFUlZBTF9NQVggKiAyKQ0K
PiArCQkJaW50ZXJ2YWwgPSBCRUFDT05fSU5URVJWQUxfTUFYICogMjsNCj4gKw0KPiArCQlrZXkt
PnNuYi5vYnNlcnZlX3BlcmlvZCA9IGludGVydmFsOw0KPiArCQlrZXktPnNuYi5vYnNlcnZlZCA9
IDA7DQo+ICsNCj4gKwkJLyogVG8gcHJldmVudCAib3ZlciBzbG93aW5nIiBvZiB0aGUgYmVhY29u
aW5nIGZyZXF1ZW5jeSwNCj4gKwkJICogcmVxdWlyZSBtb3JlIHNpZ25pZmljYW50ICJvdmVyIG9i
c2VydmluZyIgdGhlIHNsb3dlcg0KPiArCQkgKiBvdXIgb3duIGJlYWNvbmluZyBmcmVxdWVuY3ku
DQo+ICsJCSAqLw0KPiArCQlrZXktPnNuYi5leHBlY3RlZCA9IGludGVydmFsIC8gMTA7DQo+ICsJ
CXNjYWxlX2ZhY3RvciA9IGludGVydmFsIC8gNjA7DQo+ICsJCWtleS0+c25iLmV4cGVjdGVkICs9
IHNjYWxlX2ZhY3RvciAqIDM7DQo+ICsJfQ0KPiArDQo+ICsJaW50ZXJ2YWwgPSBrZXktPnNuYi5v
YnNlcnZlX3BlcmlvZCAvIDI7DQo+ICsJa2V5LT5zbmIudHMgPSBnZXRfdGltZXN0YW1wX3NlY3Mo
KTsNCj4gKwlrZXktPnNuYi5oYWxmX3BlcmlvZCA9ICFrZXktPnNuYi5oYWxmX3BlcmlvZDsNCj4g
Kw0KPiArCWlmIChrZXktPmJlYWNvbl9lbmFibGVzKQ0KPiArCQlsX3RpbWVvdXRfbW9kaWZ5KHRp
bWVvdXQsIGludGVydmFsKTsNCj4gKwllbHNlIHsNCj4gKwkJbF90aW1lb3V0X3JlbW92ZSh0aW1l
b3V0KTsNCj4gKwkJa2V5LT5zbmIudGltZW91dCA9IE5VTEw7DQo+ICsJfQ0KPiArfQ0KPiArDQo+
ICt2b2lkIG5ldF9rZXlfYmVhY29uX3NlZW4odWludDMyX3QgaWQpDQo+ICt7DQo+ICsJc3RydWN0
IG5ldF9rZXkgKmtleSA9IGxfcXVldWVfZmluZChrZXlzLCBtYXRjaF9pZCwgTF9VSU5UX1RPX1BU
UihpZCkpOw0KPiArDQo+ICsJaWYgKGtleSkNCj4gKwkJa2V5LT5zbmIub2JzZXJ2ZWQrKzsNCj4g
K30NCj4gKw0KPiArdm9pZCBuZXRfa2V5X2JlYWNvbl9lbmFibGUodWludDMyX3QgaWQpDQo+ICt7
DQo+ICsJc3RydWN0IG5ldF9rZXkgKmtleSA9IGxfcXVldWVfZmluZChrZXlzLCBtYXRjaF9pZCwg
TF9VSU5UX1RPX1BUUihpZCkpOw0KPiArCWJvb2wgZW5hYmxlZDsNCj4gKwl1aW50MzJfdCByYW5k
X21zOw0KPiArDQo+ICsJaWYgKCFrZXkpDQo+ICsJCXJldHVybjsNCj4gKw0KPiArCWVuYWJsZWQg
PSAhIWtleS0+YmVhY29uX2VuYWJsZXM7DQo+ICsJa2V5LT5iZWFjb25fZW5hYmxlcysrOw0KPiAr
DQo+ICsJLyogSWYgYWxyZWFkeSBFbmFibGVkLCBkbyBub3RoaW5nICovDQo+ICsJaWYgKGVuYWJs
ZWQpDQo+ICsJCXJldHVybjsNCj4gKw0KPiArCS8qIFJhbmRvbWl6ZSBmaXJzdCB0aW1lb3V0IHRv
IGF2b2lkIGJ1cnN0cyBvZiBiZWFjb25zICovDQo+ICsJbF9nZXRyYW5kb20oJnJhbmRfbXMsIHNp
emVvZihyYW5kX21zKSk7DQo+ICsJcmFuZF9tcyAlPSAoQkVBQ09OX0lOVEVSVkFMX01JTiAqIDEw
MDApOw0KPiArCXJhbmRfbXMrKzsNCj4gKw0KPiArCS8qIEVuYWJsZSBQZXJpb2RpYyBCZWFjb25p
bmcgb24gdGhpcyBrZXkgKi8NCj4gKwlrZXktPnNuYi50cyA9IGdldF90aW1lc3RhbXBfc2Vjcygp
Ow0KPiArCWtleS0+c25iLm9ic2VydmVfcGVyaW9kID0gQkVBQ09OX0lOVEVSVkFMX01JTiAqIDI7
DQo+ICsJa2V5LT5zbmIuZXhwZWN0ZWQgPSAyOw0KPiArCWtleS0+c25iLm9ic2VydmVkID0gMDsN
Cj4gKwlrZXktPnNuYi5oYWxmX3BlcmlvZCA9IHRydWU7DQo+ICsJbF90aW1lb3V0X3JlbW92ZShr
ZXktPnNuYi50aW1lb3V0KTsNCj4gKwlrZXktPnNuYi50aW1lb3V0ID0gbF90aW1lb3V0X2NyZWF0
ZV9tcyhyYW5kX21zLCBzbmJfdGltZW91dCwga2V5LCBOVUxMKTsNCj4gK30NCj4gKw0KPiArYm9v
bCBuZXRfa2V5X2JlYWNvbl9yZWZyZXNoKHVpbnQzMl90IGlkLCB1aW50MzJfdCBpdl9pbmRleCwg
Ym9vbCBrciwgYm9vbCBpdnUpDQo+ICt7DQo+ICsJc3RydWN0IG5ldF9rZXkgKmtleSA9IGxfcXVl
dWVfZmluZChrZXlzLCBtYXRjaF9pZCwgTF9VSU5UX1RPX1BUUihpZCkpOw0KPiArCXVpbnQ4X3Qg
YmVhY29uWzIzXTsNCj4gKwl1aW50MzJfdCByYW5kX21zOw0KPiArDQo+ICsJaWYgKCFrZXkpDQo+
ICsJCXJldHVybiBmYWxzZTsNCj4gKw0KPiArCWlmICghbmV0X2tleV9zbmJfY29tcG9zZShpZCwg
aXZfaW5kZXgsIGtyLCBpdnUsIGJlYWNvbikpDQo+ICsJCXJldHVybiBmYWxzZTsNCj4gKw0KPiAr
CWlmIChtZW1jbXAoa2V5LT5zbmIuYmVhY29uLCBiZWFjb24sIHNpemVvZihiZWFjb24pKSkNCj4g
KwkJbWVtY3B5KGtleS0+c25iLmJlYWNvbiwgYmVhY29uLCBzaXplb2YoYmVhY29uKSk7DQo+ICsJ
ZWxzZQ0KPiArCQlyZXR1cm4gZmFsc2U7DQo+ICsNCj4gKwlsX2RlYnVnKCJTZXR0aW5nIFNOQjog
SVZJOiAlOC44eCwgSVZVOiAlZCwgS1I6ICVkIiwgaXZfaW5kZXgsIGl2dSwga3IpOw0KPiArCXBy
aW50X3BhY2tldCgiU2V0IFNOQiBCZWFjb24gdG8iLCBiZWFjb24sIHNpemVvZihiZWFjb24pKTsN
Cj4gKw0KPiArCS8qIFNlbmQgb25lIG5ldyBTTkIgc29vbiwgYWZ0ZXIgYWxsIG5vZGVzIGhhdmUg
c2VlbiBpdCAqLw0KPiArCWxfZ2V0cmFuZG9tKCZyYW5kX21zLCBzaXplb2YocmFuZF9tcykpOw0K
PiArCXJhbmRfbXMgJT0gMTAwMDsNCj4gKwlrZXktPnNuYi5leHBlY3RlZCsrOw0KPiArDQo+ICsJ
aWYgKGtleS0+c25iLnRpbWVvdXQpDQo+ICsJCWxfdGltZW91dF9tb2RpZnlfbXMoa2V5LT5zbmIu
dGltZW91dCwgNTAwICsgcmFuZF9tcyk7DQo+ICsJZWxzZQ0KPiArCQlrZXktPnNuYi50aW1lb3V0
ID0gbF90aW1lb3V0X2NyZWF0ZV9tcyg1MDAgKyByYW5kX21zLA0KPiArCQkJCQkJc25iX3RpbWVv
dXQsIGtleSwgTlVMTCk7DQo+ICsNCj4gKwlyZXR1cm4gdHJ1ZTsNCj4gK30NCj4gKw0KPiArdm9p
ZCBuZXRfa2V5X2JlYWNvbl9kaXNhYmxlKHVpbnQzMl90IGlkKQ0KPiArew0KPiArCXN0cnVjdCBu
ZXRfa2V5ICprZXkgPSBsX3F1ZXVlX2ZpbmQoa2V5cywgbWF0Y2hfaWQsIExfVUlOVF9UT19QVFIo
aWQpKTsNCj4gKw0KPiArCWlmICgha2V5IHx8ICFrZXktPmJlYWNvbl9lbmFibGVzKQ0KPiArCQly
ZXR1cm47DQo+ICsNCj4gKwlrZXktPmJlYWNvbl9lbmFibGVzLS07DQo+ICsNCj4gKwlpZiAoa2V5
LT5iZWFjb25fZW5hYmxlcykNCj4gKwkJcmV0dXJuOw0KPiArDQo+ICsJLyogRGlzYWJsZSBwZXJp
b2RpYyBCZWFjb25pbmcgb24gdGhpcyBrZXkgKi8NCj4gKwlsX3RpbWVvdXRfcmVtb3ZlKGtleS0+
c25iLnRpbWVvdXQpOw0KPiArCWtleS0+c25iLnRpbWVvdXQgPSBOVUxMOw0KPiArfQ0KPiBkaWZm
IC0tZ2l0IGEvbWVzaC9uZXQta2V5cy5oIGIvbWVzaC9uZXQta2V5cy5oDQo+IGluZGV4IGQ1NGM1
MjE1Ni4uM2MyYzRkMGRhIDEwMDY0NA0KPiAtLS0gYS9tZXNoL25ldC1rZXlzLmgNCj4gKysrIGIv
bWVzaC9uZXQta2V5cy5oDQo+IEBAIC0xNyw2ICsxNywxMCBAQA0KPiAgICoNCj4gICAqLw0KPiAg
DQo+ICsjZGVmaW5lIEJFQUNPTl9UWVBFX1NOQgkJMHgwMQ0KPiArI2RlZmluZSBLRVlfUkVGUkVT
SAkJMHgwMQ0KPiArI2RlZmluZSBJVl9JTkRFWF9VUERBVEUJCTB4MDINCj4gKw0KPiAgYm9vbCBu
ZXRfa2V5X2NvbmZpcm0odWludDMyX3QgaWQsIGNvbnN0IHVpbnQ4X3QgbWFzdGVyWzE2XSk7DQo+
ICBib29sIG5ldF9rZXlfcmV0cmlldmUodWludDMyX3QgaWQsIHVpbnQ4X3QgKm1hc3Rlcik7DQo+
ICB1aW50MzJfdCBuZXRfa2V5X2FkZChjb25zdCB1aW50OF90IG1hc3RlclsxNl0pOw0KPiBAQCAt
MzEsMyArMzUsNyBAQCBib29sIG5ldF9rZXlfc25iX2NoZWNrKHVpbnQzMl90IGlkLCB1aW50MzJf
dCBpdl9pbmRleCwgYm9vbCBrciwgYm9vbCBpdnUsDQo+ICAJCQkJCQkJCXVpbnQ2NF90IGNtYWMp
Ow0KPiAgYm9vbCBuZXRfa2V5X3NuYl9jb21wb3NlKHVpbnQzMl90IGlkLCB1aW50MzJfdCBpdl9p
bmRleCwgYm9vbCBrciwgYm9vbCBpdnUsDQo+ICAJCQkJCQkJCXVpbnQ4X3QgKnNuYik7DQo+ICt2
b2lkIG5ldF9rZXlfYmVhY29uX3NlZW4odWludDMyX3QgaWQpOw0KPiArdm9pZCBuZXRfa2V5X2Jl
YWNvbl9lbmFibGUodWludDMyX3QgaWQpOw0KPiArYm9vbCBuZXRfa2V5X2JlYWNvbl9yZWZyZXNo
KHVpbnQzMl90IGlkLCB1aW50MzJfdCBpdl9pbmRleCwgYm9vbCBrciwgYm9vbCBpdnUpOw0KPiAr
dm9pZCBuZXRfa2V5X2JlYWNvbl9kaXNhYmxlKHVpbnQzMl90IGlkKTsNCj4gZGlmZiAtLWdpdCBh
L21lc2gvbmV0LmMgYi9tZXNoL25ldC5jDQo+IGluZGV4IGY2NjJkOGE5MS4uZTcwOGIyYWE0IDEw
MDY0NA0KPiAtLS0gYS9tZXNoL25ldC5jDQo+ICsrKyBiL21lc2gvbmV0LmMNCj4gQEAgLTUzLDE1
ICs1Myw5IEBADQo+ICAjZGVmaW5lIFNFR19UTwkyDQo+ICAjZGVmaW5lIE1TR19UTwk2MA0KPiAg
DQo+IC0jZGVmaW5lIERFRkFVTFRfTUlOX0RFTEFZCQkwDQo+IC0jZGVmaW5lIERFRkFVTFRfTUFY
X0RFTEFZCQkyNQ0KPiAtDQo+ICAjZGVmaW5lIERFRkFVTFRfVFJBTlNNSVRfQ09VTlQJCTENCj4g
ICNkZWZpbmUgREVGQVVMVF9UUkFOU01JVF9JTlRFUlZBTAkxMDANCj4gIA0KPiAtI2RlZmluZSBC
RUFDT05fSU5URVJWQUxfTUlOCTEwDQo+IC0jZGVmaW5lIEJFQUNPTl9JTlRFUlZBTF9NQVgJNjAw
DQo+IC0NCj4gICNkZWZpbmUgU0FSX0tFWShzcmMsIHNlcTApCSgoKCh1aW50MzJfdCkoc2VxMCkp
IDw8IDE2KSB8IChzcmMpKQ0KPiAgDQo+ICBlbnVtIF9yZWxheV9hZHZpY2Ugew0KPiBAQCAtOTAs
MjMgKzg0LDEyIEBAIHN0cnVjdCBuZXRfa2V5IHsNCj4gIAl1aW50OF90IG5ldHdvcmtfaWRbOF07
DQo+ICB9Ow0KPiAgDQo+IC1zdHJ1Y3QgbWVzaF9iZWFjb24gew0KPiAtCXN0cnVjdCBsX3RpbWVv
dXQgKnRpbWVvdXQ7DQo+IC0JdWludDMyX3QgdHM7DQo+IC0JdWludDE2X3Qgb2JzZXJ2ZV9wZXJp
b2Q7DQo+IC0JdWludDE2X3Qgb2JzZXJ2ZWQ7DQo+IC0JdWludDE2X3QgZXhwZWN0ZWQ7DQo+IC0J
dWludDhfdCBoYWxmX3BlcmlvZDsNCj4gLQl1aW50OF90IGJlYWNvblsyM107DQo+IC19Ow0KPiAt
DQo+ICBzdHJ1Y3QgbWVzaF9zdWJuZXQgew0KPiAgCXN0cnVjdCBtZXNoX25ldCAqbmV0Ow0KPiAg
CXVpbnQxNl90IGlkeDsNCj4gIAl1aW50MzJfdCBuZXRfa2V5X3R4Ow0KPiAgCXVpbnQzMl90IG5l
dF9rZXlfY3VyOw0KPiAgCXVpbnQzMl90IG5ldF9rZXlfdXBkOw0KPiAtCXN0cnVjdCBtZXNoX2Jl
YWNvbiBzbmI7DQo+ICAJdWludDhfdCBrZXlfcmVmcmVzaDsNCj4gIAl1aW50OF90IGtyX3BoYXNl
Ow0KPiAgfTsNCj4gQEAgLTI2MCw4ICsyNDMsMTEgQEAgc3RydWN0IG5ldF9xdWV1ZV9kYXRhIHsN
Cj4gIH07DQo+ICANCj4gIHN0cnVjdCBuZXRfYmVhY29uX2RhdGEgew0KPiAtCWNvbnN0IHVpbnQ4
X3QgKmRhdGE7DQo+IC0JdWludDE2X3QgbGVuOw0KPiArCXVpbnQzMl90IGtleV9pZDsNCj4gKwl1
aW50MzJfdCBpdmk7DQo+ICsJYm9vbCBpdnU7DQo+ICsJYm9vbCBrcjsNCj4gKwlib29sIHByb2Nl
c3NlZDsNCj4gIH07DQo+ICANCj4gICNkZWZpbmUgRkFTVF9DQUNIRV9TSVpFIDgNCj4gQEAgLTU3
MCw5ICs1NTYsNiBAQCBzdGF0aWMgdm9pZCBzdWJuZXRfZnJlZSh2b2lkICpkYXRhKQ0KPiAgCWxf
ZnJlZShzdWJuZXQpOw0KPiAgfQ0KPiAgDQo+IC1zdGF0aWMgdm9pZCBscG5fcHJvY2Vzc19iZWFj
b24odm9pZCAqdXNlcl9kYXRhLCBjb25zdCB2b2lkICpkYXRhLCB1aW50OF90IHNpemUsDQo+IC0J
CQkJCQkJCWludDhfdCByc3NpKTsNCj4gLQ0KPiAgc3RhdGljIHN0cnVjdCBtZXNoX3N1Ym5ldCAq
c3VibmV0X25ldyhzdHJ1Y3QgbWVzaF9uZXQgKm5ldCwgdWludDE2X3QgaWR4KQ0KPiAgew0KPiAg
CXN0cnVjdCBtZXNoX3N1Ym5ldCAqc3VibmV0Ow0KPiBAQCAtNTgzLDkzICs1NjYsNzEgQEAgc3Rh
dGljIHN0cnVjdCBtZXNoX3N1Ym5ldCAqc3VibmV0X25ldyhzdHJ1Y3QgbWVzaF9uZXQgKm5ldCwg
dWludDE2X3QgaWR4KQ0KPiAgDQo+ICAJc3VibmV0LT5uZXQgPSBuZXQ7DQo+ICAJc3VibmV0LT5p
ZHggPSBpZHg7DQo+IC0Jc3VibmV0LT5zbmIuYmVhY29uWzBdID0gTUVTSF9BRF9UWVBFX0JFQUNP
TjsNCj4gIAlyZXR1cm4gc3VibmV0Ow0KPiAgfQ0KPiAgDQo+IC1zdGF0aWMgYm9vbCBjcmVhdGVf
c2VjdXJlX2JlYWNvbihzdHJ1Y3QgbWVzaF9uZXQgKm5ldCwNCj4gLQkJCQkJc3RydWN0IG1lc2hf
c3VibmV0ICpzdWJuZXQsDQo+IC0JCQkJCXVpbnQ4X3QgKmJlYWNvbl9kYXRhKQ0KPiArc3RhdGlj
IHZvaWQgZW5hYmxlX2JlYWNvbih2b2lkICphLCB2b2lkICpiKQ0KPiAgew0KPiAtCWJvb2wga3Ig
PSAoc3VibmV0LT5rcl9waGFzZSA9PSBLRVlfUkVGUkVTSF9QSEFTRV9UV08pOw0KPiArCXN0cnVj
dCBtZXNoX3N1Ym5ldCAqc3VibmV0ID0gYTsNCj4gKwlzdHJ1Y3QgbWVzaF9uZXQgKm5ldCA9IGI7
DQo+ICANCj4gLQlyZXR1cm4gbmV0X2tleV9zbmJfY29tcG9zZShzdWJuZXQtPm5ldF9rZXlfdHgs
IG5ldC0+aXZfaW5kZXgsDQo+IC0JCQkJCWtyLCBuZXQtPml2X3VwZGF0ZSwgYmVhY29uX2RhdGEp
Ow0KPiArCWlmIChuZXQtPmJlYWNvbl9lbmFibGUpDQo+ICsJCW5ldF9rZXlfYmVhY29uX2VuYWJs
ZShzdWJuZXQtPm5ldF9rZXlfdHgpOw0KPiArCWVsc2UNCj4gKwkJbmV0X2tleV9iZWFjb25fZGlz
YWJsZShzdWJuZXQtPm5ldF9rZXlfdHgpOw0KPiAgfQ0KPiAgDQo+IC1zdGF0aWMgdm9pZCBzZW5k
X25ldHdvcmtfYmVhY29uKHN0cnVjdCBtZXNoX3N1Ym5ldCAqc3VibmV0LA0KPiAtCQkJCQkJCXN0
cnVjdCBtZXNoX25ldCAqbmV0KQ0KPiArc3RhdGljIHZvaWQgZW5xdWV1ZV91cGRhdGUodm9pZCAq
YSwgdm9pZCAqYik7DQo+ICsNCj4gK3N0YXRpYyB2b2lkIHF1ZXVlX2ZyaWVuZF91cGRhdGUoc3Ry
dWN0IG1lc2hfbmV0ICpuZXQpDQo+ICB7DQo+IC0Jc3RydWN0IG1lc2hfaW9fc2VuZF9pbmZvIGlu
Zm8gPSB7DQo+IC0JCS50eXBlID0gTUVTSF9JT19USU1JTkdfVFlQRV9HRU5FUkFMLA0KPiAtCQku
dS5nZW4uaW50ZXJ2YWwgPSBuZXQtPnR4X2ludGVydmFsLA0KPiAtCQkudS5nZW4uY250ID0gMSwN
Cj4gLQkJLnUuZ2VuLm1pbl9kZWxheSA9IERFRkFVTFRfTUlOX0RFTEFZLA0KPiAtCQkudS5nZW4u
bWF4X2RlbGF5ID0gREVGQVVMVF9NQVhfREVMQVkNCj4gLQl9Ow0KPiArCXN0cnVjdCBtZXNoX3N1
Ym5ldCAqc3VibmV0Ow0KPiArCXN0cnVjdCBtZXNoX2ZyaWVuZCAqZnJuZDsNCj4gKwl1aW50OF90
IGZsYWdzID0gMDsNCj4gIA0KPiAtCWxfaW5mbygiU2VuZCBTTkIgb24gbmV0d29yayAlMy4zeCIs
IHN1Ym5ldC0+aWR4KTsNCj4gLQltZXNoX2lvX3NlbmQobmV0LT5pbywgJmluZm8sIHN1Ym5ldC0+
c25iLmJlYWNvbiwNCj4gLQkJCQkJCXNpemVvZihzdWJuZXQtPnNuYi5iZWFjb24pKTsNCj4gLX0N
Cj4gKwlpZiAobF9xdWV1ZV9sZW5ndGgobmV0LT5mcmllbmRzKSkgew0KPiArCQlzdHJ1Y3QgbWVz
aF9mcmllbmRfbXNnIHVwZGF0ZSA9IHsNCj4gKwkJCS5zcmMgPSBuZXQtPnNyY19hZGRyLA0KPiAr
CQkJLml2X2luZGV4ID0gbWVzaF9uZXRfZ2V0X2l2X2luZGV4KG5ldCksDQo+ICsJCQkubGFzdF9s
ZW4gPSA3LA0KPiArCQkJLmN0bCA9IHRydWUsDQo+ICsJCX07DQo+ICANCj4gLXN0YXRpYyB2b2lk
IG5ldHdvcmtfYmVhY29uX3RpbWVvdXQoc3RydWN0IGxfdGltZW91dCAqdGltZW91dCwgdm9pZCAq
dXNlcl9kYXRhKQ0KPiAtew0KPiAtCXN0cnVjdCBtZXNoX3N1Ym5ldCAqc3VibmV0ID0gdXNlcl9k
YXRhOw0KPiAtCXVpbnQzMl90IGludGVydmFsOw0KPiArCQlmcm5kID0gbF9xdWV1ZV9wZWVrX2hl
YWQobmV0LT5mcmllbmRzKTsNCj4gKwkJc3VibmV0ID0gbF9xdWV1ZV9maW5kKG5ldC0+c3VibmV0
cywgbWF0Y2hfa2V5X2luZGV4LA0KPiArCQkJCQkJTF9VSU5UX1RPX1BUUihmcm5kLT5uZXRfaWR4
KSk7DQo+ICANCj4gLQlzZW5kX25ldHdvcmtfYmVhY29uKHN1Ym5ldCwgc3VibmV0LT5uZXQpOw0K
PiArCQlpZiAoIXN1Ym5ldCkNCj4gKwkJCXJldHVybjsNCj4gIA0KPiAtCWlmICghc3VibmV0LT5z
bmIuaGFsZl9wZXJpb2QpIHsNCj4gLQkJbF9kZWJ1ZygiYmVhY29uIFRPIHBlcmlvZCAlZCwgb2Jz
ZXJ2ZWQgJWQsIGV4cGVjdGVkICVkIiwNCj4gLQkJCQkJCXN1Ym5ldC0+c25iLm9ic2VydmVfcGVy
aW9kLA0KPiAtCQkJCQkJc3VibmV0LT5zbmIub2JzZXJ2ZWQsDQo+IC0JCQkJCQlzdWJuZXQtPnNu
Yi5leHBlY3RlZCk7DQo+IC0JCWludGVydmFsID0gc3VibmV0LT5zbmIub2JzZXJ2ZV9wZXJpb2Qg
Kg0KPiAtCQkJKHN1Ym5ldC0+c25iLm9ic2VydmVkICsgMSkgLyBzdWJuZXQtPnNuYi5leHBlY3Rl
ZDsNCj4gLQkJc3VibmV0LT5zbmIub2JzZXJ2ZV9wZXJpb2QgPSBpbnRlcnZhbCAqIDI7DQo+IC0J
CXN1Ym5ldC0+c25iLmV4cGVjdGVkID0gc3VibmV0LT5zbmIub2JzZXJ2ZV9wZXJpb2QgLyAxMDsN
Cj4gLQkJc3VibmV0LT5zbmIub2JzZXJ2ZWQgPSAwOw0KPiAtCX0gZWxzZQ0KPiAtCQlpbnRlcnZh
bCA9IHN1Ym5ldC0+c25iLm9ic2VydmVfcGVyaW9kIC8gMjsNCj4gKwkJaWYgKHN1Ym5ldC0+a3Jf
cGhhc2UgPT0gS0VZX1JFRlJFU0hfUEhBU0VfVFdPKQ0KPiArCQkJZmxhZ3MgfD0gS0VZX1JFRlJF
U0g7DQo+ICANCj4gLQlpZiAoaW50ZXJ2YWwgPCBCRUFDT05fSU5URVJWQUxfTUlOKQ0KPiAtCQlp
bnRlcnZhbCA9IEJFQUNPTl9JTlRFUlZBTF9NSU47DQo+ICsJCWlmIChuZXQtPml2X3VwZGF0ZSkN
Cj4gKwkJCWZsYWdzIHw9IElWX0lOREVYX1VQREFURTsNCj4gIA0KPiAtCWlmIChpbnRlcnZhbCA+
IEJFQUNPTl9JTlRFUlZBTF9NQVgpDQo+IC0JCWludGVydmFsID0gQkVBQ09OX0lOVEVSVkFMX01B
WDsNCj4gKwkJdXBkYXRlLnUub25lWzBdLmhkciA9IE5FVF9PUF9GUk5EX1VQREFURSA8PCBPUENP
REVfSERSX1NISUZUOw0KPiArCQl1cGRhdGUudS5vbmVbMF0uc2VxID0gbWVzaF9uZXRfbmV4dF9z
ZXFfbnVtKG5ldCk7DQo+ICsJCXVwZGF0ZS51Lm9uZVswXS5kYXRhWzBdID0gTkVUX09QX0ZSTkRf
VVBEQVRFOw0KPiArCQl1cGRhdGUudS5vbmVbMF0uZGF0YVsxXSA9IGZsYWdzOw0KPiArCQlsX3B1
dF9iZTMyKG5ldC0+aXZfaW5kZXgsIHVwZGF0ZS51Lm9uZVswXS5kYXRhICsgMik7DQo+ICsJCXVw
ZGF0ZS51Lm9uZVswXS5kYXRhWzZdID0gMHgwMTsgLyogTW9yZSBEYXRhICovDQo+ICsJCS8qIHBy
aW50X3BhY2tldCgiRnJuZC1CZWFjb24tU1JDIiwNCj4gKwkJICoJCQliZWFjb25fZGF0YSwgc2l6
ZW9mKGJlYWNvbl9kYXRhKSk7DQo+ICsJCSAqLw0KPiArCQkvKiBwcmludF9wYWNrZXQoIkZybmQt
VXBkYXRlIiwgdXBkYXRlLnUub25lWzBdLmRhdGEsIDYpOyAqLw0KPiAgDQo+IC0Jc3VibmV0LT5z
bmIudHMgPSBnZXRfdGltZXN0YW1wX3NlY3MoKTsNCj4gLQlzdWJuZXQtPnNuYi5oYWxmX3Blcmlv
ZCBePSAxOw0KPiAtCWxfdGltZW91dF9tb2RpZnkodGltZW91dCwgaW50ZXJ2YWwpOw0KPiArCQls
X3F1ZXVlX2ZvcmVhY2gobmV0LT5mcmllbmRzLCBlbnF1ZXVlX3VwZGF0ZSwgJnVwZGF0ZSk7DQo+
ICsJfQ0KPiAgfQ0KPiAgDQo+IC1zdGF0aWMgdm9pZCBzdGFydF9uZXR3b3JrX2JlYWNvbih2b2lk
ICphLCB2b2lkICpiKQ0KPiArc3RhdGljIHZvaWQgcmVmcmVzaF9iZWFjb24odm9pZCAqYSwgdm9p
ZCAqYikNCj4gIHsNCj4gIAlzdHJ1Y3QgbWVzaF9zdWJuZXQgKnN1Ym5ldCA9IGE7DQo+ICAJc3Ry
dWN0IG1lc2hfbmV0ICpuZXQgPSBiOw0KPiAgDQo+IC0JaWYgKCFuZXQtPmJlYWNvbl9lbmFibGUp
IHsNCj4gLQkJaWYgKHN1Ym5ldC0+c25iLnRpbWVvdXQpDQo+IC0JCQlsX3RpbWVvdXRfcmVtb3Zl
KHN1Ym5ldC0+c25iLnRpbWVvdXQpOw0KPiAtCQlzdWJuZXQtPnNuYi50aW1lb3V0ID0gTlVMTDsN
Cj4gLQkJcmV0dXJuOw0KPiAtCX0NCj4gLQ0KPiAtCS8qIElmIHRpbWVvdXQgaXMgYWN0aXZlLCBs
ZXQgaXQgcnVuIGl0J3MgY291cnNlICovDQo+IC0JaWYgKHN1Ym5ldC0+c25iLnRpbWVvdXQpDQo+
IC0JCXJldHVybjsNCj4gLQ0KPiAtCXNlbmRfbmV0d29ya19iZWFjb24oc3VibmV0LCBzdWJuZXQt
Pm5ldCk7DQo+IC0NCj4gLQlzdWJuZXQtPnNuYi50cyA9IGdldF90aW1lc3RhbXBfc2VjcygpOw0K
PiAtCXN1Ym5ldC0+c25iLmV4cGVjdGVkID0gMjsNCj4gLQlzdWJuZXQtPnNuYi5vYnNlcnZlZCA9
IDA7DQo+IC0Jc3VibmV0LT5zbmIuaGFsZl9wZXJpb2QgPSAxOw0KPiAtCXN1Ym5ldC0+c25iLm9i
c2VydmVfcGVyaW9kID0gQkVBQ09OX0lOVEVSVkFMX01JTiAqIDI7DQo+IC0NCj4gLQlzdWJuZXQt
PnNuYi50aW1lb3V0ID0gbF90aW1lb3V0X2NyZWF0ZShCRUFDT05fSU5URVJWQUxfTUlOLA0KPiAt
CQkJCW5ldHdvcmtfYmVhY29uX3RpbWVvdXQsIHN1Ym5ldCwgTlVMTCk7DQo+ICsJbmV0X2tleV9i
ZWFjb25fcmVmcmVzaChzdWJuZXQtPm5ldF9rZXlfdHgsIG5ldC0+aXZfaW5kZXgsDQo+ICsJCSEh
KHN1Ym5ldC0+a3JfcGhhc2UgPT0gS0VZX1JFRlJFU0hfUEhBU0VfVFdPKSwgbmV0LT5pdl91cGRh
dGUpOw0KPiAgfQ0KPiAgDQo+ICBzdHJ1Y3QgbWVzaF9uZXQgKm1lc2hfbmV0X25ldyhzdHJ1Y3Qg
bWVzaF9ub2RlICpub2RlKQ0KPiBAQCAtMTAwNSwxMCArOTY2LDExIEBAIHN0YXRpYyBzdHJ1Y3Qg
bWVzaF9zdWJuZXQgKmFkZF9rZXkoc3RydWN0IG1lc2hfbmV0ICpuZXQsIHVpbnQxNl90IGlkeCwN
Cj4gIAkJcmV0dXJuIE5VTEw7DQo+ICAJfQ0KPiAgDQo+IC0JaWYgKCFjcmVhdGVfc2VjdXJlX2Jl
YWNvbihuZXQsIHN1Ym5ldCwgc3VibmV0LT5zbmIuYmVhY29uICsgMSkpIHsNCj4gLQkJc3VibmV0
X2ZyZWUoc3VibmV0KTsNCj4gLQkJcmV0dXJuIE5VTEw7DQo+IC0JfQ0KPiArCW5ldF9rZXlfYmVh
Y29uX3JlZnJlc2goc3VibmV0LT5uZXRfa2V5X3R4LCBuZXQtPml2X2luZGV4LA0KPiArCQkJCQkJ
ZmFsc2UsIG5ldC0+aXZfdXBkYXRlKTsNCj4gKw0KPiArCWlmIChuZXQtPmJlYWNvbl9lbmFibGUp
DQo+ICsJCW5ldF9rZXlfYmVhY29uX2VuYWJsZShzdWJuZXQtPm5ldF9rZXlfdHgpOw0KPiAgDQo+
ICAJbF9xdWV1ZV9wdXNoX3RhaWwobmV0LT5zdWJuZXRzLCBzdWJuZXQpOw0KPiAgDQo+IEBAIC0x
MDQzLDkgKzEwMDUsNiBAQCBpbnQgbWVzaF9uZXRfYWRkX2tleShzdHJ1Y3QgbWVzaF9uZXQgKm5l
dCwgdWludDE2X3QgaWR4LCBjb25zdCB1aW50OF90ICp2YWx1ZSkNCj4gIAkJcmV0dXJuIE1FU0hf
U1RBVFVTX1NUT1JBR0VfRkFJTDsNCj4gIAl9DQo+ICANCj4gLQlpZiAobmV0LT5pbykNCj4gLQkJ
c3RhcnRfbmV0d29ya19iZWFjb24oc3VibmV0LCBuZXQpOw0KPiAtDQo+ICAJcmV0dXJuIE1FU0hf
U1RBVFVTX1NVQ0NFU1M7DQo+ICB9DQo+ICANCj4gQEAgLTEwNzIsMTEgKzEwMzEsMTEgQEAgdm9p
ZCBtZXNoX25ldF9nZXRfc25iX3N0YXRlKHN0cnVjdCBtZXNoX25ldCAqbmV0LCB1aW50OF90ICpm
bGFncywNCj4gIAkJcmV0dXJuOw0KPiAgDQo+ICAJKml2X2luZGV4ID0gbmV0LT5pdl9pbmRleDsN
Cj4gLQkqZmxhZ3MgPSAobmV0LT5pdl91cGRfc3RhdGUgPT0gSVZfVVBEX1VQREFUSU5HKSA/IDB4
MDIgOiAweDAwOw0KPiArCSpmbGFncyA9IG5ldC0+aXZfdXBkYXRlID8gSVZfSU5ERVhfVVBEQVRF
IDogMHgwMDsNCj4gIA0KPiAgCXN1Ym5ldCA9IGdldF9wcmltYXJ5X3N1Ym5ldChuZXQpOw0KPiAg
CWlmIChzdWJuZXQpDQo+IC0JCSpmbGFncyB8PSBzdWJuZXQtPmtleV9yZWZyZXNoID8gMHgwMSA6
IDB4MDA7DQo+ICsJCSpmbGFncyB8PSBzdWJuZXQtPmtleV9yZWZyZXNoID8gS0VZX1JFRlJFU0gg
OiAweDAwOw0KPiAgfQ0KPiAgDQo+ICBib29sIG1lc2hfbmV0X2dldF9rZXkoc3RydWN0IG1lc2hf
bmV0ICpuZXQsIGJvb2wgbmV3X2tleSwgdWludDE2X3QgaWR4LA0KPiBAQCAtMjExNywxNCArMjA3
Niw2IEBAIHN0YXRpYyBib29sIGN0bF9yZWNlaXZlZChzdHJ1Y3QgbWVzaF9uZXQgKm5ldCwgdWlu
dDE2X3Qga2V5X2lkLA0KPiAgCQkJCQkJTF9VSU5UX1RPX1BUUihzcmMpKSk7DQo+ICAJCWJyZWFr
Ow0KPiAgDQo+IC0JY2FzZSBORVRfT1BfRlJORF9VUERBVEU6DQo+IC0JCWlmICh0dGwpDQo+IC0J
CQlyZXR1cm4gZmFsc2U7DQo+IC0NCj4gLQkJcHJpbnRfcGFja2V0KCJSeC1ORVRfT1BfRlJORF9V
UERBVEUiLCBwa3QsIGxlbik7DQo+IC0JCWxwbl9wcm9jZXNzX2JlYWNvbihuZXQsIHBrdCwgbGVu
LCAwKTsNCj4gLQkJYnJlYWs7DQo+IC0NCj4gIAljYXNlIE5FVF9PUF9GUk5EX1JFUVVFU1Q6DQo+
ICAJCWlmICghbmV0LT5mcmllbmRfZW5hYmxlKQ0KPiAgCQkJcmV0dXJuIGZhbHNlOw0KPiBAQCAt
MjUzOSw1MCArMjQ5MCw2IEBAIHN0YXRpYyB2b2lkIG5ldF9tc2dfcmVjdih2b2lkICp1c2VyX2Rh
dGEsIHN0cnVjdCBtZXNoX2lvX3JlY3ZfaW5mbyAqaW5mbywNCj4gIAl9DQo+ICB9DQo+ICANCj4g
LXN0YXRpYyB2b2lkIHNldF9uZXR3b3JrX2JlYWNvbih2b2lkICphLCB2b2lkICpiKQ0KPiAtew0K
PiAtCXN0cnVjdCBtZXNoX3N1Ym5ldCAqc3VibmV0ID0gYTsNCj4gLQlzdHJ1Y3QgbWVzaF9uZXQg
Km5ldCA9IGI7DQo+IC0JdWludDhfdCBiZWFjb25fZGF0YVsyMl07DQo+IC0NCj4gLQlpZiAoIWNy
ZWF0ZV9zZWN1cmVfYmVhY29uKG5ldCwgc3VibmV0LCBiZWFjb25fZGF0YSkpDQo+IC0JCXJldHVy
bjsNCj4gLQ0KPiAtCWlmIChtZW1jbXAoJnN1Ym5ldC0+c25iLmJlYWNvblsxXSwgYmVhY29uX2Rh
dGEsDQo+IC0JCQkJCQlzaXplb2YoYmVhY29uX2RhdGEpKSA9PSAwKQ0KPiAtCQlyZXR1cm47DQo+
IC0NCj4gLQltZW1jcHkoJnN1Ym5ldC0+c25iLmJlYWNvblsxXSwgYmVhY29uX2RhdGEsIHNpemVv
ZihiZWFjb25fZGF0YSkpOw0KPiAtDQo+IC0JaWYgKG5ldC0+YmVhY29uX2VuYWJsZSAmJiAhbmV0
LT5mcmllbmRfYWRkcikgew0KPiAtCQlwcmludF9wYWNrZXQoIlNldCBNeSBCZWFjb24gdG8iLA0K
PiAtCQkJYmVhY29uX2RhdGEsIHNpemVvZihiZWFjb25fZGF0YSkpOw0KPiAtCQlzdGFydF9uZXR3
b3JrX2JlYWNvbihzdWJuZXQsIG5ldCk7DQo+IC0JfQ0KPiAtDQo+IC0JaWYgKGxfcXVldWVfbGVu
Z3RoKG5ldC0+ZnJpZW5kcykpIHsNCj4gLQkJc3RydWN0IG1lc2hfZnJpZW5kX21zZyB1cGRhdGUg
PSB7DQo+IC0JCQkuc3JjID0gbmV0LT5zcmNfYWRkciwNCj4gLQkJCS5pdl9pbmRleCA9IG1lc2hf
bmV0X2dldF9pdl9pbmRleChuZXQpLA0KPiAtCQkJLmxhc3RfbGVuID0gNywNCj4gLQkJCS5jdGwg
PSB0cnVlLA0KPiAtCQl9Ow0KPiAtDQo+IC0JCXVwZGF0ZS51Lm9uZVswXS5oZHIgPSBORVRfT1Bf
RlJORF9VUERBVEUgPDwgT1BDT0RFX0hEUl9TSElGVDsNCj4gLQkJdXBkYXRlLnUub25lWzBdLnNl
cSA9IG1lc2hfbmV0X25leHRfc2VxX251bShuZXQpOw0KPiAtCQl1cGRhdGUudS5vbmVbMF0uZGF0
YVswXSA9IE5FVF9PUF9GUk5EX1VQREFURTsNCj4gLQkJdXBkYXRlLnUub25lWzBdLmRhdGFbMV0g
PSBiZWFjb25fZGF0YVszXTsNCj4gLQkJbF9wdXRfYmUzMihuZXQtPml2X2luZGV4LCB1cGRhdGUu
dS5vbmVbMF0uZGF0YSArIDIpOw0KPiAtCQl1cGRhdGUudS5vbmVbMF0uZGF0YVs2XSA9IDB4MDE7
IC8qIE1vcmUgRGF0YSAqLw0KPiAtCQkvKiBwcmludF9wYWNrZXQoIkZybmQtQmVhY29uLVNSQyIs
DQo+IC0JCSAqCQkJYmVhY29uX2RhdGEsIHNpemVvZihiZWFjb25fZGF0YSkpOw0KPiAtCQkgKi8N
Cj4gLQkJLyogcHJpbnRfcGFja2V0KCJGcm5kLVVwZGF0ZSIsIHVwZGF0ZS51Lm9uZVswXS5kYXRh
LCA2KTsgKi8NCj4gLQ0KPiAtCQlsX3F1ZXVlX2ZvcmVhY2gobmV0LT5mcmllbmRzLCBlbnF1ZXVl
X3VwZGF0ZSwgJnVwZGF0ZSk7DQo+IC0JfQ0KPiAtfQ0KPiAtDQo+ICBzdGF0aWMgdm9pZCBpdl91
cGRfdG8oc3RydWN0IGxfdGltZW91dCAqdXBkX3RpbWVvdXQsIHZvaWQgKnVzZXJfZGF0YSkNCj4g
IHsNCj4gIAlzdHJ1Y3QgbWVzaF9uZXQgKm5ldCA9IHVzZXJfZGF0YTsNCj4gQEAgLTI2MDQsNyAr
MjUxMSw4IEBAIHN0YXRpYyB2b2lkIGl2X3VwZF90byhzdHJ1Y3QgbF90aW1lb3V0ICp1cGRfdGlt
ZW91dCwgdm9pZCAqdXNlcl9kYXRhKQ0KPiAgCQluZXQtPml2X3VwZGF0ZSA9IGZhbHNlOw0KPiAg
CQltZXNoX2NvbmZpZ193cml0ZV9pdl9pbmRleChub2RlX2NvbmZpZ19nZXQobmV0LT5ub2RlKSwN
Cj4gIAkJCQkJCQluZXQtPml2X2luZGV4LCBmYWxzZSk7DQo+IC0JCWxfcXVldWVfZm9yZWFjaChu
ZXQtPnN1Ym5ldHMsIHNldF9uZXR3b3JrX2JlYWNvbiwgbmV0KTsNCj4gKwkJbF9xdWV1ZV9mb3Jl
YWNoKG5ldC0+c3VibmV0cywgcmVmcmVzaF9iZWFjb24sIG5ldCk7DQo+ICsJCXF1ZXVlX2ZyaWVu
ZF91cGRhdGUobmV0KTsNCj4gIAkJbWVzaF9uZXRfZmx1c2hfbXNnX3F1ZXVlcyhuZXQpOw0KPiAg
CQlicmVhazsNCj4gIA0KPiBAQCAtMjY0Niw3ICsyNTU0LDggQEAgc3RhdGljIGludCBrZXlfcmVm
cmVzaF9waGFzZV90d28oc3RydWN0IG1lc2hfbmV0ICpuZXQsIHVpbnQxNl90IGlkeCkNCj4gIAkg
KiBpdCBoZWFycyBiZWFjb25zIGZyb20gYWxsIHRoZSBub2Rlcw0KPiAgCSAqLw0KPiAgCXN1Ym5l
dC0+a3JfcGhhc2UgPSBLRVlfUkVGUkVTSF9QSEFTRV9UV087DQo+IC0Jc2V0X25ldHdvcmtfYmVh
Y29uKHN1Ym5ldCwgbmV0KTsNCj4gKwlyZWZyZXNoX2JlYWNvbihzdWJuZXQsIG5ldCk7DQo+ICsJ
cXVldWVfZnJpZW5kX3VwZGF0ZShuZXQpOw0KPiAgDQo+ICAJbF9xdWV1ZV9mb3JlYWNoKG5ldC0+
ZnJpZW5kcywgZnJuZF9rcl9waGFzZTIsIG5ldCk7DQo+ICANCj4gQEAgLTI2NzksNyArMjU4OCw4
IEBAIHN0YXRpYyBpbnQga2V5X3JlZnJlc2hfZmluaXNoKHN0cnVjdCBtZXNoX25ldCAqbmV0LCB1
aW50MTZfdCBpZHgpDQo+ICAJc3VibmV0LT5uZXRfa2V5X3VwZCA9IDA7DQo+ICAJc3VibmV0LT5r
ZXlfcmVmcmVzaCA9IDA7DQo+ICAJc3VibmV0LT5rcl9waGFzZSA9IEtFWV9SRUZSRVNIX1BIQVNF
X05PTkU7DQo+IC0Jc2V0X25ldHdvcmtfYmVhY29uKHN1Ym5ldCwgbmV0KTsNCj4gKwlyZWZyZXNo
X2JlYWNvbihzdWJuZXQsIG5ldCk7DQo+ICsJcXVldWVfZnJpZW5kX3VwZGF0ZShuZXQpOw0KPiAg
DQo+ICAJbF9xdWV1ZV9mb3JlYWNoKG5ldC0+ZnJpZW5kcywgZnJuZF9rcl9waGFzZTMsIG5ldCk7
DQo+ICANCj4gQEAgLTI3NzEsMTA2ICsyNjgxLDczIEBAIHN0YXRpYyB2b2lkIHVwZGF0ZV9pdl9p
dnVfc3RhdGUoc3RydWN0IG1lc2hfbmV0ICpuZXQsIHVpbnQzMl90IGl2X2luZGV4LA0KPiAgc3Rh
dGljIHZvaWQgcHJvY2Vzc19iZWFjb24odm9pZCAqbmV0X3B0ciwgdm9pZCAqdXNlcl9kYXRhKQ0K
PiAgew0KPiAgCXN0cnVjdCBtZXNoX25ldCAqbmV0ID0gbmV0X3B0cjsNCj4gLQljb25zdCB1aW50
OF90ICpidWYgPSAqKHVpbnQ4X3QgKiopdXNlcl9kYXRhOw0KPiArCXN0cnVjdCBuZXRfYmVhY29u
X2RhdGEgKmJlYWNvbl9kYXRhID0gdXNlcl9kYXRhOw0KPiAgCXVpbnQzMl90IGl2aTsNCj4gIAli
b29sIGl2dSwga3IsIGxvY2FsX2tyOw0KPiAgCXN0cnVjdCBtZXNoX3N1Ym5ldCAqc3VibmV0Ow0K
PiAtCXVpbnQzMl90IGtleV9pZDsNCj4gIA0KPiAtCWl2aSA9IGxfZ2V0X2JlMzIoYnVmICsgMTAp
Ow0KPiArCWl2aSA9IGJlYWNvbl9kYXRhLT5pdmk7DQo+ICANCj4gIAkvKiBJZ25vcmUgb3V0LW9m
LXJhbmdlIElWX0luZGV4IGZvciB0aGlzIG5ldHdvcmsgKi8NCj4gIAlpZiAoKG5ldC0+aXZfaW5k
ZXggKyBJVl9JRFhfRElGRl9SQU5HRSA8IGl2aSkgfHwgKGl2aSA8IG5ldC0+aXZfaW5kZXgpKQ0K
PiAgCQlyZXR1cm47DQo+ICANCj4gLQkvKiBJZ25vcmUgTmV0d29yayBJRHMgdW5rbm93biB0byB0
aGlzIG1lc2ggdW5pdmVyc2UgKi8NCj4gLQlrZXlfaWQgPSBuZXRfa2V5X25ldHdvcmtfaWQoYnVm
ICsgMik7DQo+IC0JaWYgKCFrZXlfaWQpDQo+IC0JCXJldHVybjsNCj4gLQ0KPiArCS8qIElnbm9y
ZSBiZWFjb25zIG5vdCBpbiB0aGlzIHVuaXZlcnNlICovDQo+ICAJc3VibmV0ID0gbF9xdWV1ZV9m
aW5kKG5ldC0+c3VibmV0cywgbWF0Y2hfa2V5X2lkLA0KPiAtCQkJCQkJCUxfVUlOVF9UT19QVFIo
a2V5X2lkKSk7DQo+ICsJCQkJCUxfVUlOVF9UT19QVFIoYmVhY29uX2RhdGEtPmtleV9pZCkpOw0K
PiArDQo+ICAJaWYgKCFzdWJuZXQpDQo+ICAJCXJldHVybjsNCj4gIA0KPiAgCS8qIEdldCBJVlUg
YW5kIEtSIGJvb2xlYW4gYml0cyBmcm9tIGJlYWNvbiAqLw0KPiAtCWl2dSA9ICEhKGJ1ZlsxXSAm
IDB4MDIpOw0KPiAtCWtyID0gISEoYnVmWzFdICYgMHgwMSk7DQo+IC0JbG9jYWxfa3IgPSAhIShz
dWJuZXQtPmtyX3BoYXNlICE9IEtFWV9SRUZSRVNIX1BIQVNFX1RXTyk7DQo+IC0NCj4gLQlpZiAo
bmV0LT5pdl91cGRfc3RhdGUgIT0gSVZfVVBEX0lOSVQpIHsNCj4gLQkJLyogSWdub3JlIGJlYWNv
bnMgdGhhdCBpbmRpY2F0ZSAqbm8gY2hhbmdlKiAqLw0KPiAtCQlpZiAoIW1lbWNtcCgmc3VibmV0
LT5zbmIuYmVhY29uWzFdLCBidWYsIDIyKSkgew0KPiAtCQkJc3VibmV0LT5zbmIub2JzZXJ2ZWQr
KzsNCj4gLQkJCXJldHVybjsNCj4gLQkJfQ0KPiAtCX0NCj4gLQ0KPiAtCS8qIFZhbGlkYXRlIGJl
YWNvbiBiZWZvcmUgYWNjZXB0aW5nICovDQo+IC0JaWYgKCFuZXRfa2V5X3NuYl9jaGVjayhrZXlf
aWQsIGl2aSwga3IsIGl2dSwgbF9nZXRfYmU2NChidWYgKyAxNCkpKSB7DQo+IC0JCWxfZXJyb3Io
Im1lc2hfY3J5cHRvX2JlYWNvbiB2ZXJpZnkgZmFpbGVkIik7DQo+IC0JCXJldHVybjsNCj4gLQl9
DQo+ICsJaXZ1ID0gYmVhY29uX2RhdGEtPml2dTsNCj4gKwlrciA9IGJlYWNvbl9kYXRhLT5rcjsN
Cj4gKwlsb2NhbF9rciA9ICEhKHN1Ym5ldC0+a3JfcGhhc2UgPT0gS0VZX1JFRlJFU0hfUEhBU0Vf
VFdPKTsNCj4gIA0KPiAgCS8qIFdlIGhhdmUgb2ZmaWNpYWxseSAqc2VlbiogdGhpcyBiZWFjb24g
bm93ICovDQo+IC0Jc3VibmV0LT5zbmIub2JzZXJ2ZWQrKzsNCj4gLQ0KPiAtCXVwZGF0ZV9pdl9p
dnVfc3RhdGUobmV0LCBpdmksIGl2dSk7DQo+IC0JdXBkYXRlX2tyX3N0YXRlKHN1Ym5ldCwga3Is
IGtleV9pZCk7DQo+IC0NCj4gLQlpZiAoaXZpICE9IG5ldC0+aXZfaW5kZXggfHwgaXZ1ICE9IG5l
dC0+aXZfdXBkYXRlIHx8IGtyICE9IGxvY2FsX2tyKQ0KPiAtCQlzZXRfbmV0d29ya19iZWFjb24o
c3VibmV0LCBuZXQpOw0KPiAtfQ0KPiAtDQo+IC1zdGF0aWMgdm9pZCBscG5fcHJvY2Vzc19iZWFj
b24odm9pZCAqdXNlcl9kYXRhLCBjb25zdCB2b2lkICpkYXRhLA0KPiAtCQkJCQkJdWludDhfdCBz
aXplLCBpbnQ4X3QgcnNzaSkNCj4gLXsNCj4gLQlzdHJ1Y3QgbWVzaF9uZXQgKm5ldCA9IHVzZXJf
ZGF0YTsNCj4gLQljb25zdCB1aW50OF90ICpidWYgPSBkYXRhOw0KPiAtCXVpbnQzMl90IGl2aTsN
Cj4gLQlib29sIGl2dSwga3IsIGxvY2FsX2tyOw0KPiAtCXN0cnVjdCBtZXNoX3N1Ym5ldCAqc3Vi
bmV0Ow0KPiAtCWJvb2wga3JfdHJhbnNpdGlvbiA9IGZhbHNlOw0KPiAtDQo+IC0JLyogcHJpbnRf
cGFja2V0KCJscG46IFNlY3VyZSBOZXQgQmVhY29uIFJYZWQiLCBkYXRhLCBzaXplKTsgKi8NCj4g
LQlrciA9ICEhKGJ1ZlswXSAmIDB4MDEpOw0KPiAtCWl2dSA9ICEhKGJ1ZlswXSAmIDB4MDIpOw0K
PiAtCWl2aSA9IGxfZ2V0X2JlMzIoYnVmICsgMSk7DQo+IC0NCj4gLQlsX2RlYnVnKCJLUjogJWQg
LS0gSVZVOiAlZCAtLSBJVkk6ICU4Ljh4Iiwga3IsIGl2dSwgaXZpKTsNCj4gLQ0KPiAtCS8qIFRP
RE86IGZpZ3VyZSBvdXQgYWN0dWFsIG5ldHdvcmsgaW5kZXggKGkuZS4sIGZyaWVuZHNoaXAgc3Vi
bmV0KSAqLw0KPiAtCXN1Ym5ldCA9IGdldF9wcmltYXJ5X3N1Ym5ldChuZXQpOw0KPiAtCWlmICgh
c3VibmV0KQ0KPiAtCQlyZXR1cm47DQo+IC0NCj4gLQlsb2NhbF9rciA9IChzdWJuZXQtPmtyX3Bo
YXNlID09IEtFWV9SRUZSRVNIX1BIQVNFX1RXTyk7DQo+ICsJYmVhY29uX2RhdGEtPnByb2Nlc3Nl
ZCA9IHRydWU7DQo+ICANCj4gLQkvKiBEb24ndCBib3RoZXIgZ29pbmcgZnVydGhlciBpZiBub3Ro
aW5nIGhhcyBjaGFuZ2VkICovDQo+IC0JaWYgKGxvY2FsX2tyID09IGtyICYmIGl2aSA9PSBuZXQt
Pml2X2luZGV4ICYmIGl2dSA9PSBuZXQtPml2X3VwZGF0ZSAmJg0KPiAtCQkJCQluZXQtPml2X3Vw
ZF9zdGF0ZSAhPSBJVl9VUERfSU5JVCkNCj4gKwlpZiAoaXZpID09IG5ldC0+aXZfaW5kZXggJiYg
aXZ1ID09IG5ldC0+aXZfdXBkYXRlICYmIGtyID09IGxvY2FsX2tyKQ0KPiAgCQlyZXR1cm47DQo+
ICANCj4gIAl1cGRhdGVfaXZfaXZ1X3N0YXRlKG5ldCwgaXZpLCBpdnUpOw0KPiAtDQo+IC0JaWYg
KGtyKQ0KPiAtCQl1cGRhdGVfa3Jfc3RhdGUoc3VibmV0LCBrcl90cmFuc2l0aW9uLCBzdWJuZXQt
Pm5ldF9rZXlfdXBkKTsNCj4gLQllbHNlDQo+IC0JCXVwZGF0ZV9rcl9zdGF0ZShzdWJuZXQsIGty
X3RyYW5zaXRpb24sIHN1Ym5ldC0+bmV0X2tleV9jdXIpOw0KPiArCXVwZGF0ZV9rcl9zdGF0ZShz
dWJuZXQsIGtyLCBiZWFjb25fZGF0YS0+a2V5X2lkKTsNCj4gKwluZXRfa2V5X2JlYWNvbl9yZWZy
ZXNoKGJlYWNvbl9kYXRhLT5rZXlfaWQsIG5ldC0+aXZfaW5kZXgsDQo+ICsJCSEhKHN1Ym5ldC0+
a3JfcGhhc2UgPT0gS0VZX1JFRlJFU0hfUEhBU0VfVFdPKSwgbmV0LT5pdl91cGRhdGUpOw0KPiAg
fQ0KPiAgDQo+ICBzdGF0aWMgdm9pZCBiZWFjb25fcmVjdih2b2lkICp1c2VyX2RhdGEsIHN0cnVj
dCBtZXNoX2lvX3JlY3ZfaW5mbyAqaW5mbywNCj4gIAkJCQkJY29uc3QgdWludDhfdCAqZGF0YSwg
dWludDE2X3QgbGVuKQ0KPiAgew0KPiAtCWNvbnN0IHVpbnQ4X3QgKnB0ciA9IGRhdGEgKyAxOw0K
PiArCXN0cnVjdCBuZXRfYmVhY29uX2RhdGEgYmVhY29uX2RhdGEgPSB7DQo+ICsJCS5wcm9jZXNz
ZWQgPSBmYWxzZSwNCj4gKwl9Ow0KPiAgDQo+ICAJaWYgKGxlbiAhPSAyMyB8fCBkYXRhWzFdICE9
IDB4MDEpDQo+ICAJCXJldHVybjsNCj4gIA0KPiAtCWxfZGVidWcoIktSOiAlZCAtLSBJVlU6ICVk
IC0tIElWOiAlOC44eCIsDQo+IC0JCQlkYXRhWzJdICYgMSwgISEoZGF0YVsyXSAmIDIpLCBsX2dl
dF9iZTMyKGRhdGEgKyAxMSkpOw0KPiArCS8qIElnbm9yZSBOZXR3b3JrIElEcyB1bmtub3duIHRv
IHRoaXMgZGFlbW9uICovDQo+ICsJYmVhY29uX2RhdGEua2V5X2lkID0gbmV0X2tleV9uZXR3b3Jr
X2lkKGRhdGEgKyAzKTsNCj4gKwlpZiAoIWJlYWNvbl9kYXRhLmtleV9pZCkNCj4gKwkJcmV0dXJu
Ow0KPiArDQo+ICsJLyogR2V0IGRhdGEgYml0cyBmcm9tIGJlYWNvbiAqLw0KPiArCWJlYWNvbl9k
YXRhLml2dSA9ICEhKGRhdGFbMl0gJiAweDAyKTsNCj4gKwliZWFjb25fZGF0YS5rciA9ICEhKGRh
dGFbMl0gJiAweDAxKTsNCj4gKwliZWFjb25fZGF0YS5pdmkgPSBsX2dldF9iZTMyKGRhdGEgKyAx
MSk7DQo+ICANCj4gLQlsX3F1ZXVlX2ZvcmVhY2gobmV0cywgcHJvY2Vzc19iZWFjb24sICZwdHIp
Ow0KPiArCS8qIFZhbGlkYXRlIGJlYWNvbiBiZWZvcmUgYWNjZXB0aW5nICovDQo+ICsJaWYgKCFu
ZXRfa2V5X3NuYl9jaGVjayhiZWFjb25fZGF0YS5rZXlfaWQsIGJlYWNvbl9kYXRhLml2aSwNCj4g
KwkJCQkJYmVhY29uX2RhdGEua3IsIGJlYWNvbl9kYXRhLml2dSwNCj4gKwkJCQkJbF9nZXRfYmU2
NChkYXRhICsgMTUpKSkgew0KPiArCQlsX2Vycm9yKCJtZXNoX2NyeXB0b19iZWFjb24gdmVyaWZ5
IGZhaWxlZCIpOw0KPiArCQlyZXR1cm47DQo+ICsJfQ0KPiArDQo+ICsJbF9xdWV1ZV9mb3JlYWNo
KG5ldHMsIHByb2Nlc3NfYmVhY29uLCAmYmVhY29uX2RhdGEpOw0KPiArDQo+ICsJaWYgKGJlYWNv
bl9kYXRhLnByb2Nlc3NlZCkNCj4gKwkJbmV0X2tleV9iZWFjb25fc2VlbihiZWFjb25fZGF0YS5r
ZXlfaWQpOw0KPiAgfQ0KPiAgDQo+ICBib29sIG1lc2hfbmV0X3NldF9iZWFjb25fbW9kZShzdHJ1
Y3QgbWVzaF9uZXQgKm5ldCwgYm9vbCBlbmFibGUpDQo+IEBAIC0yODc4LDE2ICsyNzU1LDE2IEBA
IGJvb2wgbWVzaF9uZXRfc2V0X2JlYWNvbl9tb2RlKHN0cnVjdCBtZXNoX25ldCAqbmV0LCBib29s
IGVuYWJsZSkNCj4gIAlpZiAoIW5ldCB8fCAhSVNfVU5BU1NJR05FRChuZXQtPmZyaWVuZF9hZGRy
KSkNCj4gIAkJcmV0dXJuIGZhbHNlOw0KPiAgDQo+IC0JaWYgKG5ldC0+YmVhY29uX2VuYWJsZSAh
PSBlbmFibGUpIHsNCj4gLQkJdWludDhfdCB0eXBlID0gTUVTSF9BRF9UWVBFX0JFQUNPTjsNCj4g
KwlpZiAobmV0LT5iZWFjb25fZW5hYmxlID09IGVuYWJsZSkNCj4gKwkJcmV0dXJuIHRydWU7DQo+
ICANCj4gLQkJbmV0LT5iZWFjb25fZW5hYmxlID0gZW5hYmxlOw0KPiArCW5ldC0+YmVhY29uX2Vu
YWJsZSA9IGVuYWJsZTsNCj4gIA0KPiAtCQlpZiAoIWVuYWJsZSkNCj4gLQkJCW1lc2hfaW9fc2Vu
ZF9jYW5jZWwobmV0LT5pbywgJnR5cGUsIDEpOw0KPiArCWlmIChlbmFibGUpDQo+ICsJCWxfcXVl
dWVfZm9yZWFjaChuZXQtPnN1Ym5ldHMsIHJlZnJlc2hfYmVhY29uLCBuZXQpOw0KPiAgDQo+IC0J
CWxfcXVldWVfZm9yZWFjaChuZXQtPnN1Ym5ldHMsIHN0YXJ0X25ldHdvcmtfYmVhY29uLCBuZXQp
Ow0KPiAtCX0NCj4gKwlsX3F1ZXVlX2ZvcmVhY2gobmV0LT5zdWJuZXRzLCBlbmFibGVfYmVhY29u
LCBuZXQpOw0KPiArCXF1ZXVlX2ZyaWVuZF91cGRhdGUobmV0KTsNCj4gIA0KPiAgCXJldHVybiB0
cnVlOw0KPiAgfQ0KPiBAQCAtMjkyMywxNCArMjgwMCwxOCBAQCBib29sIG1lc2hfbmV0X3NldF9r
ZXkoc3RydWN0IG1lc2hfbmV0ICpuZXQsIHVpbnQxNl90IGlkeCwgY29uc3QgdWludDhfdCAqa2V5
LA0KPiAgCWlmIChwaGFzZSA9PSBLRVlfUkVGUkVTSF9QSEFTRV9UV08pIHsNCj4gIAkJc3VibmV0
LT5rZXlfcmVmcmVzaCA9IDE7DQo+ICAJCXN1Ym5ldC0+bmV0X2tleV90eCA9IHN1Ym5ldC0+bmV0
X2tleV91cGQ7DQo+ICsJCWlmIChuZXQtPmJlYWNvbl9lbmFibGUpIHsNCj4gKwkJCS8qIFN3aXRj
aCBiZWFjb25pbmcga2V5ICovDQo+ICsJCQluZXRfa2V5X2JlYWNvbl9kaXNhYmxlKHN1Ym5ldC0+
bmV0X2tleV9jdXIpOw0KPiArCQkJbmV0X2tleV9iZWFjb25fZW5hYmxlKHN1Ym5ldC0+bmV0X2tl
eV91cGQpOw0KPiArCQl9DQo+ICAJfQ0KPiAgDQo+ICAJc3VibmV0LT5rcl9waGFzZSA9IHBoYXNl
Ow0KPiAgDQo+IC0Jc2V0X25ldHdvcmtfYmVhY29uKHN1Ym5ldCwgbmV0KTsNCj4gKwluZXRfa2V5
X2JlYWNvbl9yZWZyZXNoKHN1Ym5ldC0+bmV0X2tleV90eCwgbmV0LT5pdl9pbmRleCwNCj4gKwkJ
ISEoc3VibmV0LT5rcl9waGFzZSA9PSBLRVlfUkVGUkVTSF9QSEFTRV9UV08pLCBuZXQtPml2X3Vw
ZGF0ZSk7DQo+ICANCj4gLQlpZiAobmV0LT5pbykNCj4gLQkJc3RhcnRfbmV0d29ya19iZWFjb24o
c3VibmV0LCBuZXQpOw0KPiAgDQo+ICAJcmV0dXJuIHRydWU7DQo+ICB9DQo+IEBAIC0yOTYwLDcg
KzI4NDEsNiBAQCBib29sIG1lc2hfbmV0X2F0dGFjaChzdHJ1Y3QgbWVzaF9uZXQgKm5ldCwgc3Ry
dWN0IG1lc2hfaW8gKmlvKQ0KPiAgCQkJCQkJCWJlYWNvbl9yZWN2LCBOVUxMKTsNCj4gIAkJbWVz
aF9pb19yZWdpc3Rlcl9yZWN2X2NiKGlvLCBNRVNIX0lPX0ZJTFRFUl9ORVQsDQo+ICAJCQkJCQkJ
bmV0X21zZ19yZWN2LCBOVUxMKTsNCj4gLQkJbF9xdWV1ZV9mb3JlYWNoKG5ldC0+c3VibmV0cywg
c3RhcnRfbmV0d29ya19iZWFjb24sIG5ldCk7DQo+ICAJfQ0KPiAgDQo+ICAJaWYgKGxfcXVldWVf
ZmluZChuZXRzLCBpc190aGlzX25ldCwgbmV0KSkNCj4gQEAgLTMwMDcsNyArMjg4Nyw4IEBAIGJv
b2wgbWVzaF9uZXRfaXZfaW5kZXhfdXBkYXRlKHN0cnVjdCBtZXNoX25ldCAqbmV0KQ0KPiAgCW5l
dC0+aXZfdXBkX3N0YXRlID0gSVZfVVBEX1VQREFUSU5HOw0KPiAgCW5ldC0+aXZfaW5kZXgrKzsN
Cj4gIAluZXQtPml2X3VwZGF0ZSA9IHRydWU7DQo+IC0JbF9xdWV1ZV9mb3JlYWNoKG5ldC0+c3Vi
bmV0cywgc2V0X25ldHdvcmtfYmVhY29uLCBuZXQpOw0KPiArCWxfcXVldWVfZm9yZWFjaChuZXQt
PnN1Ym5ldHMsIHJlZnJlc2hfYmVhY29uLCBuZXQpOw0KPiArCXF1ZXVlX2ZyaWVuZF91cGRhdGUo
bmV0KTsNCj4gIAluZXQtPml2X3VwZGF0ZV90aW1lb3V0ID0gbF90aW1lb3V0X2NyZWF0ZSgNCj4g
IAkJCUlWX0lEWF9VUERfTUlOLA0KPiAgCQkJaXZfdXBkX3RvLCBuZXQsIE5VTEwpOw0KPiBAQCAt
MzA1OSw3ICsyOTQwLDYgQEAgYm9vbCBtZXNoX25ldF9zZXRfZnJpZW5kKHN0cnVjdCBtZXNoX25l
dCAqbmV0LCB1aW50MTZfdCBmcmllbmRfYWRkcikNCj4gIA0KPiAgCW5ldC0+ZnJpZW5kX2FkZHIg
PSBmcmllbmRfYWRkcjsNCj4gIA0KPiAtCXNldF9uZXR3b3JrX2JlYWNvbihnZXRfcHJpbWFyeV9z
dWJuZXQobmV0KSwgbmV0KTsNCj4gIAlyZXR1cm4gdHJ1ZTsNCj4gIH0NCj4gIA0KPiBkaWZmIC0t
Z2l0IGEvbWVzaC9uZXQuaCBiL21lc2gvbmV0LmgNCj4gaW5kZXggZmU0ZTBiNjUzLi45MGNhODMy
OGIgMTAwNjQ0DQo+IC0tLSBhL21lc2gvbmV0LmgNCj4gKysrIGIvbWVzaC9uZXQuaA0KPiBAQCAt
MTE3LDYgKzExNyw5IEBAIHN0cnVjdCBtZXNoX25vZGU7DQo+ICAjZGVmaW5lIEZSTkRfT1BDT0RF
KHgpIFwNCj4gIAkJKCh4KSA+PSBORVRfT1BfRlJORF9QT0xMICYmICh4KSA8PSBORVRfT1BfRlJO
RF9DTEVBUl9DT05GSVJNKQ0KPiAgDQo+ICsjZGVmaW5lIERFRkFVTFRfTUlOX0RFTEFZCQkwDQo+
ICsjZGVmaW5lIERFRkFVTFRfTUFYX0RFTEFZCQkyNQ0KPiArDQo+ICBzdHJ1Y3QgbWVzaF9uZXRf
YWRkcl9yYW5nZSB7DQo+ICAJdWludDE2X3QgbG93Ow0KPiAgCXVpbnQxNl90IGhpZ2g7DQo=
