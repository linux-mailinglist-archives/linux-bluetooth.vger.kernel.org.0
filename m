Return-Path: <linux-bluetooth-owner@vger.kernel.org>
X-Original-To: lists+linux-bluetooth@lfdr.de
Delivered-To: lists+linux-bluetooth@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 2935B19ED67
	for <lists+linux-bluetooth@lfdr.de>; Sun,  5 Apr 2020 20:45:46 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1727522AbgDESpp (ORCPT <rfc822;lists+linux-bluetooth@lfdr.de>);
        Sun, 5 Apr 2020 14:45:45 -0400
Received: from mga14.intel.com ([192.55.52.115]:64024 "EHLO mga14.intel.com"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1726771AbgDESpp (ORCPT <rfc822;linux-bluetooth@vger.kernel.org>);
        Sun, 5 Apr 2020 14:45:45 -0400
IronPort-SDR: a1zFeJxQkxB562sKPZaetsVyvoikN1S8tmcYp+TsNNs1v1QdYaDrRFw8hFjoDO7PlFv9UlQDBL
 Y+KHV5sBJIwQ==
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga006.fm.intel.com ([10.253.24.20])
  by fmsmga103.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384; 05 Apr 2020 11:45:43 -0700
IronPort-SDR: u1+vKovjg4HpiYjFf156cj8W/qGw8wCabZrG+7yJUIMjA+IqI2MZpKM2D72VP3xgJuZPrR+vrB
 KZiFM9EfRGQA==
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.72,348,1580803200"; 
   d="scan'208";a="451855907"
Received: from orsmsx108.amr.corp.intel.com ([10.22.240.6])
  by fmsmga006.fm.intel.com with ESMTP; 05 Apr 2020 11:45:43 -0700
Received: from orsmsx155.amr.corp.intel.com (10.22.240.21) by
 ORSMSX108.amr.corp.intel.com (10.22.240.6) with Microsoft SMTP Server (TLS)
 id 14.3.439.0; Sun, 5 Apr 2020 11:45:42 -0700
Received: from ORSEDG002.ED.cps.intel.com (10.7.248.5) by
 ORSMSX155.amr.corp.intel.com (10.22.240.21) with Microsoft SMTP Server (TLS)
 id 14.3.439.0; Sun, 5 Apr 2020 11:45:41 -0700
Received: from NAM11-DM6-obe.outbound.protection.outlook.com (104.47.57.172)
 by edgegateway.intel.com (134.134.137.101) with Microsoft SMTP Server (TLS)
 id 14.3.439.0; Sun, 5 Apr 2020 11:45:41 -0700
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=FIMJb62KwMwOofFr71BWXn8RnUddH1LUE7L8k1abrYwJNfO1uedR1ekO8gj80fJh4wQ3L77M7FheV7rGsqVh/JWYjInD6g9iQE8zRw4bWnuzzg9NAJpERT/8JKhQLR4ThkIGBBqHSGnwH1KYXEJ2ZI6aY5KjAh1HSrMlI91mLT7x3TB1wkl02pLCfYtwX38PmZdW+RCTA3oINQLbQMn4eSVmA8n49ABqep1S3a1FOKzASSmyG6HDVb17Zm3avtkvY7LvATSIHgQCoq5B3kigcgPFf80tsI+WzVpgYKkUFO6V6CQlI6U4PN9rsT0RTHJcJLHqhhW37Q6IwsBMedwxzA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=LB5wPqcpe3z3+DAJF4x0/X8PnrpDP6UYtcuRaGavxr0=;
 b=F+rW8sKXcu17loaGX8IgB/T5b2V28jhg7Rzr7YAWeyvMFZRiTtR7k7Q0156JdcxucJLMZJeNHb5OnIWY5gLkoILZAegXfpejN4iIZ3sihZkoVmSl1t9BJc1HKa9sHCpybGOTtCVY7BkGzFTPeIr8Bt8k8fLXb7TIkKugoz5b3U+wFvtqrMgvzH5X9oYOCDKeuPXsz90IiDQTl527YJJrxvRa4YLE7bkdCPJbbvAfHtz9qWkF+35w9K0qOMb9FwVzjo/ggeoyC26O+NQqBjeMjsHoEUV34RapSOwi5OzGZjrJtOMZkCIhmf5FIu7/QjdWDczwJttWqZWLAWmhNzNbWQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=intel.com; dmarc=pass action=none header.from=intel.com;
 dkim=pass header.d=intel.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=intel.onmicrosoft.com;
 s=selector2-intel-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=LB5wPqcpe3z3+DAJF4x0/X8PnrpDP6UYtcuRaGavxr0=;
 b=BzQ7t5EUm7klDfz0CLAEWoTz/uiId4l3v/VfjhnX3TxrzHqrK5pDQGNWQp0IwCmJ0c6w+mLH5XulKgcgbgy7J2xeNdJRdKl4rK2SmG/A1TyZwHdFDXvgaP5WoA3yjGyHWp5nn9g7BPCnmTMXtvBkFRJQU+gqymSZrwmdX6mjl6A=
Received: from MW3PR11MB4539.namprd11.prod.outlook.com (2603:10b6:303:2f::13)
 by MW3PR11MB4553.namprd11.prod.outlook.com (2603:10b6:303:2c::9) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2878.17; Sun, 5 Apr
 2020 18:45:39 +0000
Received: from MW3PR11MB4539.namprd11.prod.outlook.com
 ([fe80::39a4:4e3:2bb2:dd3a]) by MW3PR11MB4539.namprd11.prod.outlook.com
 ([fe80::39a4:4e3:2bb2:dd3a%3]) with mapi id 15.20.2878.018; Sun, 5 Apr 2020
 18:45:39 +0000
From:   "Gix, Brian" <brian.gix@intel.com>
To:     "michal.lowas-rzechonek@silvair.com" 
        <michal.lowas-rzechonek@silvair.com>,
        "linux-bluetooth@vger.kernel.org" <linux-bluetooth@vger.kernel.org>
Subject: Re: [PATCH BlueZ RESEND] mesh: Remove redundant code from mesh/crypto
Thread-Topic: [PATCH BlueZ RESEND] mesh: Remove redundant code from
 mesh/crypto
Thread-Index: AQHWA7P/1NgK5Fw5002PJCTl12t5+6hq7WKA
Date:   Sun, 5 Apr 2020 18:45:39 +0000
Message-ID: <27728473092a638d6c97520b14eac61656c56903.camel@intel.com>
References: <20200326211705.18678-1-michal.lowas-rzechonek@silvair.com>
In-Reply-To: <20200326211705.18678-1-michal.lowas-rzechonek@silvair.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Evolution 3.32.5 (3.32.5-1.fc30) 
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=brian.gix@intel.com; 
x-originating-ip: [192.55.54.38]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: f8dfcd0f-678c-4e45-1ee5-08d7d9918997
x-ms-traffictypediagnostic: MW3PR11MB4553:
x-microsoft-antispam-prvs: <MW3PR11MB455344100244D144EE1DFA9FE1C50@MW3PR11MB4553.namprd11.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:8273;
x-forefront-prvs: 03648EFF89
x-forefront-antispam-report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:MW3PR11MB4539.namprd11.prod.outlook.com;PTR:;CAT:NONE;SFTY:;SFS:(10019020)(366004)(136003)(346002)(39860400002)(376002)(396003)(66476007)(66446008)(64756008)(2616005)(66556008)(36756003)(110136005)(5660300002)(91956017)(76116006)(66946007)(86362001)(30864003)(71200400001)(8676002)(6512007)(8936002)(81166006)(478600001)(186003)(6506007)(6486002)(2906002)(316002)(26005)(81156014)(579004)(559001);DIR:OUT;SFP:1102;
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: c36P339bUL60lkkWePm6GeHVrcmOzvI8msvxlRUpP/qJlXzbO1R167Dsm0oqMXoKHEoQ/R/GkIMK7nmVshcYSqP2w4Kx9mTUjlBL/3jgEgszWAot+hGlx8ECl0a1yF3z0f5KjC307TH/H3STGVQ3nNrkCkepiLDYBWVBnUCe5MMu9fJCiXo/WVH8LdfxBm4SMcbwm6pQryrGir5GepCB8dl44TKQApKDOmXkHno2tAxzMBG4Fp1w/BDVz3uDd5ejbBxl4I7eHhw6XBqUH+WVlykSi+SQz+HxkXcIxmbGaDB1fovLFzHXZk3cO4o4UWp7MqM1YQVj/Kn6ESECOSIY1JO7iA4efoxMvcn5dMZH0/NOOlNTSaXpCr2i55eG10xSyeW6qMUvi/HwcSpewuoAdwzfAH7lMk/9rdUcN2QNDFLKXj13+Zxnph8VxxMhDpC5
x-ms-exchange-antispam-messagedata: tO60OlD20AfSAGfx68MSyhNZZCZxeamufZmQP2091TnYZuDtQkCfdAEyKBHzjSvIibsJoD/uwwgLWJ+qouOLWWLRAkbgQADXot4BpJ0+mZoUDbPy1eGlUyVxoxxKNg+uiN9XJ5WE5PGLqEDJTJvLQA==
x-ms-exchange-transport-forked: True
Content-Type: text/plain; charset="utf-8"
Content-ID: <D492F924E1CAC84FB295A56EF5D563B8@namprd11.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-Network-Message-Id: f8dfcd0f-678c-4e45-1ee5-08d7d9918997
X-MS-Exchange-CrossTenant-originalarrivaltime: 05 Apr 2020 18:45:39.6080
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 46c98d88-e344-4ed4-8496-4ed7712e255d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: 7EEGE8hgwoA7m1PSlfH0OLpnX1+74i9jKzRA/PkHu/UMJXQtw07xNeKyP2W8R8gYl5K/O41WeFgy7HjcSy/faQ==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MW3PR11MB4553
X-OriginatorOrg: intel.com
Sender: linux-bluetooth-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-bluetooth.vger.kernel.org>
X-Mailing-List: linux-bluetooth@vger.kernel.org

SGkgTWljaGHFgiwNCg0KSSB0aGluayB0aGlzIG5lZWRzIHNvbWUgbW9yZSB3b3JrLCBpbiB0aGF0
IGl0IG5vIGxvbmdlciBjb3JyZWN0bHkgZmFpbHMgdGhlIG1lc2gtdGVzdC1jcnlwdG8gdGVzdCB3
aGVuIHJ1bm5pbmc6DQoNCm1ha2UgZGlzdGNoZWNrDQoNCkl0ICphbG1vc3QqIGRvZXMgaW4gdGhh
dCBpdCBmbGFncyBhbiBlcnJvciBpbiByZWQgaWYgYSAidmVyaWZ5IiBzdGVwIGZhaWxzLCBidXQg
aXQgZG9lcyBub3QgZXhpdCB3aXRoIGEgZmFpbA0KY29kZS4gIFRoaXMgaXMgYW4gaW1wb3J0YW50
IHN0ZXAsIHBhcnRpY3VsYXJpbHkgd2l0aCB0aGUgZGVwZW5kYW5jZSBvbiBrZXJuZWwgYmFzZWQg
Y3J5cHRvIGZ1bmN0aW9ucy4NCg0KTXkgdGVzdCBtZXRob2RvbG9neSB3YXMgdG8gZmxpcCBhIGJp
dCBpbiBvbmUgb2YgdGhlIHRlc3QgcGF5bG9hZHMgIChpLmUuLCBtYWtlIGl0ICJub3QgcGVyZmVj
dGx5IG1hdGNoIiB0aGUNCnNwZWNpZmljYXRpb24gc2FtcGxlIGRhdGEpLg0KDQpBcyBiZXN0IEkg
Y2FuIHRlbGwsIGl0IGlzIG90aGVyd2lzZSBmdW5jdGlvbmFsLCBidXQgdGhlIHVuaXQgdGVzdHMg
YXJlIGltcG9ydGFudC4NCg0KT24gVGh1LCAyMDIwLTAzLTI2IGF0IDIyOjE3ICswMTAwLCBNaWNo
YcWCIExvd2FzLVJ6ZWNob25layB3cm90ZToNCj4gLSBSZW1vdmUgYXBwbGljYXRpb25fZW5jcnlw
dC9hcHBsaWNhdGlvbl9kZWNyeXB0DQo+IC0gTWFrZSBtZXNoX2NyeXB0b19wcml2YWN5X2NvdW50
ZXIgcHJpdmF0ZSwgYWRkIG1lc2hfY3J5cHRvX3BlY2INCj4gLSBNYWtlICpfbm9uY2UgZnVuY3Rp
b25zIHByaXZhdGUgYW5kIGFsaWduIHRoZWlyIGltcGxlbWVudGF0aW9uIHRvIGJlDQo+ICAgbW9y
ZSBjb25zaXN0ZW50DQo+IC0gUmVmYWN0b3IgbmV0d29ya19lbmNyeXB0L25ldHdvcmtfZGVjcnlw
dCB0byB1c2UgKl9ub25jZSBmdW5jdGlvbnMgYW5kDQo+ICAgcmVuYW1lIHRoZW0gdG8gcGFja2V0
X2VuY3J5cHQvcGFja2V0X2RlY3J5cHQNCj4gLSBSZWZhY3RvciBwYWNrZXRfZW5jb2RlL3BhY2tl
dF9kZWNvZGUNCj4gLS0tDQo+ICBtZXNoL2NyeXB0by5jICAgICAgICAgICB8IDQ4MSArKysrKysr
KysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQo+ICBtZXNoL2NyeXB0by5oICAgICAg
ICAgICB8ICA1MCArLS0tLQ0KPiAgbWVzaC9uZXQta2V5cy5jICAgICAgICAgfCAgIDIgKy0NCj4g
IHVuaXQvdGVzdC1tZXNoLWNyeXB0by5jIHwgMjA1ICsrKysrKysrLS0tLS0tLS0tDQo+ICA0IGZp
bGVzIGNoYW5nZWQsIDI5MSBpbnNlcnRpb25zKCspLCA0NDcgZGVsZXRpb25zKC0pDQo+IA0KPiBk
aWZmIC0tZ2l0IGEvbWVzaC9jcnlwdG8uYyBiL21lc2gvY3J5cHRvLmMNCj4gaW5kZXggNTk2YTI4
OWY5Li5jZTMzNWJiZWMgMTAwNjQ0DQo+IC0tLSBhL21lc2gvY3J5cHRvLmMNCj4gKysrIGIvbWVz
aC9jcnlwdG8uYw0KPiBAQCAtMzI3LDE0NCArMzI3LDU5IEBAIGJvb2wgbWVzaF9jcnlwdG9fYmVh
Y29uX2NtYWMoY29uc3QgdWludDhfdCBlbmNyeXB0aW9uX2tleVsxNl0sDQo+ICAJcmV0dXJuIHRy
dWU7DQo+ICB9DQo+ICANCj4gLWJvb2wgbWVzaF9jcnlwdG9fbmV0d29ya19ub25jZShib29sIGN0
bCwgdWludDhfdCB0dGwsIHVpbnQzMl90IHNlcSwNCj4gLQkJCQl1aW50MTZfdCBzcmMsIHVpbnQz
Ml90IGl2X2luZGV4LA0KPiAtCQkJCXVpbnQ4X3Qgbm9uY2VbMTNdKQ0KPiArc3RhdGljIHZvaWQg
bWVzaF9jcnlwdG9fbmV0d29ya19ub25jZShib29sIGN0bCwgdWludDhfdCB0dGwsDQo+ICsJCQkJ
CXVpbnQzMl90IHNlcSwgdWludDE2X3Qgc3JjLA0KPiArCQkJCQl1aW50MzJfdCBpdl9pbmRleCwg
dWludDhfdCBub25jZVsxM10pDQo+ICB7DQo+IC0Jbm9uY2VbMF0gPSAwOw0KPiArCW5vbmNlWzBd
ID0gMHgwMDsNCj4gIAlub25jZVsxXSA9ICh0dGwgJiBUVExfTUFTSykgfCAoY3RsID8gQ1RMIDog
MHgwMCk7DQo+ICAJbm9uY2VbMl0gPSAoc2VxID4+IDE2KSAmIDB4ZmY7DQo+ICAJbm9uY2VbM10g
PSAoc2VxID4+IDgpICYgMHhmZjsNCj4gIAlub25jZVs0XSA9IHNlcSAmIDB4ZmY7DQo+IC0NCj4g
LQkvKiBTUkMgKi8NCj4gIAlsX3B1dF9iZTE2KHNyYywgbm9uY2UgKyA1KTsNCj4gLQ0KPiAgCWxf
cHV0X2JlMTYoMCwgbm9uY2UgKyA3KTsNCj4gLQ0KPiAtCS8qIElWIEluZGV4ICovDQo+ICAJbF9w
dXRfYmUzMihpdl9pbmRleCwgbm9uY2UgKyA5KTsNCj4gLQ0KPiAtCXJldHVybiB0cnVlOw0KPiAt
fQ0KPiAtDQo+IC1ib29sIG1lc2hfY3J5cHRvX25ldHdvcmtfZW5jcnlwdChib29sIGN0bCwgdWlu
dDhfdCB0dGwsDQo+IC0JCQkJdWludDMyX3Qgc2VxLCB1aW50MTZfdCBzcmMsDQo+IC0JCQkJdWlu
dDMyX3QgaXZfaW5kZXgsDQo+IC0JCQkJY29uc3QgdWludDhfdCBuZXRfa2V5WzE2XSwNCj4gLQkJ
CQljb25zdCB1aW50OF90ICplbmNfbXNnLCB1aW50OF90IGVuY19tc2dfbGVuLA0KPiAtCQkJCXVp
bnQ4X3QgKm91dCwgdm9pZCAqbmV0X21pYykNCj4gLXsNCj4gLQl1aW50OF90IG5vbmNlWzEzXTsN
Cj4gLQ0KPiAtCWlmICghbWVzaF9jcnlwdG9fbmV0d29ya19ub25jZShjdGwsIHR0bCwgc2VxLCBz
cmMsIGl2X2luZGV4LCBub25jZSkpDQo+IC0JCXJldHVybiBmYWxzZTsNCj4gLQ0KPiAtCXJldHVy
biBtZXNoX2NyeXB0b19hZXNfY2NtX2VuY3J5cHQobm9uY2UsIG5ldF9rZXksIE5VTEwsIDAsIGVu
Y19tc2csDQo+IC0JCQkJZW5jX21zZ19sZW4sIG91dCwgbmV0X21pYywNCj4gLQkJCQljdGwgPyA4
IDogNCk7DQo+ICB9DQo+ICANCj4gLWJvb2wgbWVzaF9jcnlwdG9fbmV0d29ya19kZWNyeXB0KGJv
b2wgY3RsLCB1aW50OF90IHR0bCwNCj4gLQkJCQl1aW50MzJfdCBzZXEsIHVpbnQxNl90IHNyYywN
Cj4gLQkJCQl1aW50MzJfdCBpdl9pbmRleCwNCj4gLQkJCQljb25zdCB1aW50OF90IG5ldF9rZXlb
MTZdLA0KPiAtCQkJCWNvbnN0IHVpbnQ4X3QgKmVuY19tc2csIHVpbnQ4X3QgZW5jX21zZ19sZW4s
DQo+IC0JCQkJdWludDhfdCAqb3V0LCB2b2lkICpuZXRfbWljLCBzaXplX3QgbWljX3NpemUpDQo+
IC17DQo+IC0JdWludDhfdCBub25jZVsxM107DQo+IC0NCj4gLQlpZiAoIW1lc2hfY3J5cHRvX25l
dHdvcmtfbm9uY2UoY3RsLCB0dGwsIHNlcSwgc3JjLCBpdl9pbmRleCwgbm9uY2UpKQ0KPiAtCQly
ZXR1cm4gZmFsc2U7DQo+IC0NCj4gLQlyZXR1cm4gbWVzaF9jcnlwdG9fYWVzX2NjbV9kZWNyeXB0
KG5vbmNlLCBuZXRfa2V5LCBOVUxMLCAwLA0KPiAtCQkJCQkJZW5jX21zZywgZW5jX21zZ19sZW4s
IG91dCwNCj4gLQkJCQkJCW5ldF9taWMsIG1pY19zaXplKTsNCj4gLX0NCj4gLQ0KPiAtYm9vbCBt
ZXNoX2NyeXB0b19hcHBsaWNhdGlvbl9ub25jZSh1aW50MzJfdCBzZXEsIHVpbnQxNl90IHNyYywN
Cj4gK3N0YXRpYyB2b2lkIG1lc2hfY3J5cHRvX2FwcGxpY2F0aW9uX25vbmNlKHVpbnQzMl90IHNl
cSwgdWludDE2X3Qgc3JjLA0KPiAgCQkJCQl1aW50MTZfdCBkc3QsIHVpbnQzMl90IGl2X2luZGV4
LA0KPiAgCQkJCQlib29sIGFzem1pYywgdWludDhfdCBub25jZVsxM10pDQo+ICB7DQo+ICAJbm9u
Y2VbMF0gPSAweDAxOw0KPiAgCW5vbmNlWzFdID0gYXN6bWljID8gMHg4MCA6IDB4MDA7DQo+IC0J
bm9uY2VbMl0gPSAoc2VxICYgMHgwMGZmMDAwMCkgPj4gMTY7DQo+IC0Jbm9uY2VbM10gPSAoc2Vx
ICYgMHgwMDAwZmYwMCkgPj4gODsNCj4gLQlub25jZVs0XSA9IChzZXEgJiAweDAwMDAwMGZmKTsN
Cj4gLQlub25jZVs1XSA9IChzcmMgJiAweGZmMDApID4+IDg7DQo+IC0Jbm9uY2VbNl0gPSAoc3Jj
ICYgMHgwMGZmKTsNCj4gLQlub25jZVs3XSA9IChkc3QgJiAweGZmMDApID4+IDg7DQo+IC0Jbm9u
Y2VbOF0gPSAoZHN0ICYgMHgwMGZmKTsNCj4gKwlub25jZVsyXSA9IChzZXEgPj4gMTYgKSAmIDB4
ZmY7DQo+ICsJbm9uY2VbM10gPSAoc2VxID4+IDgpICYgMHhmZjsNCj4gKwlub25jZVs0XSA9IHNl
cSAmIDB4ZmY7DQo+ICsJbF9wdXRfYmUxNihzcmMsIG5vbmNlICsgNSk7DQo+ICsJbF9wdXRfYmUx
Nihkc3QsIG5vbmNlICsgNyk7DQo+ICAJbF9wdXRfYmUzMihpdl9pbmRleCwgbm9uY2UgKyA5KTsN
Cj4gLQ0KPiAtCXJldHVybiB0cnVlOw0KPiAgfQ0KPiAgDQo+IC1ib29sIG1lc2hfY3J5cHRvX2Rl
dmljZV9ub25jZSh1aW50MzJfdCBzZXEsIHVpbnQxNl90IHNyYywNCj4gK3N0YXRpYyB2b2lkIG1l
c2hfY3J5cHRvX2RldmljZV9ub25jZSh1aW50MzJfdCBzZXEsIHVpbnQxNl90IHNyYywNCj4gIAkJ
CQkJdWludDE2X3QgZHN0LCB1aW50MzJfdCBpdl9pbmRleCwNCj4gIAkJCQkJYm9vbCBhc3ptaWMs
IHVpbnQ4X3Qgbm9uY2VbMTNdKQ0KPiAgew0KPiAgCW5vbmNlWzBdID0gMHgwMjsNCj4gIAlub25j
ZVsxXSA9IGFzem1pYyA/IDB4ODAgOiAweDAwOw0KPiAtCW5vbmNlWzJdID0gKHNlcSAmIDB4MDBm
ZjAwMDApID4+IDE2Ow0KPiAtCW5vbmNlWzNdID0gKHNlcSAmIDB4MDAwMGZmMDApID4+IDg7DQo+
IC0Jbm9uY2VbNF0gPSAoc2VxICYgMHgwMDAwMDBmZik7DQo+IC0Jbm9uY2VbNV0gPSAoc3JjICYg
MHhmZjAwKSA+PiA4Ow0KPiAtCW5vbmNlWzZdID0gKHNyYyAmIDB4MDBmZik7DQo+IC0Jbm9uY2Vb
N10gPSAoZHN0ICYgMHhmZjAwKSA+PiA4Ow0KPiAtCW5vbmNlWzhdID0gKGRzdCAmIDB4MDBmZik7
DQo+ICsJbm9uY2VbMl0gPSAoc2VxID4+IDE2ICkgJiAweGZmOw0KPiArCW5vbmNlWzNdID0gKHNl
cSA+PiA4KSAmIDB4ZmY7DQo+ICsJbm9uY2VbNF0gPSBzZXEgJiAweGZmOw0KPiArCWxfcHV0X2Jl
MTYoc3JjLCBub25jZSArIDUpOw0KPiArCWxfcHV0X2JlMTYoZHN0LCBub25jZSArIDcpOw0KPiAg
CWxfcHV0X2JlMzIoaXZfaW5kZXgsIG5vbmNlICsgOSk7DQo+IC0NCj4gLQlyZXR1cm4gdHJ1ZTsN
Cj4gIH0NCj4gIA0KPiAtYm9vbCBtZXNoX2NyeXB0b19hcHBsaWNhdGlvbl9lbmNyeXB0KHVpbnQ4
X3Qga2V5X2FpZCwgdWludDMyX3Qgc2VxLA0KPiAtCQkJCQl1aW50MTZfdCBzcmMsIHVpbnQxNl90
IGRzdCwNCj4gLQkJCQkJdWludDMyX3QgaXZfaW5kZXgsDQo+IC0JCQkJCWNvbnN0IHVpbnQ4X3Qg
YXBwX2tleVsxNl0sDQo+IC0JCQkJCWNvbnN0IHVpbnQ4X3QgKmFhZCwgdWludDhfdCBhYWRfbGVu
LA0KPiAtCQkJCQljb25zdCB1aW50OF90ICptc2csIHVpbnQ4X3QgbXNnX2xlbiwNCj4gLQkJCQkJ
dWludDhfdCAqb3V0LA0KPiAtCQkJCQl2b2lkICphcHBfbWljLCBzaXplX3QgbWljX3NpemUpDQo+
ICtzdGF0aWMgdm9pZCBtZXNoX2NyeXB0b19wcm94eV9ub25jZSh1aW50MzJfdCBzZXEsIHVpbnQx
Nl90IHNyYywNCj4gKwkJCQkJdWludDMyX3QgaXZfaW5kZXgsIHVpbnQ4X3Qgbm9uY2VbMTNdKQ0K
PiAgew0KPiAtCXVpbnQ4X3Qgbm9uY2VbMTNdOw0KPiAtCWJvb2wgYXN6bWljID0gKG1pY19zaXpl
ID09IDgpID8gdHJ1ZSA6IGZhbHNlOw0KPiAtDQo+IC0JaWYgKCFrZXlfYWlkICYmICFtZXNoX2Ny
eXB0b19kZXZpY2Vfbm9uY2Uoc2VxLCBzcmMsIGRzdCwNCj4gLQkJCQkJCWl2X2luZGV4LCBhc3pt
aWMsIG5vbmNlKSkNCj4gLQkJcmV0dXJuIGZhbHNlOw0KPiAtDQo+IC0JaWYgKGtleV9haWQgJiYg
IW1lc2hfY3J5cHRvX2FwcGxpY2F0aW9uX25vbmNlKHNlcSwgc3JjLCBkc3QsDQo+IC0JCQkJCQlp
dl9pbmRleCwgYXN6bWljLCBub25jZSkpDQo+IC0JCXJldHVybiBmYWxzZTsNCj4gLQ0KPiAtCXJl
dHVybiBtZXNoX2NyeXB0b19hZXNfY2NtX2VuY3J5cHQobm9uY2UsIGFwcF9rZXksIGFhZCwgYWFk
X2xlbiwNCj4gLQkJCQkJCW1zZywgbXNnX2xlbiwNCj4gLQkJCQkJCW91dCwgYXBwX21pYywgbWlj
X3NpemUpOw0KPiAtfQ0KPiAtDQo+IC1ib29sIG1lc2hfY3J5cHRvX2FwcGxpY2F0aW9uX2RlY3J5
cHQodWludDhfdCBrZXlfYWlkLCB1aW50MzJfdCBzZXEsDQo+IC0JCQkJdWludDE2X3Qgc3JjLCB1
aW50MTZfdCBkc3QsIHVpbnQzMl90IGl2X2luZGV4LA0KPiAtCQkJCWNvbnN0IHVpbnQ4X3QgYXBw
X2tleVsxNl0sDQo+IC0JCQkJY29uc3QgdWludDhfdCAqYWFkLCB1aW50OF90IGFhZF9sZW4sDQo+
IC0JCQkJY29uc3QgdWludDhfdCAqZW5jX21zZywgdWludDhfdCBlbmNfbXNnX2xlbiwNCj4gLQkJ
CQl1aW50OF90ICpvdXQsIHZvaWQgKmFwcF9taWMsIHNpemVfdCBtaWNfc2l6ZSkNCj4gLXsNCj4g
LQl1aW50OF90IG5vbmNlWzEzXTsNCj4gLQlib29sIGFzem1pYyA9IChtaWNfc2l6ZSA9PSA4KSA/
IHRydWUgOiBmYWxzZTsNCj4gLQ0KPiAtCWlmICgha2V5X2FpZCAmJiAhbWVzaF9jcnlwdG9fZGV2
aWNlX25vbmNlKHNlcSwgc3JjLCBkc3QsDQo+IC0JCQkJCQlpdl9pbmRleCwgYXN6bWljLCBub25j
ZSkpDQo+IC0JCXJldHVybiBmYWxzZTsNCj4gLQ0KPiAtCWlmIChrZXlfYWlkICYmICFtZXNoX2Ny
eXB0b19hcHBsaWNhdGlvbl9ub25jZShzZXEsIHNyYywgZHN0LA0KPiAtCQkJCQkJaXZfaW5kZXgs
IGFzem1pYywgbm9uY2UpKQ0KPiAtCQlyZXR1cm4gZmFsc2U7DQo+IC0NCj4gLQlyZXR1cm4gbWVz
aF9jcnlwdG9fYWVzX2NjbV9kZWNyeXB0KG5vbmNlLCBhcHBfa2V5LA0KPiAtCQkJCQkJYWFkLCBh
YWRfbGVuLCBlbmNfbXNnLA0KPiAtCQkJCQkJZW5jX21zZ19sZW4sIG91dCwNCj4gLQkJCQkJCWFw
cF9taWMsIG1pY19zaXplKTsNCj4gKwlub25jZVswXSA9IDB4MDM7DQo+ICsJbm9uY2VbMV0gPSAw
Ow0KPiArCW5vbmNlWzJdID0gKHNlcSA+PiAxNikgJiAweGZmOw0KPiArCW5vbmNlWzNdID0gKHNl
cSA+PiA4KSAmIDB4ZmY7DQo+ICsJbm9uY2VbNF0gPSBzZXEgJiAweGZmOw0KPiArCWxfcHV0X2Jl
MTYoc3JjLCBub25jZSArIDUpOw0KPiArCWxfcHV0X2JlMTYoMCwgbm9uY2UgKyA3KTsNCj4gKwls
X3B1dF9iZTMyKGl2X2luZGV4LCBub25jZSArIDkpOw0KPiAgfQ0KPiAgDQo+ICBib29sIG1lc2hf
Y3J5cHRvX3Nlc3Npb25fa2V5KGNvbnN0IHVpbnQ4X3Qgc2VjcmV0WzMyXSwNCj4gQEAgLTU1Nyw2
OSArNDcyLDY3IEBAIGJvb2wgbWVzaF9jcnlwdG9fdmlydHVhbF9hZGRyKGNvbnN0IHVpbnQ4X3Qg
dmlydHVhbF9sYWJlbFsxNl0sDQo+ICAJcmV0dXJuIHRydWU7DQo+ICB9DQo+ICANCj4gLWJvb2wg
bWVzaF9jcnlwdG9fcHJpdmFjeV9jb3VudGVyKHVpbnQzMl90IGl2X2luZGV4LA0KPiArc3RhdGlj
IHZvaWQgbWVzaF9jcnlwdG9fcHJpdmFjeV9jb3VudGVyKHVpbnQzMl90IGl2X2luZGV4LA0KPiAg
CQkJCQkJY29uc3QgdWludDhfdCAqcGF5bG9hZCwNCj4gIAkJCQkJCXVpbnQ4X3QgcHJpdmFjeV9j
b3VudGVyWzE2XSkNCj4gIHsNCj4gIAltZW1zZXQocHJpdmFjeV9jb3VudGVyLCAwLCA1KTsNCj4g
IAlsX3B1dF9iZTMyKGl2X2luZGV4LCBwcml2YWN5X2NvdW50ZXIgKyA1KTsNCj4gIAltZW1jcHko
cHJpdmFjeV9jb3VudGVyICsgOSwgcGF5bG9hZCwgNyk7DQo+ICt9DQo+ICANCj4gLQlyZXR1cm4g
dHJ1ZTsNCj4gK3N0YXRpYyBib29sIG1lc2hfY3J5cHRvX3BlY2IoY29uc3QgdWludDhfdCBwcml2
YWN5X2tleVsxNl0sDQo+ICsJCQkJCQl1aW50MzJfdCBpdl9pbmRleCwNCj4gKwkJCQkJCWNvbnN0
IHVpbnQ4X3QgKnBheWxvYWQsDQo+ICsJCQkJCQl1aW50OF90IHBlY2JbMTZdKQ0KPiArew0KPiAr
CW1lc2hfY3J5cHRvX3ByaXZhY3lfY291bnRlcihpdl9pbmRleCwgcGF5bG9hZCwgcGVjYik7DQo+
ICsJcmV0dXJuIGFlc19lY2Jfb25lKHByaXZhY3lfa2V5LCBwZWNiLCBwZWNiKTsNCj4gIH0NCj4g
IA0KPiAtYm9vbCBtZXNoX2NyeXB0b19uZXR3b3JrX29iZnVzY2F0ZShjb25zdCB1aW50OF90IHBy
aXZhY3lfa2V5WzE2XSwNCj4gLQkJCQkJY29uc3QgdWludDhfdCBwcml2YWN5X2NvdW50ZXJbMTZd
LA0KPiAtCQkJCQlib29sIGN0bCwgdWludDhfdCB0dGwsIHVpbnQzMl90IHNlcSwNCj4gLQkJCQkJ
dWludDE2X3Qgc3JjLCB1aW50OF90ICpvdXQpDQo+ICtzdGF0aWMgYm9vbCBtZXNoX2NyeXB0b19u
ZXR3b3JrX29iZnVzY2F0ZSh1aW50OF90ICpwYWNrZXQsDQo+ICsJCQkJCQljb25zdCB1aW50OF90
IHByaXZhY3lfa2V5WzE2XSwNCj4gKwkJCQkJCXVpbnQzMl90IGl2X2luZGV4LA0KPiArCQkJCQkJ
Ym9vbCBjdGwsIHVpbnQ4X3QgdHRsLA0KPiArCQkJCQkJdWludDMyX3Qgc2VxLCB1aW50MTZfdCBz
cmMpDQo+ICB7DQo+IC0JdWludDhfdCBlY2JbMTZdLCB0bXBbMTZdOw0KPiArCXVpbnQ4X3QgcGVj
YlsxNl07DQo+ICsJdWludDhfdCAqbmV0X2hkciA9IHBhY2tldCArIDE7DQo+ICAJaW50IGk7DQo+
ICANCj4gLQlpZiAoIWFlc19lY2Jfb25lKHByaXZhY3lfa2V5LCBwcml2YWN5X2NvdW50ZXIsIGVj
YikpDQo+ICsJaWYgKCFtZXNoX2NyeXB0b19wZWNiKHByaXZhY3lfa2V5LCBpdl9pbmRleCwgcGFj
a2V0ICsgNywgcGVjYikpDQo+ICAJCXJldHVybiBmYWxzZTsNCj4gIA0KPiAtCXRtcFswXSA9ICgo
ISFjdGwpIDw8IDcpIHwgKHR0bCAmIFRUTF9NQVNLKTsNCj4gLQl0bXBbMV0gPSAoc2VxICYgMHhm
ZjAwMDApID4+IDE2Ow0KPiAtCXRtcFsyXSA9IChzZXEgJiAweDAwZmYwMCkgPj4gODsNCj4gLQl0
bXBbM10gPSAoc2VxICYgMHgwMDAwZmYpOw0KPiAtCXRtcFs0XSA9IChzcmMgJiAweGZmMDApID4+
IDg7DQo+IC0JdG1wWzVdID0gKHNyYyAmIDB4MDBmZik7DQo+ICsJbF9wdXRfYmUxNihzcmMsIG5l
dF9oZHIgKyA0KTsNCj4gKwlsX3B1dF9iZTMyKHNlcSAmIFNFUV9NQVNLLCBuZXRfaGRyKTsNCj4g
KwluZXRfaGRyWzBdID0gKCghIWN0bCkgPDwgNykgfCAodHRsICYgVFRMX01BU0spOw0KPiAgDQo+
IC0JaWYgKG91dCkgew0KPiAtCQlmb3IgKGkgPSAwOyBpIDwgNjsgaSsrKQ0KPiAtCQkJb3V0W2ld
ID0gZWNiW2ldIF4gdG1wW2ldOw0KPiAtCX0NCj4gKwlmb3IgKGkgPSAwOyBpIDwgNjsgaSsrKQ0K
PiArCQluZXRfaGRyW2ldID0gcGVjYltpXSBeIG5ldF9oZHJbaV07DQo+ICANCj4gIAlyZXR1cm4g
dHJ1ZTsNCj4gIH0NCj4gIA0KPiAtYm9vbCBtZXNoX2NyeXB0b19uZXR3b3JrX2NsYXJpZnkoY29u
c3QgdWludDhfdCBwcml2YWN5X2tleVsxNl0sDQo+IC0JCQkJY29uc3QgdWludDhfdCBwcml2YWN5
X2NvdW50ZXJbMTZdLA0KPiAtCQkJCWNvbnN0IHVpbnQ4X3QgbmV0X2hkcls2XSwNCj4gLQkJCQli
b29sICpjdGwsIHVpbnQ4X3QgKnR0bCwNCj4gLQkJCQl1aW50MzJfdCAqc2VxLCB1aW50MTZfdCAq
c3JjKQ0KPiArc3RhdGljIGJvb2wgbWVzaF9jcnlwdG9fbmV0d29ya19jbGFyaWZ5KHVpbnQ4X3Qg
KnBhY2tldCwNCj4gKwkJCQkJCWNvbnN0IHVpbnQ4X3QgcHJpdmFjeV9rZXlbMTZdLA0KPiArCQkJ
CQkJdWludDMyX3QgaXZfaW5kZXgsDQo+ICsJCQkJCQlib29sICpjdGwsIHVpbnQ4X3QgKnR0bCwN
Cj4gKwkJCQkJCXVpbnQzMl90ICpzZXEsIHVpbnQxNl90ICpzcmMpDQo+ICB7DQo+IC0JdWludDhf
dCBlY2JbMTZdLCB0bXBbNl07DQo+ICsJdWludDhfdCBwZWNiWzE2XTsNCj4gKwl1aW50OF90ICpu
ZXRfaGRyID0gcGFja2V0ICsgMTsNCj4gIAlpbnQgaTsNCj4gIA0KPiAtCWlmICghYWVzX2VjYl9v
bmUocHJpdmFjeV9rZXksIHByaXZhY3lfY291bnRlciwgZWNiKSkNCj4gKwlpZiAoIW1lc2hfY3J5
cHRvX3BlY2IocHJpdmFjeV9rZXksIGl2X2luZGV4LCBwYWNrZXQgKyA3LCBwZWNiKSkNCj4gIAkJ
cmV0dXJuIGZhbHNlOw0KPiAgDQo+ICAJZm9yIChpID0gMDsgaSA8IDY7IGkrKykNCj4gLQkJdG1w
W2ldID0gZWNiW2ldIF4gbmV0X2hkcltpXTsNCj4gLQ0KPiAtCWlmIChjdGwpDQo+IC0JCSpjdGwg
PSAhISh0bXBbMF0gJiBDVEwpOw0KPiArCQluZXRfaGRyW2ldID0gcGVjYltpXSBeIG5ldF9oZHJb
aV07DQo+ICANCj4gLQlpZiAodHRsKQ0KPiAtCQkqdHRsID0gdG1wWzBdICYgVFRMX01BU0s7DQo+
IC0NCj4gLQlpZiAoc2VxKQ0KPiAtCQkqc2VxID0gbF9nZXRfYmUzMih0bXApICYgU0VRX01BU0s7
DQo+IC0NCj4gLQlpZiAoc3JjKQ0KPiAtCQkqc3JjID0gbF9nZXRfYmUxNih0bXAgKyA0KTsNCj4g
Kwkqc3JjID0gbF9nZXRfYmUxNihuZXRfaGRyICsgNCk7DQo+ICsJKnNlcSA9IGxfZ2V0X2JlMzIo
bmV0X2hkcikgJiBTRVFfTUFTSzsNCj4gKwkqdHRsID0gbmV0X2hkclswXSAmIFRUTF9NQVNLOw0K
PiArCSpjdGwgPSAhIShuZXRfaGRyWzBdICYgQ1RMKTsNCj4gIA0KPiAgCXJldHVybiB0cnVlOw0K
PiAgfQ0KPiBAQCAtNjg5LDI0ICs2MDIsMTMgQEAgYm9vbCBtZXNoX2NyeXB0b19wYWNrZXRfYnVp
bGQoYm9vbCBjdGwsIHVpbnQ4X3QgdHRsLA0KPiAgCXJldHVybiB0cnVlOw0KPiAgfQ0KPiAgDQo+
IC1ib29sIG1lc2hfY3J5cHRvX3BhY2tldF9wYXJzZShjb25zdCB1aW50OF90ICpwYWNrZXQsIHVp
bnQ4X3QgcGFja2V0X2xlbiwNCj4gK3N0YXRpYyBib29sIG5ldHdvcmtfaGVhZGVyX3BhcnNlKGNv
bnN0IHVpbnQ4X3QgKnBhY2tldCwgdWludDhfdCBwYWNrZXRfbGVuLA0KPiAgCQkJCWJvb2wgKmN0
bCwgdWludDhfdCAqdHRsLCB1aW50MzJfdCAqc2VxLA0KPiAtCQkJCXVpbnQxNl90ICpzcmMsIHVp
bnQxNl90ICpkc3QsDQo+IC0JCQkJdWludDMyX3QgKmNvb2tpZSwgdWludDhfdCAqb3Bjb2RlLA0K
PiAtCQkJCWJvb2wgKnNlZ21lbnRlZCwgdWludDhfdCAqa2V5X2FpZCwNCj4gLQkJCQlib29sICpz
em1pYywgYm9vbCAqcmVsYXksIHVpbnQxNl90ICpzZXFaZXJvLA0KPiAtCQkJCXVpbnQ4X3QgKnNl
Z08sIHVpbnQ4X3QgKnNlZ04sDQo+IC0JCQkJY29uc3QgdWludDhfdCAqKnBheWxvYWQsIHVpbnQ4
X3QgKnBheWxvYWRfbGVuKQ0KPiArCQkJCXVpbnQxNl90ICpzcmMsIHVpbnQxNl90ICpkc3QpDQo+
ICB7DQo+IC0JdWludDMyX3QgaGRyOw0KPiAtCXVpbnQxNl90IHRoaXNfZHN0Ow0KPiAtCWJvb2wg
aXNfc2VnbWVudGVkOw0KPiAtDQo+ICAJaWYgKHBhY2tldF9sZW4gPCAxMCkNCj4gIAkJcmV0dXJu
IGZhbHNlOw0KPiAgDQo+IC0JdGhpc19kc3QgPSBsX2dldF9iZTE2KHBhY2tldCArIDcpOw0KPiAt
DQo+ICAJLyogVHJ5IHRvIGtlZXAgYml0cyBpbiB0aGUgb3JkZXIgdGhleSBleGlzdCB3aXRoaW4g
dGhlIHBhY2tldCAqLw0KPiAgCWlmIChjdGwpDQo+ICAJCSpjdGwgPSAhIShwYWNrZXRbMV0gJiBD
VEwpOw0KPiBAQCAtNzIwLDYgKzYyMiwzMCBAQCBib29sIG1lc2hfY3J5cHRvX3BhY2tldF9wYXJz
ZShjb25zdCB1aW50OF90ICpwYWNrZXQsIHVpbnQ4X3QgcGFja2V0X2xlbiwNCj4gIAlpZiAoc3Jj
KQ0KPiAgCQkqc3JjID0gbF9nZXRfYmUxNihwYWNrZXQgKyA1KTsNCj4gIA0KPiArCWlmIChkc3Qp
DQo+ICsJCSpkc3QgPSBsX2dldF9iZTE2KHBhY2tldCArIDcpOw0KPiArDQo+ICsJcmV0dXJuIHRy
dWU7DQo+ICsNCj4gK30NCj4gKw0KPiArYm9vbCBtZXNoX2NyeXB0b19wYWNrZXRfcGFyc2UoY29u
c3QgdWludDhfdCAqcGFja2V0LCB1aW50OF90IHBhY2tldF9sZW4sDQo+ICsJCQkJYm9vbCAqY3Rs
LCB1aW50OF90ICp0dGwsIHVpbnQzMl90ICpzZXEsDQo+ICsJCQkJdWludDE2X3QgKnNyYywgdWlu
dDE2X3QgKmRzdCwNCj4gKwkJCQl1aW50MzJfdCAqY29va2llLCB1aW50OF90ICpvcGNvZGUsDQo+
ICsJCQkJYm9vbCAqc2VnbWVudGVkLCB1aW50OF90ICprZXlfYWlkLA0KPiArCQkJCWJvb2wgKnN6
bWljLCBib29sICpyZWxheSwgdWludDE2X3QgKnNlcVplcm8sDQo+ICsJCQkJdWludDhfdCAqc2Vn
TywgdWludDhfdCAqc2VnTiwNCj4gKwkJCQljb25zdCB1aW50OF90ICoqcGF5bG9hZCwgdWludDhf
dCAqcGF5bG9hZF9sZW4pDQo+ICt7DQo+ICsJdWludDMyX3QgaGRyOw0KPiArCXVpbnQxNl90IHRo
aXNfZHN0Ow0KPiArCWJvb2wgaXNfc2VnbWVudGVkOw0KPiArDQo+ICsJaWYgKCFuZXR3b3JrX2hl
YWRlcl9wYXJzZShwYWNrZXQsIHBhY2tldF9sZW4sDQo+ICsJCQkJCWN0bCwgdHRsLCBzZXEsIHNy
YywgJnRoaXNfZHN0KSkNCj4gKwkJcmV0dXJuIGZhbHNlOw0KPiArDQo+ICAJaWYgKGRzdCkNCj4g
IAkJKmRzdCA9IHRoaXNfZHN0Ow0KPiAgDQo+IEBAIC03OTksMzggKzcyNSwyNyBAQCBib29sIG1l
c2hfY3J5cHRvX3BhY2tldF9wYXJzZShjb25zdCB1aW50OF90ICpwYWNrZXQsIHVpbnQ4X3QgcGFj
a2V0X2xlbiwNCj4gIGJvb2wgbWVzaF9jcnlwdG9fcGF5bG9hZF9lbmNyeXB0KHVpbnQ4X3QgKmFh
ZCwgY29uc3QgdWludDhfdCAqcGF5bG9hZCwNCj4gIAkJCQl1aW50OF90ICpvdXQsIHVpbnQxNl90
IHBheWxvYWRfbGVuLA0KPiAgCQkJCXVpbnQxNl90IHNyYywgdWludDE2X3QgZHN0LCB1aW50OF90
IGtleV9haWQsDQo+IC0JCQkJdWludDMyX3Qgc2VxX251bSwgdWludDMyX3QgaXZfaW5kZXgsDQo+
ICsJCQkJdWludDMyX3Qgc2VxLCB1aW50MzJfdCBpdl9pbmRleCwNCj4gIAkJCQlib29sIGFzem1p
YywNCj4gLQkJCQljb25zdCB1aW50OF90IGFwcGxpY2F0aW9uX2tleVsxNl0pDQo+ICsJCQkJY29u
c3QgdWludDhfdCBhcHBfa2V5WzE2XSkNCj4gIHsNCj4gLQl1aW50OF90IGFwcGxpY2F0aW9uX25v
bmNlWzEzXSA9IHsgMHgwMSwgfTsNCj4gKwl1aW50OF90IG5vbmNlWzEzXTsNCj4gIA0KPiAgCWlm
IChwYXlsb2FkX2xlbiA8IDEpDQo+ICAJCXJldHVybiBmYWxzZTsNCj4gIA0KPiAgCWlmIChrZXlf
YWlkID09IEFQUF9BSURfREVWKQ0KPiAtCQlhcHBsaWNhdGlvbl9ub25jZVswXSA9IDB4MDI7DQo+
IC0NCj4gLQkvKiBTZXEgTnVtICovDQo+IC0JbF9wdXRfYmUzMihzZXFfbnVtLCBhcHBsaWNhdGlv
bl9ub25jZSArIDEpOw0KPiAtDQo+IC0JLyogQVNaTUlDICovDQo+IC0JYXBwbGljYXRpb25fbm9u
Y2VbMV0gfD0gYXN6bWljID8gMHg4MCA6IDB4MDA7DQo+IC0NCj4gLQkvKiBTUkMgKi8NCj4gLQls
X3B1dF9iZTE2KHNyYywgYXBwbGljYXRpb25fbm9uY2UgKyA1KTsNCj4gLQ0KPiAtCS8qIERTVCAq
Lw0KPiAtCWxfcHV0X2JlMTYoZHN0LCBhcHBsaWNhdGlvbl9ub25jZSArIDcpOw0KPiAtDQo+IC0J
LyogSVYgSW5kZXggKi8NCj4gLQlsX3B1dF9iZTMyKGl2X2luZGV4LCBhcHBsaWNhdGlvbl9ub25j
ZSArIDkpOw0KPiAtDQo+IC0JaWYgKCFtZXNoX2NyeXB0b19hZXNfY2NtX2VuY3J5cHQoYXBwbGlj
YXRpb25fbm9uY2UsIGFwcGxpY2F0aW9uX2tleSwNCj4gLQkJCQkJYWFkLCBhYWQgPyAxNiA6IDAs
DQo+IC0JCQkJCXBheWxvYWQsIHBheWxvYWRfbGVuLA0KPiAtCQkJCQlvdXQsIE5VTEwsDQo+IC0J
CQkJCWFzem1pYyA/IDggOiA0KSkNCj4gKwkJbWVzaF9jcnlwdG9fZGV2aWNlX25vbmNlKHNlcSwg
c3JjLCBkc3QsIGl2X2luZGV4LCBhc3ptaWMsDQo+ICsJCQkJCQkJCQlub25jZSk7DQo+ICsJZWxz
ZQ0KPiArCQltZXNoX2NyeXB0b19hcHBsaWNhdGlvbl9ub25jZShzZXEsIHNyYywgZHN0LCBpdl9p
bmRleCwgYXN6bWljLA0KPiArCQkJCQkJCQkJbm9uY2UpOw0KPiArDQo+ICsJaWYgKCFtZXNoX2Ny
eXB0b19hZXNfY2NtX2VuY3J5cHQobm9uY2UsIGFwcF9rZXksDQo+ICsJCQkJCQkJYWFkLCBhYWQg
PyAxNiA6IDAsDQo+ICsJCQkJCQkJcGF5bG9hZCwgcGF5bG9hZF9sZW4sDQo+ICsJCQkJCQkJb3V0
LCBOVUxMLA0KPiArCQkJCQkJCWFzem1pYyA/IDggOiA0KSkNCj4gIAkJcmV0dXJuIGZhbHNlOw0K
PiAgDQo+ICAJcmV0dXJuIHRydWU7DQo+IEBAIC04MzgsMTMgKzc1MywxMyBAQCBib29sIG1lc2hf
Y3J5cHRvX3BheWxvYWRfZW5jcnlwdCh1aW50OF90ICphYWQsIGNvbnN0IHVpbnQ4X3QgKnBheWxv
YWQsDQo+ICANCj4gIGJvb2wgbWVzaF9jcnlwdG9fcGF5bG9hZF9kZWNyeXB0KHVpbnQ4X3QgKmFh
ZCwgdWludDE2X3QgYWFkX2xlbiwNCj4gIAkJCQljb25zdCB1aW50OF90ICpwYXlsb2FkLCB1aW50
MTZfdCBwYXlsb2FkX2xlbiwNCj4gLQkJCQlib29sIHN6bWljdCwNCj4gKwkJCQlib29sIGFzem1p
YywNCj4gIAkJCQl1aW50MTZfdCBzcmMsIHVpbnQxNl90IGRzdCwNCj4gLQkJCQl1aW50OF90IGtl
eV9haWQsIHVpbnQzMl90IHNlcV9udW0sDQo+ICsJCQkJdWludDhfdCBrZXlfYWlkLCB1aW50MzJf
dCBzZXEsDQo+ICAJCQkJdWludDMyX3QgaXZfaW5kZXgsIHVpbnQ4X3QgKm91dCwNCj4gIAkJCQlj
b25zdCB1aW50OF90IGFwcF9rZXlbMTZdKQ0KPiAgew0KPiAtCXVpbnQ4X3QgYXBwX25vbmNlWzEz
XSA9IHsgMHgwMSwgfTsNCj4gKwl1aW50OF90IG5vbmNlWzEzXTsNCj4gIAl1aW50MzJfdCBtaWMz
MjsNCj4gIAl1aW50NjRfdCBtaWM2NDsNCj4gIA0KPiBAQCAtODUyLDI3ICs3NjcsMTYgQEAgYm9v
bCBtZXNoX2NyeXB0b19wYXlsb2FkX2RlY3J5cHQodWludDhfdCAqYWFkLCB1aW50MTZfdCBhYWRf
bGVuLA0KPiAgCQlyZXR1cm4gZmFsc2U7DQo+ICANCj4gIAlpZiAoa2V5X2FpZCA9PSBBUFBfQUlE
X0RFVikNCj4gLQkJYXBwX25vbmNlWzBdID0gMHgwMjsNCj4gLQ0KPiAtCS8qIFNlcSBOdW0gKi8N
Cj4gLQlsX3B1dF9iZTMyKHNlcV9udW0sIGFwcF9ub25jZSArIDEpOw0KPiAtDQo+IC0JLyogQVNa
TUlDICovDQo+IC0JYXBwX25vbmNlWzFdIHw9IHN6bWljdCA/IDB4ODAgOiAweDAwOw0KPiAtDQo+
IC0JLyogU1JDICovDQo+IC0JbF9wdXRfYmUxNihzcmMsIGFwcF9ub25jZSArIDUpOw0KPiAtDQo+
IC0JLyogRFNUICovDQo+IC0JbF9wdXRfYmUxNihkc3QsIGFwcF9ub25jZSArIDcpOw0KPiAtDQo+
IC0JLyogSVYgSW5kZXggKi8NCj4gLQlsX3B1dF9iZTMyKGl2X2luZGV4LCBhcHBfbm9uY2UgKyA5
KTsNCj4gKwkJbWVzaF9jcnlwdG9fZGV2aWNlX25vbmNlKHNlcSwgc3JjLCBkc3QsIGl2X2luZGV4
LCBhc3ptaWMsDQo+ICsJCQkJCQkJCQlub25jZSk7DQo+ICsJZWxzZQ0KPiArCQltZXNoX2NyeXB0
b19hcHBsaWNhdGlvbl9ub25jZShzZXEsIHNyYywgZHN0LCBpdl9pbmRleCwgYXN6bWljLA0KPiAr
CQkJCQkJCQkJbm9uY2UpOw0KPiAgDQo+ICAJbWVtY3B5KG91dCwgcGF5bG9hZCwgcGF5bG9hZF9s
ZW4pOw0KPiAgDQo+IC0JaWYgKHN6bWljdCkgew0KPiAtCQlpZiAoIW1lc2hfY3J5cHRvX2Flc19j
Y21fZGVjcnlwdChhcHBfbm9uY2UsIGFwcF9rZXksDQo+ICsJaWYgKGFzem1pYykgew0KPiArCQlp
ZiAoIW1lc2hfY3J5cHRvX2Flc19jY21fZGVjcnlwdChub25jZSwgYXBwX2tleSwNCj4gIAkJCQkJ
YWFkLCBhYWRfbGVuLA0KPiAgCQkJCQlwYXlsb2FkLCBwYXlsb2FkX2xlbiwNCj4gIAkJCQkJb3V0
LCAmbWljNjQsIHNpemVvZihtaWM2NCkpKQ0KPiBAQCAtODg0LDcgKzc4OCw3IEBAIGJvb2wgbWVz
aF9jcnlwdG9fcGF5bG9hZF9kZWNyeXB0KHVpbnQ4X3QgKmFhZCwgdWludDE2X3QgYWFkX2xlbiwN
Cj4gIAkJaWYgKG1pYzY0KQ0KPiAgCQkJcmV0dXJuIGZhbHNlOw0KPiAgCX0gZWxzZSB7DQo+IC0J
CWlmICghbWVzaF9jcnlwdG9fYWVzX2NjbV9kZWNyeXB0KGFwcF9ub25jZSwgYXBwX2tleSwNCj4g
KwkJaWYgKCFtZXNoX2NyeXB0b19hZXNfY2NtX2RlY3J5cHQobm9uY2UsIGFwcF9rZXksDQo+ICAJ
CQkJCWFhZCwgYWFkX2xlbiwNCj4gIAkJCQkJcGF5bG9hZCwgcGF5bG9hZF9sZW4sDQo+ICAJCQkJ
CW91dCwgJm1pYzMyLCBzaXplb2YobWljMzIpKSkNCj4gQEAgLTkwMCwxNDYgKzgwNCwxMDcgQEAg
Ym9vbCBtZXNoX2NyeXB0b19wYXlsb2FkX2RlY3J5cHQodWludDhfdCAqYWFkLCB1aW50MTZfdCBh
YWRfbGVuLA0KPiAgCXJldHVybiB0cnVlOw0KPiAgfQ0KPiAgDQo+IC1ib29sIG1lc2hfY3J5cHRv
X3BhY2tldF9lbmNvZGUodWludDhfdCAqcGFja2V0LCB1aW50OF90IHBhY2tldF9sZW4sDQo+ICtz
dGF0aWMgYm9vbCBtZXNoX2NyeXB0b19wYWNrZXRfZW5jcnlwdCh1aW50OF90ICpwYWNrZXQsIHVp
bnQ4X3QgcGFja2V0X2xlbiwNCj4gIAkJCQljb25zdCB1aW50OF90IG5ldHdvcmtfa2V5WzE2XSwN
Cj4gLQkJCQl1aW50MzJfdCBpdl9pbmRleCwNCj4gLQkJCQljb25zdCB1aW50OF90IHByaXZhY3lf
a2V5WzE2XSkNCj4gKwkJCQl1aW50MzJfdCBpdl9pbmRleCwgYm9vbCBwcm94eSwNCj4gKwkJCQli
b29sIGN0bCwgdWludDhfdCB0dGwsIHVpbnQzMl90IHNlcSwNCj4gKwkJCQl1aW50MTZfdCBzcmMp
DQo+ICB7DQo+IC0JdWludDhfdCBuZXR3b3JrX25vbmNlWzEzXSA9IHsgMHgwMCwgMHgwMCB9Ow0K
PiAtCXVpbnQ4X3QgcHJpdmFjeV9jb3VudGVyWzE2XSA9IHsgMHgwMCwgMHgwMCwgMHgwMCwgMHgw
MCwgMHgwMCwgfTsNCj4gLQl1aW50OF90IHRtcFsxNl07DQo+IC0JaW50IGk7DQo+IC0NCj4gLQlp
ZiAocGFja2V0X2xlbiA8IDE0KQ0KPiAtCQlyZXR1cm4gZmFsc2U7DQo+ICsJdWludDhfdCBub25j
ZVsxM107DQo+ICANCj4gIAkvKiBEZXRlY3QgUHJveHkgcGFja2V0IGJ5IENUTCA9PSB0cnVlICYm
IERTVCA9PSAweDAwMDAgKi8NCj4gLQlpZiAoKHBhY2tldFsxXSAmIENUTCkgJiYgbF9nZXRfYmUx
NihwYWNrZXQgKyA3KSA9PSAwKQ0KPiAtCQluZXR3b3JrX25vbmNlWzBdID0gMHgwMzsgLyogUHJv
eHkgTm9uY2UgKi8NCj4gKwlpZiAoY3RsICYmIHByb3h5KQ0KPiArCQltZXNoX2NyeXB0b19wcm94
eV9ub25jZShzZXEsIHNyYywgaXZfaW5kZXgsIG5vbmNlKTsNCj4gIAllbHNlDQo+IC0JCS8qIENU
TCArIFRUTCAqLw0KPiAtCQluZXR3b3JrX25vbmNlWzFdID0gcGFja2V0WzFdOw0KPiAtDQo+IC0J
LyogU2VxIE51bSAqLw0KPiAtCW5ldHdvcmtfbm9uY2VbMl0gPSBwYWNrZXRbMl07DQo+IC0JbmV0
d29ya19ub25jZVszXSA9IHBhY2tldFszXTsNCj4gLQluZXR3b3JrX25vbmNlWzRdID0gcGFja2V0
WzRdOw0KPiAtDQo+IC0JLyogU1JDICovDQo+IC0JbmV0d29ya19ub25jZVs1XSA9IHBhY2tldFs1
XTsNCj4gLQluZXR3b3JrX25vbmNlWzZdID0gcGFja2V0WzZdOw0KPiAtDQo+IC0JLyogRFNUIG5v
dCBhdmFpbGFibGUgKi8NCj4gLQluZXR3b3JrX25vbmNlWzddID0gMDsNCj4gLQluZXR3b3JrX25v
bmNlWzhdID0gMDsNCj4gLQ0KPiAtCS8qIElWIEluZGV4ICovDQo+IC0JbF9wdXRfYmUzMihpdl9p
bmRleCwgbmV0d29ya19ub25jZSArIDkpOw0KPiArCQltZXNoX2NyeXB0b19uZXR3b3JrX25vbmNl
KGN0bCwgdHRsLCBzZXEsIHNyYywgaXZfaW5kZXgsIG5vbmNlKTsNCj4gIA0KPiAgCS8qIENoZWNr
IGZvciBMb25nIG5ldC1NSUMgKi8NCj4gLQlpZiAocGFja2V0WzFdICYgQ1RMKSB7DQo+IC0JCWlm
ICghbWVzaF9jcnlwdG9fYWVzX2NjbV9lbmNyeXB0KG5ldHdvcmtfbm9uY2UsIG5ldHdvcmtfa2V5
LA0KPiArCWlmIChjdGwpIHsNCj4gKwkJaWYgKCFtZXNoX2NyeXB0b19hZXNfY2NtX2VuY3J5cHQo
bm9uY2UsIG5ldHdvcmtfa2V5LA0KPiAgCQkJCQlOVUxMLCAwLA0KPiAgCQkJCQlwYWNrZXQgKyA3
LCBwYWNrZXRfbGVuIC0gNyAtIDgsDQo+ICAJCQkJCXBhY2tldCArIDcsIE5VTEwsIDgpKQ0KPiAg
CQkJcmV0dXJuIGZhbHNlOw0KPiAgCX0gZWxzZSB7DQo+IC0JCWlmICghbWVzaF9jcnlwdG9fYWVz
X2NjbV9lbmNyeXB0KG5ldHdvcmtfbm9uY2UsIG5ldHdvcmtfa2V5LA0KPiArCQlpZiAoIW1lc2hf
Y3J5cHRvX2Flc19jY21fZW5jcnlwdChub25jZSwgbmV0d29ya19rZXksDQo+ICAJCQkJCU5VTEws
IDAsDQo+ICAJCQkJCXBhY2tldCArIDcsIHBhY2tldF9sZW4gLSA3IC0gNCwNCj4gIAkJCQkJcGFj
a2V0ICsgNywgTlVMTCwgNCkpDQo+ICAJCQlyZXR1cm4gZmFsc2U7DQo+ICAJfQ0KPiAgDQo+IC0J
bF9wdXRfYmUzMihpdl9pbmRleCwgcHJpdmFjeV9jb3VudGVyICsgNSk7DQo+IC0JbWVtY3B5KHBy
aXZhY3lfY291bnRlciArIDksIHBhY2tldCArIDcsIDcpOw0KPiAtDQo+IC0JaWYgKCFhZXNfZWNi
X29uZShwcml2YWN5X2tleSwgcHJpdmFjeV9jb3VudGVyLCB0bXApKQ0KPiAtCQlyZXR1cm4gZmFs
c2U7DQo+IC0NCj4gLQlmb3IgKGkgPSAwOyBpIDwgNjsgaSsrKQ0KPiAtCQlwYWNrZXRbMSArIGld
IF49IHRtcFtpXTsNCj4gLQ0KPiAgCXJldHVybiB0cnVlOw0KPiAgfQ0KPiAgDQo+IC1ib29sIG1l
c2hfY3J5cHRvX3BhY2tldF9kZWNvZGUoY29uc3QgdWludDhfdCAqcGFja2V0LCB1aW50OF90IHBh
Y2tldF9sZW4sDQo+IC0JCQkJYm9vbCBwcm94eSwgdWludDhfdCAqb3V0LCB1aW50MzJfdCBpdl9p
bmRleCwNCj4gK2Jvb2wgbWVzaF9jcnlwdG9fcGFja2V0X2VuY29kZSh1aW50OF90ICpwYWNrZXQs
IHVpbnQ4X3QgcGFja2V0X2xlbiwNCj4gKwkJCQl1aW50MzJfdCBpdl9pbmRleCwNCj4gIAkJCQlj
b25zdCB1aW50OF90IG5ldHdvcmtfa2V5WzE2XSwNCj4gIAkJCQljb25zdCB1aW50OF90IHByaXZh
Y3lfa2V5WzE2XSkNCj4gIHsNCj4gLQl1aW50OF90IHByaXZhY3lfY291bnRlclsxNl0gPSB7IDB4
MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIH07DQo+IC0JdWludDhfdCBuZXR3b3JrX25vbmNl
WzEzXSA9IHsgMHgwMCwgMHgwMCwgfTsNCj4gLQl1aW50OF90IHRtcFsxNl07DQo+ICsJYm9vbCBj
dGw7DQo+ICsJdWludDhfdCB0dGw7DQo+ICsJdWludDMyX3Qgc2VxOw0KPiAgCXVpbnQxNl90IHNy
YzsNCj4gLQlpbnQgaTsNCj4gKwl1aW50MTZfdCBkc3Q7DQo+ICANCj4gLQlpZiAocGFja2V0X2xl
biA8IDE0KQ0KPiArCWlmICghbmV0d29ya19oZWFkZXJfcGFyc2UocGFja2V0LCBwYWNrZXRfbGVu
LA0KPiArCQkJCQkJJmN0bCwgJnR0bCwgJnNlcSwgJnNyYywgJmRzdCkpDQo+ICAJCXJldHVybiBm
YWxzZTsNCj4gIA0KPiAtCWxfcHV0X2JlMzIoaXZfaW5kZXgsIHByaXZhY3lfY291bnRlciArIDUp
Ow0KPiAtCW1lbWNweShwcml2YWN5X2NvdW50ZXIgKyA5LCBwYWNrZXQgKyA3LCA3KTsNCj4gKwlp
ZiAoIW1lc2hfY3J5cHRvX3BhY2tldF9lbmNyeXB0KHBhY2tldCwgcGFja2V0X2xlbiwgbmV0d29y
a19rZXksDQo+ICsJCQkJCQkJaXZfaW5kZXgsICFkc3QsDQo+ICsJCQkJCQkJY3RsLCB0dGwsIHNl
cSwgc3JjKSkNCj4gIA0KPiAtCWlmICghYWVzX2VjYl9vbmUocHJpdmFjeV9rZXksIHByaXZhY3lf
Y291bnRlciwgdG1wKSkNCj4gIAkJcmV0dXJuIGZhbHNlOw0KPiAgDQo+IC0JbWVtY3B5KG91dCwg
cGFja2V0LCBwYWNrZXRfbGVuKTsNCj4gLQlmb3IgKGkgPSAwOyBpIDwgNjsgaSsrKQ0KPiAtCQlv
dXRbMSArIGldIF49IHRtcFtpXTsNCj4gKwlyZXR1cm4gbWVzaF9jcnlwdG9fbmV0d29ya19vYmZ1
c2NhdGUocGFja2V0LCBwcml2YWN5X2tleSwgaXZfaW5kZXgsDQo+ICsJCQkJCQkJY3RsLCB0dGws
IHNlcSwgc3JjKTsNCj4gK30NCj4gIA0KPiAtCXNyYyA9IGxfZ2V0X2JlMTYob3V0ICsgNSk7DQo+
ICtzdGF0aWMgYm9vbCBtZXNoX2NyeXB0b19wYWNrZXRfZGVjcnlwdCh1aW50OF90ICpwYWNrZXQs
IHVpbnQ4X3QgcGFja2V0X2xlbiwNCj4gKwkJCQljb25zdCB1aW50OF90IG5ldHdvcmtfa2V5WzE2
XSwNCj4gKwkJCQl1aW50MzJfdCBpdl9pbmRleCwgYm9vbCBwcm94eSwNCj4gKwkJCQlib29sIGN0
bCwgdWludDhfdCB0dGwsIHVpbnQzMl90IHNlcSwNCj4gKwkJCQl1aW50MTZfdCBzcmMpDQo+ICt7
DQo+ICsJdWludDhfdCBub25jZVsxM107DQo+ICANCj4gIAkvKiBQcmUtY2hlY2sgU1JDIGFkZHJl
c3MgZm9yIGlsbGVnYWwgdmFsdWVzICovDQo+IC0JaWYgKCFzcmMgfHwgc3JjID49IDB4ODAwMCkN
Cj4gKwlpZiAoIUlTX1VOSUNBU1Qoc3JjKSkNCj4gIAkJcmV0dXJuIGZhbHNlOw0KPiAgDQo+ICAJ
LyogRGV0ZWN0IFByb3h5IHBhY2tldCBieSBDVEwgPT0gdHJ1ZSAmJiBwcm94eSA9PSB0cnVlICov
DQo+IC0JaWYgKChvdXRbMV0gJiBDVEwpICYmIHByb3h5KQ0KPiAtCQluZXR3b3JrX25vbmNlWzBd
ID0gMHgwMzsgLyogUHJveHkgTm9uY2UgKi8NCj4gKwlpZiAoY3RsICYgcHJveHkpDQo+ICsJCW1l
c2hfY3J5cHRvX3Byb3h5X25vbmNlKHNlcSwgc3JjLCBpdl9pbmRleCwgbm9uY2UpOw0KPiAgCWVs
c2UNCj4gLQkJLyogQ1RMICsgVFRMICovDQo+IC0JCW5ldHdvcmtfbm9uY2VbMV0gPSBvdXRbMV07
DQo+IC0NCj4gLQkvKiBTZXEgTnVtICovDQo+IC0JbmV0d29ya19ub25jZVsyXSA9IG91dFsyXTsN
Cj4gLQluZXR3b3JrX25vbmNlWzNdID0gb3V0WzNdOw0KPiAtCW5ldHdvcmtfbm9uY2VbNF0gPSBv
dXRbNF07DQo+IC0NCj4gLQkvKiBTUkMgKi8NCj4gLQluZXR3b3JrX25vbmNlWzVdID0gb3V0WzVd
Ow0KPiAtCW5ldHdvcmtfbm9uY2VbNl0gPSBvdXRbNl07DQo+IC0NCj4gLQkvKiBEU1Qgbm90IGF2
YWlsYWJsZSAqLw0KPiAtCW5ldHdvcmtfbm9uY2VbN10gPSAwOw0KPiAtCW5ldHdvcmtfbm9uY2Vb
OF0gPSAwOw0KPiAtDQo+IC0JLyogSVYgSW5kZXggKi8NCj4gLQlsX3B1dF9iZTMyKGl2X2luZGV4
LCBuZXR3b3JrX25vbmNlICsgOSk7DQo+ICsJCW1lc2hfY3J5cHRvX25ldHdvcmtfbm9uY2UoY3Rs
LCB0dGwsIHNlcSwgc3JjLCBpdl9pbmRleCwgbm9uY2UpOw0KPiAgDQo+ICAJLyogQ2hlY2sgZm9y
IExvbmcgTUlDICovDQo+IC0JaWYgKG91dFsxXSAmIENUTCkgew0KPiArCWlmIChjdGwpIHsNCj4g
IAkJdWludDY0X3QgbWljOw0KPiAgDQo+IC0JCWlmICghbWVzaF9jcnlwdG9fYWVzX2NjbV9kZWNy
eXB0KG5ldHdvcmtfbm9uY2UsIG5ldHdvcmtfa2V5LA0KPiAtCQkJCQlOVUxMLCAwLCBwYWNrZXQg
KyA3LCBwYWNrZXRfbGVuIC0gNywNCj4gLQkJCQkJb3V0ICsgNywgJm1pYywgc2l6ZW9mKG1pYykp
KQ0KPiArCQlpZiAoIW1lc2hfY3J5cHRvX2Flc19jY21fZGVjcnlwdChub25jZSwgbmV0d29ya19r
ZXksDQo+ICsJCQkJCU5VTEwsIDAsDQo+ICsJCQkJCXBhY2tldCArIDcsIHBhY2tldF9sZW4gLSA3
LA0KPiArCQkJCQlwYWNrZXQgKyA3LCAmbWljLCBzaXplb2YobWljKSkpDQo+ICAJCQlyZXR1cm4g
ZmFsc2U7DQo+ICANCj4gLQkJbWljIF49IGxfZ2V0X2JlNjQob3V0ICsgcGFja2V0X2xlbiAtIDgp
Ow0KPiAtCQlsX3B1dF9iZTY0KG1pYywgb3V0ICsgcGFja2V0X2xlbiAtIDgpOw0KPiArCQltaWMg
Xj0gbF9nZXRfYmU2NChwYWNrZXQgKyBwYWNrZXRfbGVuIC0gOCk7DQo+ICsJCWxfcHV0X2JlNjQo
bWljLCBwYWNrZXQgKyBwYWNrZXRfbGVuIC0gOCk7DQo+ICANCj4gIAkJaWYgKG1pYykNCj4gIAkJ
CXJldHVybiBmYWxzZTsNCj4gIAl9IGVsc2Ugew0KPiAgCQl1aW50MzJfdCBtaWM7DQo+ICANCj4g
LQkJaWYgKCFtZXNoX2NyeXB0b19hZXNfY2NtX2RlY3J5cHQobmV0d29ya19ub25jZSwgbmV0d29y
a19rZXksDQo+IC0JCQkJCU5VTEwsIDAsIHBhY2tldCArIDcsIHBhY2tldF9sZW4gLSA3LA0KPiAt
CQkJCQlvdXQgKyA3LCAmbWljLCBzaXplb2YobWljKSkpDQo+ICsJCWlmICghbWVzaF9jcnlwdG9f
YWVzX2NjbV9kZWNyeXB0KG5vbmNlLCBuZXR3b3JrX2tleSwNCj4gKwkJCQkJTlVMTCwgMCwNCj4g
KwkJCQkJcGFja2V0ICsgNywgcGFja2V0X2xlbiAtIDcsDQo+ICsJCQkJCXBhY2tldCArIDcsICZt
aWMsIHNpemVvZihtaWMpKSkNCj4gIAkJCXJldHVybiBmYWxzZTsNCj4gIA0KPiAtCQltaWMgXj0g
bF9nZXRfYmUzMihvdXQgKyBwYWNrZXRfbGVuIC0gNCk7DQo+IC0JCWxfcHV0X2JlMzIobWljLCBv
dXQgKyBwYWNrZXRfbGVuIC0gNCk7DQo+ICsJCW1pYyBePSBsX2dldF9iZTMyKHBhY2tldCArIHBh
Y2tldF9sZW4gLSA0KTsNCj4gKwkJbF9wdXRfYmUzMihtaWMsIHBhY2tldCArIHBhY2tldF9sZW4g
LSA0KTsNCj4gIA0KPiAgCQlpZiAobWljKQ0KPiAgCQkJcmV0dXJuIGZhbHNlOw0KPiBAQCAtMTA0
OCw2ICs5MTMsMzAgQEAgYm9vbCBtZXNoX2NyeXB0b19wYWNrZXRfZGVjb2RlKGNvbnN0IHVpbnQ4
X3QgKnBhY2tldCwgdWludDhfdCBwYWNrZXRfbGVuLA0KPiAgCXJldHVybiB0cnVlOw0KPiAgfQ0K
PiAgDQo+ICtib29sIG1lc2hfY3J5cHRvX3BhY2tldF9kZWNvZGUoY29uc3QgdWludDhfdCAqcGFj
a2V0LCB1aW50OF90IHBhY2tldF9sZW4sDQo+ICsJCQkJYm9vbCBwcm94eSwgdWludDhfdCAqb3V0
LCB1aW50MzJfdCBpdl9pbmRleCwNCj4gKwkJCQljb25zdCB1aW50OF90IG5ldHdvcmtfa2V5WzE2
XSwNCj4gKwkJCQljb25zdCB1aW50OF90IHByaXZhY3lfa2V5WzE2XSkNCj4gK3sNCj4gKwlib29s
IGN0bDsNCj4gKwl1aW50OF90IHR0bDsNCj4gKwl1aW50MzJfdCBzZXE7DQo+ICsJdWludDE2X3Qg
c3JjOw0KPiArDQo+ICsJaWYgKHBhY2tldF9sZW4gPCAxNCkNCj4gKwkJcmV0dXJuIGZhbHNlOw0K
PiArDQo+ICsJbWVtY3B5KG91dCwgcGFja2V0LCBwYWNrZXRfbGVuKTsNCj4gKw0KPiArCWlmICgh
bWVzaF9jcnlwdG9fbmV0d29ya19jbGFyaWZ5KG91dCwgcHJpdmFjeV9rZXksIGl2X2luZGV4LA0K
PiArCQkJCQkJJmN0bCwgJnR0bCwgJnNlcSwgJnNyYykpDQo+ICsJCXJldHVybiBmYWxzZTsNCj4g
Kw0KPiArCXJldHVybiBtZXNoX2NyeXB0b19wYWNrZXRfZGVjcnlwdChvdXQsIHBhY2tldF9sZW4s
IG5ldHdvcmtfa2V5LA0KPiArCQkJCQkJCWl2X2luZGV4LCBwcm94eSwNCj4gKwkJCQkJCQljdGws
IHR0bCwgc2VxLCBzcmMpOw0KPiArfQ0KPiArDQo+ICBib29sIG1lc2hfY3J5cHRvX3BhY2tldF9s
YWJlbCh1aW50OF90ICpwYWNrZXQsIHVpbnQ4X3QgcGFja2V0X2xlbiwNCj4gIAkJCQl1aW50MTZf
dCBpdl9pbmRleCwgdWludDhfdCBuZXR3b3JrX2lkKQ0KPiAgew0KPiBkaWZmIC0tZ2l0IGEvbWVz
aC9jcnlwdG8uaCBiL21lc2gvY3J5cHRvLmgNCj4gaW5kZXggZTVjZTg0MGI0Li43ZDNmODljZGUg
MTAwNjQ0DQo+IC0tLSBhL21lc2gvY3J5cHRvLmgNCj4gKysrIGIvbWVzaC9jcnlwdG8uaA0KPiBA
QCAtMTksNiArMTksNyBAQA0KPiAgDQo+ICAjaW5jbHVkZSA8c3RkYm9vbC5oPg0KPiAgI2luY2x1
ZGUgPHN0ZGludC5oPg0KPiArI2luY2x1ZGUgPHN0ZGxpYi5oPg0KPiAgDQo+ICBib29sIG1lc2hf
Y3J5cHRvX2Flc19jY21fZW5jcnlwdChjb25zdCB1aW50OF90IG5vbmNlWzEzXSwgY29uc3QgdWlu
dDhfdCBrZXlbMTZdLA0KPiAgCQkJCQljb25zdCB1aW50OF90ICphYWQsIHVpbnQxNl90IGFhZF9s
ZW4sDQo+IEBAIC00MSw0MCArNDIsNiBAQCBib29sIG1lc2hfY3J5cHRvX2JlYWNvbl9jbWFjKGNv
bnN0IHVpbnQ4X3QgZW5jcnlwdGlvbl9rZXlbMTZdLA0KPiAgCQkJCWNvbnN0IHVpbnQ4X3QgbmV0
d29ya19pZFsxNl0sDQo+ICAJCQkJdWludDMyX3QgaXZfaW5kZXgsIGJvb2wga3IsDQo+ICAJCQkJ
Ym9vbCBpdSwgdWludDY0X3QgKmNtYWMpOw0KPiAtYm9vbCBtZXNoX2NyeXB0b19uZXR3b3JrX25v
bmNlKGJvb2wgZnJuZCwgdWludDhfdCB0dGwsIHVpbnQzMl90IHNlcSwNCj4gLQkJCQl1aW50MTZf
dCBzcmMsIHVpbnQzMl90IGl2X2luZGV4LA0KPiAtCQkJCXVpbnQ4X3Qgbm9uY2VbMTNdKTsNCj4g
LWJvb2wgbWVzaF9jcnlwdG9fbmV0d29ya19lbmNyeXB0KGJvb2wgY3RsLCB1aW50OF90IHR0bCwN
Cj4gLQkJCQl1aW50MzJfdCBzZXEsIHVpbnQxNl90IHNyYywNCj4gLQkJCQl1aW50MzJfdCBpdl9p
bmRleCwNCj4gLQkJCQljb25zdCB1aW50OF90IG5ldF9rZXlbMTZdLA0KPiAtCQkJCWNvbnN0IHVp
bnQ4X3QgKmVuY19tc2csIHVpbnQ4X3QgZW5jX21zZ19sZW4sDQo+IC0JCQkJdWludDhfdCAqb3V0
LCB2b2lkICpuZXRfbWljKTsNCj4gLWJvb2wgbWVzaF9jcnlwdG9fbmV0d29ya19kZWNyeXB0KGJv
b2wgZnJuZCwgdWludDhfdCB0dGwsDQo+IC0JCQkJdWludDMyX3Qgc2VxLCB1aW50MTZfdCBzcmMs
DQo+IC0JCQkJdWludDMyX3QgaXZfaW5kZXgsDQo+IC0JCQkJY29uc3QgdWludDhfdCBuZXRfa2V5
WzE2XSwNCj4gLQkJCQljb25zdCB1aW50OF90ICplbmNfbXNnLCB1aW50OF90IGVuY19tc2dfbGVu
LA0KPiAtCQkJCXVpbnQ4X3QgKm91dCwgdm9pZCAqbmV0X21pYywgc2l6ZV90IG1pY19zaXplKTsN
Cj4gLWJvb2wgbWVzaF9jcnlwdG9fYXBwbGljYXRpb25fbm9uY2UodWludDMyX3Qgc2VxLCB1aW50
MTZfdCBzcmMsDQo+IC0JCQkJdWludDE2X3QgZHN0LCB1aW50MzJfdCBpdl9pbmRleCwNCj4gLQkJ
CQlib29sIGFzem1pYywgdWludDhfdCBub25jZVsxM10pOw0KPiAtYm9vbCBtZXNoX2NyeXB0b19k
ZXZpY2Vfbm9uY2UodWludDMyX3Qgc2VxLCB1aW50MTZfdCBzcmMsDQo+IC0JCQkJdWludDE2X3Qg
ZHN0LCB1aW50MzJfdCBpdl9pbmRleCwNCj4gLQkJCQlib29sIGFzem1pYywgdWludDhfdCBub25j
ZVsxM10pOw0KPiAtYm9vbCBtZXNoX2NyeXB0b19hcHBsaWNhdGlvbl9lbmNyeXB0KHVpbnQ4X3Qg
YWtmLCB1aW50MzJfdCBzZXEsIHVpbnQxNl90IHNyYywNCj4gLQkJCQkJdWludDE2X3QgZHN0LCB1
aW50MzJfdCBpdl9pbmRleCwNCj4gLQkJCQkJY29uc3QgdWludDhfdCBhcHBfa2V5WzE2XSwNCj4g
LQkJCQkJY29uc3QgdWludDhfdCAqYWFkLCB1aW50OF90IGFhZF9sZW4sDQo+IC0JCQkJCWNvbnN0
IHVpbnQ4X3QgKm1zZywgdWludDhfdCBtc2dfbGVuLA0KPiAtCQkJCQl1aW50OF90ICpvdXQsDQo+
IC0JCQkJCXZvaWQgKmFwcF9taWMsIHNpemVfdCBtaWNfc2l6ZSk7DQo+IC1ib29sIG1lc2hfY3J5
cHRvX2FwcGxpY2F0aW9uX2RlY3J5cHQodWludDhfdCBha2YsIHVpbnQzMl90IHNlcSwgdWludDE2
X3Qgc3JjLA0KPiAtCQkJCXVpbnQxNl90IGRzdCwgdWludDMyX3QgaXZfaW5kZXgsDQo+IC0JCQkJ
Y29uc3QgdWludDhfdCBhcHBfa2V5WzE2XSwNCj4gLQkJCQljb25zdCB1aW50OF90ICphYWQsIHVp
bnQ4X3QgYWFkX2xlbiwNCj4gLQkJCQljb25zdCB1aW50OF90ICplbmNfbXNnLCB1aW50OF90IGVu
Y19tc2dfbGVuLA0KPiAtCQkJCXVpbnQ4X3QgKm91dCwgdm9pZCAqYXBwX21pYywgc2l6ZV90IG1p
Y19zaXplKTsNCj4gIGJvb2wgbWVzaF9jcnlwdG9fZGV2aWNlX2tleShjb25zdCB1aW50OF90IHNl
Y3JldFszMl0sDQo+ICAJCQkJCQljb25zdCB1aW50OF90IHNhbHRbMTZdLA0KPiAgCQkJCQkJdWlu
dDhfdCBkZXZpY2Vfa2V5WzE2XSk7DQo+IEBAIC0xMDIsMTkgKzY5LDYgQEAgYm9vbCBtZXNoX2Ny
eXB0b19wcm92X2NvbmZfa2V5KGNvbnN0IHVpbnQ4X3Qgc2VjcmV0WzMyXSwNCj4gIGJvb2wgbWVz
aF9jcnlwdG9fc2Vzc2lvbl9rZXkoY29uc3QgdWludDhfdCBzZWNyZXRbMzJdLA0KPiAgCQkJCQlj
b25zdCB1aW50OF90IHNhbHRbMTZdLA0KPiAgCQkJCQl1aW50OF90IHNlc3Npb25fa2V5WzE2XSk7
DQo+IC1ib29sIG1lc2hfY3J5cHRvX3ByaXZhY3lfY291bnRlcih1aW50MzJfdCBpdl9pbmRleCwN
Cj4gLQkJCQkJCWNvbnN0IHVpbnQ4X3QgKnBheWxvYWQsDQo+IC0JCQkJCQl1aW50OF90IHByaXZh
Y3lfY291bnRlclsxNl0pOw0KPiAtYm9vbCBtZXNoX2NyeXB0b19uZXR3b3JrX29iZnVzY2F0ZShj
b25zdCB1aW50OF90IHByaXZhY3lfa2V5WzE2XSwNCj4gLQkJCQkJY29uc3QgdWludDhfdCBwcml2
YWN5X2NvdW50ZXJbMTZdLA0KPiAtCQkJCQlib29sIGN0bCwgdWludDhfdCB0dGwsIHVpbnQzMl90
IHNlcSwNCj4gLQkJCQkJdWludDE2X3Qgc3JjLCB1aW50OF90ICpvdXQpOw0KPiAtYm9vbCBtZXNo
X2NyeXB0b19uZXR3b3JrX2NsYXJpZnkoY29uc3QgdWludDhfdCBwcml2YWN5X2tleVsxNl0sDQo+
IC0JCQkJY29uc3QgdWludDhfdCBwcml2YWN5X2NvdW50ZXJbMTZdLA0KPiAtCQkJCWNvbnN0IHVp
bnQ4X3QgbmV0X2hkcls2XSwNCj4gLQkJCQlib29sICpjdGwsIHVpbnQ4X3QgKnR0bCwNCj4gLQkJ
CQl1aW50MzJfdCAqc2VxLCB1aW50MTZfdCAqc3JjKTsNCj4gLQ0KPiAgYm9vbCBtZXNoX2NyeXB0
b19wYWNrZXRfYnVpbGQoYm9vbCBjdGwsIHVpbnQ4X3QgdHRsLA0KPiAgCQkJCXVpbnQzMl90IHNl
cSwNCj4gIAkJCQl1aW50MTZfdCBzcmMsIHVpbnQxNl90IGRzdCwNCj4gQEAgLTE0Niw4ICsxMDAs
OCBAQCBib29sIG1lc2hfY3J5cHRvX3BheWxvYWRfZGVjcnlwdCh1aW50OF90ICphYWQsIHVpbnQx
Nl90IGFhZF9sZW4sDQo+ICAJCQkJdWludDhfdCAqb3V0LA0KPiAgCQkJCWNvbnN0IHVpbnQ4X3Qg
YXBwbGljYXRpb25fa2V5WzE2XSk7DQo+ICBib29sIG1lc2hfY3J5cHRvX3BhY2tldF9lbmNvZGUo
dWludDhfdCAqcGFja2V0LCB1aW50OF90IHBhY2tldF9sZW4sDQo+IC0JCQkJY29uc3QgdWludDhf
dCBuZXR3b3JrX2tleVsxNl0sDQo+ICAJCQkJdWludDMyX3QgaXZfaW5kZXgsDQo+ICsJCQkJY29u
c3QgdWludDhfdCBuZXR3b3JrX2tleVsxNl0sDQo+ICAJCQkJY29uc3QgdWludDhfdCBwcml2YWN5
X2tleVsxNl0pOw0KPiAgYm9vbCBtZXNoX2NyeXB0b19wYWNrZXRfZGVjb2RlKGNvbnN0IHVpbnQ4
X3QgKnBhY2tldCwgdWludDhfdCBwYWNrZXRfbGVuLA0KPiAgCQkJCWJvb2wgcHJveHksIHVpbnQ4
X3QgKm91dCwgdWludDMyX3QgaXZfaW5kZXgsDQo+IGRpZmYgLS1naXQgYS9tZXNoL25ldC1rZXlz
LmMgYi9tZXNoL25ldC1rZXlzLmMNCj4gaW5kZXggNjgzYTkyNGM0Li5mN2ViMmNhNjggMTAwNjQ0
DQo+IC0tLSBhL21lc2gvbmV0LWtleXMuYw0KPiArKysgYi9tZXNoL25ldC1rZXlzLmMNCj4gQEAg
LTI2Myw3ICsyNjMsNyBAQCBib29sIG5ldF9rZXlfZW5jcnlwdCh1aW50MzJfdCBpZCwgdWludDMy
X3QgaXZfaW5kZXgsIHVpbnQ4X3QgKnBrdCwgc2l6ZV90IGxlbikNCj4gIAlpZiAoIWtleSkNCj4g
IAkJcmV0dXJuIGZhbHNlOw0KPiAgDQo+IC0JcmVzdWx0ID0gbWVzaF9jcnlwdG9fcGFja2V0X2Vu
Y29kZShwa3QsIGxlbiwga2V5LT5lbmNyeXB0LCBpdl9pbmRleCwNCj4gKwlyZXN1bHQgPSBtZXNo
X2NyeXB0b19wYWNrZXRfZW5jb2RlKHBrdCwgbGVuLCBpdl9pbmRleCwga2V5LT5lbmNyeXB0LA0K
PiAgCQkJCQkJCWtleS0+cHJpdmFjeSk7DQo+ICANCj4gIAlpZiAoIXJlc3VsdCkNCj4gZGlmZiAt
LWdpdCBhL3VuaXQvdGVzdC1tZXNoLWNyeXB0by5jIGIvdW5pdC90ZXN0LW1lc2gtY3J5cHRvLmMN
Cj4gaW5kZXggMDA0M2IwYjEwLi4zZWNiM2QwMjYgMTAwNjQ0DQo+IC0tLSBhL3VuaXQvdGVzdC1t
ZXNoLWNyeXB0by5jDQo+ICsrKyBiL3VuaXQvdGVzdC1tZXNoLWNyeXB0by5jDQo+IEBAIC03ODAs
OCArNzgwLDggQEAgc3RhdGljIHZvaWQgY2hlY2tfZW5jcnlwdF9zZWdtZW50KGNvbnN0IHN0cnVj
dCBtZXNoX2NyeXB0b190ZXN0ICprZXlzLA0KPiAgCXVpbnQ4X3QgcHJpdl9yYW5kWzE2XTsNCj4g
IAl1aW50OF90IHBhY2tldFsyOV07DQo+ICAJdWludDhfdCBwYWNrZXRfbGVuOw0KPiAtCXVpbnQ2
NF90IG5ldF9taWM2NDsNCj4gLQl1aW50MzJfdCBoZHIsIG5ldF9taWMzMjsNCj4gKwl1aW50MzJf
dCBoZHI7DQo+ICsJdWludDY0X3QgbmV0X21pYzY0LCBuZXRfbWljMzI7DQo+ICAJc2l6ZV90IG5l
dF9tc2dfbGVuOw0KPiAgCXVpbnQ4X3Qga2V5X2FpZCA9IGtleXMtPmtleV9haWQgfCAoa2V5cy0+
YWtmID8gS0VZX0lEX0FLRiA6IDB4MDApOw0KPiAgDQo+IEBAIC04NTcsMTMgKzg1NywxMiBAQCBz
dGF0aWMgdm9pZCBjaGVja19lbmNyeXB0X3NlZ21lbnQoY29uc3Qgc3RydWN0IG1lc2hfY3J5cHRv
X3Rlc3QgKmtleXMsDQo+ICAJbmV0X21zZ19sZW4gPSBsZW4gKyAyOw0KPiAgCXNob3dfZGF0YSgi
VHJhbnNwb3J0UGF5bG9hZCIsIDcsIHBhY2tldCArIDcsIG5ldF9tc2dfbGVuKTsNCj4gIA0KPiAt
CW1lc2hfY3J5cHRvX25ldHdvcmtfZW5jcnlwdChrZXlzLT5jdGwsDQo+IC0JCQlrZXlzLT5uZXRf
dHRsLCBrZXlzLT5uZXRfc2VxWzBdLA0KPiAtCQkJa2V5cy0+bmV0X3NyYywNCj4gLQkJCWtleXMt
Pml2X2luZGV4LCBlbmNfa2V5LA0KPiAtCQkJcGFja2V0ICsgNywgbGVuICsgMiwgcGFja2V0ICsg
NywNCj4gLQkJCWtleXMtPmN0bCA/ICh2b2lkICopJm5ldF9taWM2NCA6DQo+IC0JCQkodm9pZCAq
KSZuZXRfbWljMzIpOw0KPiArCW1lc2hfY3J5cHRvX3BhY2tldF9lbmNyeXB0KHBhY2tldCwgcGFj
a2V0X2xlbiwNCj4gKwkJCQkJCWVuY19rZXksDQo+ICsJCQkJCQlrZXlzLT5pdl9pbmRleCwgZmFs
c2UsDQo+ICsJCQkJCQlrZXlzLT5jdGwsIGtleXMtPm5ldF90dGwsDQo+ICsJCQkJCQlrZXlzLT5u
ZXRfc2VxWzBdLA0KPiArCQkJCQkJa2V5cy0+bmV0X3NyYyk7DQo+ICANCj4gIAltZXNoX2NyeXB0
b19wcml2YWN5X2NvdW50ZXIoa2V5cy0+aXZfaW5kZXgsIHBhY2tldCArIDcsIHByaXZfcmFuZCk7
DQo+ICANCj4gQEAgLTg4MywyMCArODgyLDIyIEBAIHN0YXRpYyB2b2lkIGNoZWNrX2VuY3J5cHRf
c2VnbWVudChjb25zdCBzdHJ1Y3QgbWVzaF9jcnlwdG9fdGVzdCAqa2V5cywNCj4gIAl2ZXJpZnlf
ZGF0YSgiRW5jTmV0d29ya1BheWxvYWQiLCA3LCBrZXlzLT5uZXRfbXNnWzBdLA0KPiAgCQkJcGFj
a2V0ICsgNywgbmV0X21zZ19sZW4pOw0KPiAgCWlmIChrZXlzLT5jdGwpIHsNCj4gKwkJbmV0X21p
YzY0ID0gbF9nZXRfYmU2NChwYWNrZXQgKyA3ICsgbmV0X21zZ19sZW4pOw0KPiAgCQl2ZXJpZnlf
dWludDY0KCJOZXR3b3JrTUlDIiwgNyArIG5ldF9tc2dfbGVuLA0KPiAtCQkJCWtleXMtPm5ldF9t
aWM2NCwgbmV0X21pYzY0KTsNCj4gKwkJCQkJCWtleXMtPm5ldF9taWM2NCwgbmV0X21pYzY0KTsN
Cj4gIAkJbmV0X21zZ19sZW4gKz0gODsNCj4gIAl9IGVsc2Ugew0KPiArCQluZXRfbWljMzIgPSBs
X2dldF9iZTMyKHBhY2tldCArIDcgKyBuZXRfbXNnX2xlbik7DQo+ICAJCXZlcmlmeV91aW50MzIo
Ik5ldHdvcmtNSUMiLCA3ICsgbmV0X21zZ19sZW4sDQo+IC0JCQkJa2V5cy0+bmV0X21pYzMyWzBd
LCBuZXRfbWljMzIpOw0KPiArCQkJCQkJa2V5cy0+bmV0X21pYzMyWzBdLCBuZXRfbWljMzIpOw0K
PiAgCQluZXRfbXNnX2xlbiArPSA0Ow0KPiAgCX0NCj4gIA0KPiAgCXNob3dfZGF0YSgiUHJlT2Jz
UGF5bG9hZCIsIDEsIHBhY2tldCArIDEsIDYgKyBuZXRfbXNnX2xlbik7DQo+IC0JbWVzaF9jcnlw
dG9fbmV0d29ya19vYmZ1c2NhdGUocHJpdl9rZXksIHByaXZfcmFuZCwNCj4gLQkJCWtleXMtPmN0
bCwNCj4gLQkJCWtleXMtPm5ldF90dGwsIGtleXMtPm5ldF9zZXFbMF0sDQo+IC0JCQlrZXlzLT5u
ZXRfc3JjLCBwYWNrZXQgKyAxKTsNCj4gKwltZXNoX2NyeXB0b19uZXR3b3JrX29iZnVzY2F0ZShw
YWNrZXQsIHByaXZfa2V5LA0KPiArCQkJCQlrZXlzLT5pdl9pbmRleCwNCj4gKwkJCQkJa2V5cy0+
Y3RsLCBrZXlzLT5uZXRfdHRsLA0KPiArCQkJCQlrZXlzLT5uZXRfc2VxWzBdLCBrZXlzLT5uZXRf
c3JjKTsNCj4gIAlzaG93X2RhdGEoIlBvc3RPYnNQYXlsb2FkIiwgMSwgcGFja2V0ICsgMSwgNiAr
IG5ldF9tc2dfbGVuKTsNCj4gIA0KPiAgCXBhY2tldFswXSA9IChrZXlzLT5pdl9pbmRleCAmIDB4
MDEpIDw8IDcgfCBuaWQ7DQo+IEBAIC0xMDE5LDI1ICsxMDIwLDIzIEBAIHN0YXRpYyB2b2lkIGNo
ZWNrX2VuY3J5cHQoY29uc3Qgc3RydWN0IG1lc2hfY3J5cHRvX3Rlc3QgKmtleXMpDQo+ICAJCWlm
IChrZXlzLT5zem1pYykgew0KPiAgCQkJc2VnX21heCA9IFNFR19NQVgoa2V5cy0+c2VnbWVudGVk
LCBhcHBfbXNnX2xlbiArIDgpOw0KPiAgCQkJZW5jX21zZyA9IGxfbWFsbG9jKGFwcF9tc2dfbGVu
ICsgOCk7DQo+IC0JCQltZXNoX2NyeXB0b19hcHBsaWNhdGlvbl9lbmNyeXB0KGtleV9haWQsIGtl
eXMtPmFwcF9zZXEsDQo+IC0JCQkJCWtleXMtPm5ldF9zcmMsIGtleXMtPm5ldF9kc3QsDQo+IC0J
CQkJCWtleXMtPml2X2luZGV4LA0KPiAtCQkJCQlrZXlzLT5ha2YgPyBhcHBfa2V5IDogZGV2X2tl
eSwNCj4gLQkJCQkJYWFkLCBhYWRfbGVuLA0KPiAtCQkJCQlhcHBfbXNnLCBhcHBfbXNnX2xlbiwN
Cj4gLQkJCQkJZW5jX21zZywgJmFwcF9taWM2NCwgc2l6ZW9mKGFwcF9taWM2NCkpOw0KPiAtCQkJ
bF9wdXRfYmU2NChhcHBfbWljNjQsIGVuY19tc2cgKyBhcHBfbXNnX2xlbik7DQo+ICsNCj4gKwkJ
CW1lc2hfY3J5cHRvX3BheWxvYWRfZW5jcnlwdChhYWQsIGFwcF9tc2csDQo+ICsJCQkJCWVuY19t
c2csIGFwcF9tc2dfbGVuLA0KPiArCQkJCQlrZXlzLT5uZXRfc3JjLCBrZXlzLT5uZXRfZHN0LCBr
ZXlfYWlkLA0KPiArCQkJCQlrZXlzLT5hcHBfc2VxLCBrZXlzLT5pdl9pbmRleCwNCj4gKwkJCQkJ
a2V5cy0+c3ptaWMsDQo+ICsJCQkJCWtleXMtPmFrZiA/IGFwcF9rZXkgOiBkZXZfa2V5KTsNCj4g
IAkJfSBlbHNlIHsNCj4gIAkJCXNlZ19tYXggPSBTRUdfTUFYKGtleXMtPnNlZ21lbnRlZCwgYXBw
X21zZ19sZW4gKyA0KTsNCj4gIAkJCWVuY19tc2cgPSBsX21hbGxvYyhhcHBfbXNnX2xlbiArIDQp
Ow0KPiAtCQkJbWVzaF9jcnlwdG9fYXBwbGljYXRpb25fZW5jcnlwdChrZXlfYWlkLCBrZXlzLT5h
cHBfc2VxLA0KPiAtCQkJCQlrZXlzLT5uZXRfc3JjLCBrZXlzLT5uZXRfZHN0LA0KPiAtCQkJCQlr
ZXlzLT5pdl9pbmRleCwNCj4gLQkJCQkJa2V5cy0+YWtmID8gYXBwX2tleSA6IGRldl9rZXksDQo+
IC0JCQkJCWFhZCwgYWFkX2xlbiwNCj4gLQkJCQkJYXBwX21zZywgYXBwX21zZ19sZW4sDQo+IC0J
CQkJCWVuY19tc2csICZhcHBfbWljMzIsIHNpemVvZihhcHBfbWljMzIpKTsNCj4gLQkJCWxfcHV0
X2JlMzIoYXBwX21pYzMyLCBlbmNfbXNnICsgYXBwX21zZ19sZW4pOw0KPiArDQo+ICsJCQltZXNo
X2NyeXB0b19wYXlsb2FkX2VuY3J5cHQoYWFkLCBhcHBfbXNnLA0KPiArCQkJCQllbmNfbXNnLCBh
cHBfbXNnX2xlbiwNCj4gKwkJCQkJa2V5cy0+bmV0X3NyYywga2V5cy0+bmV0X2RzdCwga2V5X2Fp
ZCwNCj4gKwkJCQkJa2V5cy0+YXBwX3NlcSwga2V5cy0+aXZfaW5kZXgsDQo+ICsJCQkJCWtleXMt
PnN6bWljLA0KPiArCQkJCQlrZXlzLT5ha2YgPyBhcHBfa2V5IDogZGV2X2tleSk7DQo+ICAJCX0N
Cj4gIA0KPiAgCQlpZiAoa2V5cy0+ZGV2X2tleSAmJiAha2V5cy0+YWtmKQ0KPiBAQCAtMTA1Nywx
MCArMTA1NiwxMiBAQCBzdGF0aWMgdm9pZCBjaGVja19lbmNyeXB0KGNvbnN0IHN0cnVjdCBtZXNo
X2NyeXB0b190ZXN0ICprZXlzKQ0KPiAgCQl2ZXJpZnlfZGF0YSgiRW5jcnlwdGVkQXBwUGF5bG9h
ZCIsIDAsIGtleXMtPmVuY19tc2csIGVuY19tc2csDQo+ICAJCQkJCQkJCWFwcF9tc2dfbGVuKTsN
Cj4gIAkJaWYgKGtleXMtPnN6bWljKSB7DQo+ICsJCQlhcHBfbWljNjQgPSBsX2dldF9iZTY0KGVu
Y19tc2cgKyBhcHBfbXNnX2xlbik7DQo+ICAJCQl2ZXJpZnlfdWludDY0KCJBcHBsaWNhdGlvbk1J
QyIsIGFwcF9tc2dfbGVuLA0KPiAgCQkJCQkJa2V5cy0+YXBwX21pYzY0LCBhcHBfbWljNjQpOw0K
PiAgCQkJYXBwX21zZ19sZW4gKz0gODsNCj4gIAkJfSBlbHNlIHsNCj4gKwkJCWFwcF9taWMzMiA9
IGxfZ2V0X2JlMzIoZW5jX21zZyArIGFwcF9tc2dfbGVuKTsNCj4gIAkJCXZlcmlmeV91aW50MzIo
IkFwcGxpY2F0aW9uTUlDIiwgYXBwX21zZ19sZW4sDQo+ICAJCQkJCQlrZXlzLT5hcHBfbWljMzIs
IGFwcF9taWMzMik7DQo+ICAJCQlhcHBfbXNnX2xlbiArPSA0Ow0KPiBAQCAtMTE3MiwyMCArMTE3
MywxOCBAQCBzdGF0aWMgdm9pZCBjaGVja19lbmNyeXB0KGNvbnN0IHN0cnVjdCBtZXNoX2NyeXB0
b190ZXN0ICprZXlzKQ0KPiAgCQkJCQlrZXlzLT5uZXRfc2VxW2ldLCBrZXlzLT5uZXRfc3JjLA0K
PiAgCQkJCQlrZXlzLT5pdl9pbmRleCwgbmV0X25vbmNlKTsNCj4gIA0KPiAtCQkJdmVyaWZ5X2Rh
dGEoIlRyYW5zcG9ydERhdGEiLCA5LCBrZXlzLT50cmFuc19wa3RbaV0sDQo+ICsJCXZlcmlmeV9k
YXRhKCJUcmFuc3BvcnREYXRhIiwgOSwga2V5cy0+dHJhbnNfcGt0W2ldLA0KPiAgCQkJCQkJCXBh
Y2tldCArIDksIHNlZ19sZW4pOw0KPiAgDQo+ICAJCXZlcmlmeV91aW50MTYoIkRTVCIsIDcsIGtl
eXMtPm5ldF9kc3QsIGxfZ2V0X2JlMTYocGFja2V0ICsgNykpOw0KPiAgCQluZXRfbXNnX2xlbiA9
IHNlZ19sZW4gKyAyOw0KPiAgCQlzaG93X2RhdGEoIlRyYW5zcG9ydFBheWxvYWQiLCA3LCBwYWNr
ZXQgKyA3LCBuZXRfbXNnX2xlbik7DQo+ICANCj4gLQkJbWVzaF9jcnlwdG9fbmV0d29ya19lbmNy
eXB0KGtleXMtPmN0bCwNCj4gLQkJCQlrZXlzLT5uZXRfdHRsLCBrZXlzLT5uZXRfc2VxW2ldLA0K
PiAtCQkJCWtleXMtPm5ldF9zcmMsDQo+IC0JCQkJa2V5cy0+aXZfaW5kZXgsIGVuY19rZXksDQo+
IC0JCQkJcGFja2V0ICsgNywgc2VnX2xlbiArIDIsIHBhY2tldCArIDcsDQo+IC0JCQkJa2V5cy0+
Y3RsID8gKHZvaWQgKikmbmV0X21pYzY0IDoNCj4gLQkJCQkJCQkodm9pZCAqKSZuZXRfbWljMzIp
Ow0KPiArCQltZXNoX2NyeXB0b19wYWNrZXRfZW5jcnlwdChwYWNrZXQsIHBhY2tldF9sZW4sIGVu
Y19rZXksDQo+ICsJCQkJCQlrZXlzLT5pdl9pbmRleCwgZmFsc2UsDQo+ICsJCQkJCQlrZXlzLT5j
dGwsIGtleXMtPm5ldF90dGwsDQo+ICsJCQkJCQlrZXlzLT5uZXRfc2VxW2ldLA0KPiArCQkJCQkJ
a2V5cy0+bmV0X3NyYyk7DQo+ICANCj4gIAkJbWVzaF9jcnlwdG9fcHJpdmFjeV9jb3VudGVyKGtl
eXMtPml2X2luZGV4LCBwYWNrZXQgKyA3LA0KPiAgCQkJCQkJCQlwcml2X3JhbmQpOw0KPiBAQCAt
MTIwOCwyMCArMTIwNywyMyBAQCBzdGF0aWMgdm9pZCBjaGVja19lbmNyeXB0KGNvbnN0IHN0cnVj
dCBtZXNoX2NyeXB0b190ZXN0ICprZXlzKQ0KPiAgCQl2ZXJpZnlfZGF0YSgiRW5jTmV0d29ya1Bh
eWxvYWQiLCA3LCBrZXlzLT5uZXRfbXNnW2ldLA0KPiAgCQkJCQkJcGFja2V0ICsgNywgbmV0X21z
Z19sZW4pOw0KPiAgCQlpZiAoa2V5cy0+Y3RsKSB7DQo+ICsJCQluZXRfbWljNjQgPSBsX2dldF9i
ZTY0KHBhY2tldCArIHBhY2tldF9sZW4gLSA4KTsNCj4gIAkJCXZlcmlmeV91aW50NjQoIk5ldHdv
cmtNSUMiLCA3ICsgbmV0X21zZ19sZW4sDQo+ICAJCQkJCQlrZXlzLT5uZXRfbWljNjQsIG5ldF9t
aWM2NCk7DQo+ICAJCQluZXRfbXNnX2xlbiArPSA4Ow0KPiAgCQl9IGVsc2Ugew0KPiArCQkJbmV0
X21pYzMyID0gbF9nZXRfYmUzMihwYWNrZXQgKyBwYWNrZXRfbGVuIC0gNCk7DQo+ICAJCQl2ZXJp
ZnlfdWludDMyKCJOZXR3b3JrTUlDIiwgNyArIG5ldF9tc2dfbGVuLA0KPiAgCQkJCQkJa2V5cy0+
bmV0X21pYzMyW2ldLCBuZXRfbWljMzIpOw0KPiAgCQkJbmV0X21zZ19sZW4gKz0gNDsNCj4gIAkJ
fQ0KPiAgDQo+ICAJCXNob3dfZGF0YSgiUHJlT2JzUGF5bG9hZCIsIDEsIHBhY2tldCArIDEsIDYg
KyBuZXRfbXNnX2xlbik7DQo+IC0JCW1lc2hfY3J5cHRvX25ldHdvcmtfb2JmdXNjYXRlKHByaXZf
a2V5LCBwcml2X3JhbmQsDQo+IC0JCQkJa2V5cy0+Y3RsLA0KPiAtCQkJCWtleXMtPm5ldF90dGws
IGtleXMtPm5ldF9zZXFbaV0sDQo+IC0JCQkJa2V5cy0+bmV0X3NyYywgcGFja2V0ICsgMSk7DQo+
ICsJCW1lc2hfY3J5cHRvX25ldHdvcmtfb2JmdXNjYXRlKHBhY2tldCwgcHJpdl9rZXksDQo+ICsJ
CQkJCWtleXMtPml2X2luZGV4LA0KPiArCQkJCQlrZXlzLT5jdGwsIGtleXMtPm5ldF90dGwsDQo+
ICsJCQkJCWtleXMtPm5ldF9zZXFbaV0sIGtleXMtPm5ldF9zcmMpOw0KPiArDQo+ICAJCXNob3df
ZGF0YSgiUG9zdE9ic1BheWxvYWQiLCAxLCBwYWNrZXQgKyAxLCA2ICsgbmV0X21zZ19sZW4pOw0K
PiAgDQo+ICAJCXBhY2tldFswXSA9IChrZXlzLT5pdl9pbmRleCAmIDB4MDEpIDw8IDcgfCBuaWQ7
DQo+IEBAIC0xMjQyLDcgKzEyNDQsNyBAQCBkb25lOg0KPiAgDQo+ICBzdGF0aWMgdm9pZCBjaGVj
a19kZWNyeXB0X3NlZ21lbnQoY29uc3Qgc3RydWN0IG1lc2hfY3J5cHRvX3Rlc3QgKmtleXMsDQo+
ICAJCQkJdWludDE2X3Qgc2VnLCB1aW50MTZfdCBzZWdfbWF4LA0KPiAtCQkJCWNvbnN0IHVpbnQ4
X3QgKnBrdCwgdWludDhfdCBwa3RfbGVuLA0KPiArCQkJCXVpbnQ4X3QgKnBrdCwgdWludDhfdCBw
a3RfbGVuLA0KPiAgCQkJCWNvbnN0IHVpbnQ4X3QgKm1zZywgdWludDhfdCBtc2dfbGVuLA0KPiAg
CQkJCXVpbnQ4X3QgKmVuY19rZXksIHVpbnQ4X3QgKnByaXZfa2V5LA0KPiAgCQkJCXVpbnQ4X3Qg
bmlkKQ0KPiBAQCAtMTI3NCwyNiArMTI3NiwzMCBAQCBzdGF0aWMgdm9pZCBjaGVja19kZWNyeXB0
X3NlZ21lbnQoY29uc3Qgc3RydWN0IG1lc2hfY3J5cHRvX3Rlc3QgKmtleXMsDQo+ICAJaWYgKGN0
bCkgew0KPiAgCQluZXRfbWljNjQgPSBsX2dldF9iZTY0KHBrdCArIHBrdF9sZW4gLSA4KTsNCj4g
IAkJc2hvd19kYXRhKCJFbmNyeXB0ZWRQYXlsb2FkIiwgNywgcGt0ICsgNywgcGt0X2xlbiAtIDcg
LSA4KTsNCj4gLQkJbWVzaF9jcnlwdG9fbmV0d29ya19kZWNyeXB0KGN0bCwgdHRsLCBzZXEsDQo+
IC0JCQkJc3JjLCBrZXlzLT5pdl9pbmRleCwgZW5jX2tleSwNCj4gLQkJCQlwa3QgKyA3LCBwa3Rf
bGVuIC0gNywgbmV0X2NsciArIDcsDQo+IC0JCQkJJmNhbGNfbmV0X21pYzY0LA0KPiAtCQkJCXNp
emVvZihjYWxjX25ldF9taWM2NCkpOw0KPiArDQo+ICsJCW1lc2hfY3J5cHRvX3BhY2tldF9kZWNy
eXB0KHBrdCwgcGt0X2xlbiwNCj4gKwkJCQkJCQllbmNfa2V5LA0KPiArCQkJCQkJCWtleXMtPml2
X2luZGV4LCBmYWxzZSwNCj4gKwkJCQkJCQljdGwsIHR0bCwgc2VxLA0KPiArCQkJCQkJCXNyYyk7
DQo+ICsJCWNhbGNfbmV0X21pYzY0ID0gbF9nZXRfYmU2NChwa3QgKyBwa3RfbGVuIC0gOCk7DQo+
ICsNCj4gIAkJdmVyaWZ5X3VpbnQ2NCgiTmV0d29ya01JQyIsIHBrdF9sZW4gLSA4LCBuZXRfbWlj
NjQsDQo+IC0JCQkJY2FsY19uZXRfbWljNjQpOw0KPiArCQkJCQkJbmV0X21pYzY0IF4gY2FsY19u
ZXRfbWljNjQpOw0KPiAgCQlzaG93X2RhdGEoIkRlY3J5cHRlZFBheWxvYWQiLCA3LCBuZXRfY2xy
ICsgNywgcGt0X2xlbiAtIDcgLSA4KTsNCj4gIAl9IGVsc2Ugew0KPiAgCQluZXRfbWljMzIgPSBs
X2dldF9iZTMyKHBrdCArIHBrdF9sZW4gLSA0KTsNCj4gIAkJc2hvd19kYXRhKCJFbmNyeXB0ZWRQ
YXlsb2FkIiwgNywgcGt0ICsgNywgcGt0X2xlbiAtIDcgLSA0KTsNCj4gIA0KPiAtCQltZXNoX2Ny
eXB0b19uZXR3b3JrX2RlY3J5cHQoY3RsLCB0dGwsIHNlcSwNCj4gLQkJCQlzcmMsIGtleXMtPml2
X2luZGV4LCBlbmNfa2V5LA0KPiAtCQkJCXBrdCArIDcsIHBrdF9sZW4gLSA3LCBuZXRfY2xyICsg
NywNCj4gLQkJCQkmY2FsY19uZXRfbWljMzIsDQo+IC0JCQkJc2l6ZW9mKGNhbGNfbmV0X21pYzMy
KSk7DQo+ICsJCW1lc2hfY3J5cHRvX3BhY2tldF9kZWNyeXB0KHBrdCwgcGt0X2xlbiwNCj4gKwkJ
CQkJCQllbmNfa2V5LA0KPiArCQkJCQkJCWtleXMtPml2X2luZGV4LCBmYWxzZSwNCj4gKwkJCQkJ
CQljdGwsIHR0bCwgc2VxLA0KPiArCQkJCQkJCXNyYyk7DQo+ICsJCWNhbGNfbmV0X21pYzMyID0g
bF9nZXRfYmUzMihwa3QgKyBwa3RfbGVuIC0gNCk7DQo+ICANCj4gIAkJdmVyaWZ5X3VpbnQzMigi
TmV0d29ya01JQyIsIHBrdF9sZW4gLSA0LCBuZXRfbWljMzIsDQo+IC0JCQkJY2FsY19uZXRfbWlj
MzIpOw0KPiArCQkJCQkJbmV0X21pYzMyIF4gY2FsY19uZXRfbWljMzIpOw0KPiAgCQlzaG93X2Rh
dGEoIkRlY3J5cHRlZFBheWxvYWQiLCA3LCBuZXRfY2xyICsgNywgcGt0X2xlbiAtIDcgLSA0KTsN
Cj4gIAl9DQo+ICANCj4gQEAgLTEzODcsMTUgKzEzOTMsMTEgQEAgc3RhdGljIHZvaWQgY2hlY2tf
ZGVjcnlwdChjb25zdCBzdHJ1Y3QgbWVzaF9jcnlwdG9fdGVzdCAqa2V5cykNCj4gIAl1aW50OF90
ICphcHBfa2V5Ow0KPiAgCXVpbnQ4X3QgKm5ldF9rZXk7DQo+ICAJdWludDhfdCBlbmNfa2V5WzE2
XTsNCj4gLQl1aW50OF90IG5ldF9ub25jZVsxM107DQo+IC0JdWludDhfdCBhcHBfbm9uY2VbMTNd
Ow0KPiAgCXVpbnQ4X3QgcHJpdl9rZXlbMTZdOw0KPiAtCXVpbnQ4X3QgcHJpdl9yYW5kWzE2XTsN
Cj4gIAl1aW50OF90IHBbOV07DQo+ICAJc2l6ZV90IHBfbGVuOw0KPiAgCXVpbnQ4X3QgKnBhY2tl
dCA9IE5VTEw7DQo+ICAJc2l6ZV90IHBhY2tldF9sZW47DQo+IC0JY29uc3QgdWludDhfdCAqbmV0
X2hkcjsNCj4gIAl1aW50OF90ICpuZXRfbXNnOw0KPiAgCXVpbnQ4X3QgbmV0X21zZ19sZW47DQo+
ICAJdWludDE2X3QgYXBwX21zZ19sZW4gPSAwOw0KPiBAQCAtMTQ2OSw5ICsxNDcxLDYgQEAgc3Rh
dGljIHZvaWQgY2hlY2tfZGVjcnlwdChjb25zdCBzdHJ1Y3QgbWVzaF9jcnlwdG9fdGVzdCAqa2V5
cykNCj4gIAkJZ290byBkb25lOw0KPiAgCX0NCj4gIA0KPiAtCW1lc2hfY3J5cHRvX2FwcGxpY2F0
aW9uX25vbmNlKGtleXMtPmFwcF9zZXEsIGtleXMtPm5ldF9zcmMsDQo+IC0JCQkJCQlrZXlzLT5u
ZXRfZHN0LCBrZXlzLT5pdl9pbmRleCwNCj4gLQkJCQkJCWtleXMtPnN6bWljLCBhcHBfbm9uY2Up
Ow0KPiAgCWFwcF9tc2cgPSBsX21hbGxvYygzODQpOw0KPiAgDQo+ICAJc2VnX21heCA9IChzaXpl
b2Yoa2V5cy0+cGFja2V0KSAvIHNpemVvZihrZXlzLT5wYWNrZXRbMF0pKSAtIDE7DQo+IEBAIC0x
NDgzLDE5ICsxNDgyLDEzIEBAIHN0YXRpYyB2b2lkIGNoZWNrX2RlY3J5cHQoY29uc3Qgc3RydWN0
IG1lc2hfY3J5cHRvX3Rlc3QgKmtleXMpDQo+ICAJCWlmIChrZXlzLT5zZWdtZW50ZWQpDQo+ICAJ
CQlsX2luZm8oQ09MT1JfWUVMTE9XICJTZWdtZW50LSVkIiBDT0xPUl9PRkYsIGkpOw0KPiAgDQo+
IC0JCW1lc2hfY3J5cHRvX25ldHdvcmtfbm9uY2Uoa2V5cy0+ZnJuZCwga2V5cy0+bmV0X3R0bCwN
Cj4gLQkJCQlrZXlzLT5uZXRfc2VxW2ldLCBrZXlzLT5uZXRfc3JjLCBrZXlzLT5pdl9pbmRleCwN
Cj4gLQkJCQluZXRfbm9uY2UpOw0KPiAgCQlsX2ZyZWUocGFja2V0KTsNCj4gIAkJcGFja2V0ID0g
bF91dGlsX2Zyb21faGV4c3RyaW5nKGtleXMtPnBhY2tldFtpXSwgJnBhY2tldF9sZW4pOw0KPiAg
DQo+IC0JCW5ldF9oZHIgPSBwYWNrZXQgKyAxOw0KPiAgCQluZXRfbXNnID0gcGFja2V0ICsgNzsN
Cj4gIAkJbmV0X21zZ19sZW4gPSBwYWNrZXRfbGVuIC0gNzsNCj4gIA0KPiAtCQltZXNoX2NyeXB0
b19wcml2YWN5X2NvdW50ZXIoa2V5cy0+aXZfaW5kZXgsIG5ldF9tc2csIHByaXZfcmFuZCk7DQo+
IC0NCj4gLQkJbWVzaF9jcnlwdG9fbmV0d29ya19jbGFyaWZ5KHByaXZfa2V5LCBwcml2X3JhbmQs
IG5ldF9oZHIsDQo+ICsJCW1lc2hfY3J5cHRvX25ldHdvcmtfY2xhcmlmeShwYWNrZXQsIHByaXZf
a2V5LCBrZXlzLT5pdl9pbmRleCwNCj4gIAkJCQkmbmV0X2N0bCwgJm5ldF90dGwsICZuZXRfc2Vx
LCAmbmV0X3NyYyk7DQo+ICANCj4gIAkJc2hvd19zdHIoIlBhY2tldCIsIDAsIGtleXMtPnBhY2tl
dFtpXSk7DQo+IEBAIC0xNTA0LDI5ICsxNDk3LDMxIEBAIHN0YXRpYyB2b2lkIGNoZWNrX2RlY3J5
cHQoY29uc3Qgc3RydWN0IG1lc2hfY3J5cHRvX3Rlc3QgKmtleXMpDQo+ICAJCQluZXRfbWljNjQg
PSBsX2dldF9iZTY0KHBhY2tldCArIHBhY2tldF9sZW4gLSA4KTsNCj4gIAkJCXNob3dfZGF0YSgi
TmV0d29ya01lc3NhZ2UiLCA3LCBuZXRfbXNnLA0KPiAgCQkJCQkJCW5ldF9tc2dfbGVuIC0gOCk7
DQo+IC0JCQltZXNoX2NyeXB0b19uZXR3b3JrX2RlY3J5cHQobmV0X2N0bCwgbmV0X3R0bCwgbmV0
X3NlcSwNCj4gLQkJCQkJbmV0X3NyYywga2V5cy0+aXZfaW5kZXgsIGVuY19rZXksDQo+IC0JCQkJ
CW5ldF9tc2csIG5ldF9tc2dfbGVuLCBuZXRfbXNnLA0KPiAtCQkJCQkmY2FsY19uZXRfbWljNjQs
DQo+IC0JCQkJCXNpemVvZihjYWxjX25ldF9taWM2NCkpOw0KPiArCQkJbWVzaF9jcnlwdG9fcGFj
a2V0X2RlY3J5cHQocGFja2V0LCBwYWNrZXRfbGVuLA0KPiArCQkJCQkJZW5jX2tleSwNCj4gKwkJ
CQkJCWtleXMtPml2X2luZGV4LCBmYWxzZSwNCj4gKwkJCQkJCW5ldF9jdGwsIG5ldF90dGwsDQo+
ICsJCQkJCQluZXRfc2VxLA0KPiArCQkJCQkJbmV0X3NyYyk7DQo+ICsJCQljYWxjX25ldF9taWM2
NCA9IGxfZ2V0X2JlNjQocGFja2V0ICsgcGFja2V0X2xlbiAtIDgpOw0KPiAgCQkJbmV0X21zZ19s
ZW4gLT0gODsNCj4gIAkJCXZlcmlmeV91aW50NjQoIk5ldHdvcmtNSUMiLCA3ICsgbmV0X21zZ19s
ZW4sIG5ldF9taWM2NCwNCj4gLQkJCQkJCQkJY2FsY19uZXRfbWljNjQpOw0KPiArCQkJCQkJbmV0
X21pYzY0IF4gY2FsY19uZXRfbWljNjQpOw0KPiAgCQkJc2hvd19kYXRhKCJEZWNyeXB0ZWROZXR3
b3JrIiwgNywgbmV0X21zZywgbmV0X21zZ19sZW4pOw0KPiAgCQl9IGVsc2Ugew0KPiAgCQkJbmV0
X21pYzMyID0gbF9nZXRfYmUzMihwYWNrZXQgKyBwYWNrZXRfbGVuIC0gNCk7DQo+ICAJCQlzaG93
X2RhdGEoIk5ldHdvcmtNZXNzYWdlIiwgNywgbmV0X21zZywNCj4gIAkJCQkJCQluZXRfbXNnX2xl
biAtIDQpOw0KPiAtDQo+IC0JCQltZXNoX2NyeXB0b19uZXR3b3JrX2RlY3J5cHQobmV0X2N0bCwg
bmV0X3R0bCwgbmV0X3NlcSwNCj4gLQkJCQkJbmV0X3NyYywga2V5cy0+aXZfaW5kZXgsIGVuY19r
ZXksDQo+IC0JCQkJCW5ldF9tc2csIG5ldF9tc2dfbGVuLCBuZXRfbXNnLA0KPiAtCQkJCQkmY2Fs
Y19uZXRfbWljMzIsDQo+IC0JCQkJCXNpemVvZihjYWxjX25ldF9taWMzMikpOw0KPiAtDQo+ICsJ
CQltZXNoX2NyeXB0b19wYWNrZXRfZGVjcnlwdChwYWNrZXQsIHBhY2tldF9sZW4sDQo+ICsJCQkJ
CQllbmNfa2V5LA0KPiArCQkJCQkJa2V5cy0+aXZfaW5kZXgsIGZhbHNlLA0KPiArCQkJCQkJbmV0
X2N0bCwgbmV0X3R0bCwNCj4gKwkJCQkJCW5ldF9zZXEsDQo+ICsJCQkJCQluZXRfc3JjKTsNCj4g
KwkJCWNhbGNfbmV0X21pYzMyID0gbF9nZXRfYmUzMihwYWNrZXQgKyBwYWNrZXRfbGVuIC0gNCk7
DQo+ICAJCQluZXRfbXNnX2xlbiAtPSA0Ow0KPiAgCQkJdmVyaWZ5X3VpbnQzMigiTmV0d29ya01J
QyIsIDcgKyBuZXRfbXNnX2xlbiwgbmV0X21pYzMyLA0KPiAtCQkJCQkJCQljYWxjX25ldF9taWMz
Mik7DQo+ICsJCQkJCQluZXRfbWljMzIgXiBjYWxjX25ldF9taWMzMik7DQo+ICAJCQlzaG93X2Rh
dGEoIkRlY3J5cHRlZE5ldHdvcmsiLCA3LCBuZXRfbXNnLCBuZXRfbXNnX2xlbik7DQo+ICAJCX0N
Cj4gIA0KPiBAQCAtMTY0NSw4ICsxNjQwLDggQEAgc3RhdGljIHZvaWQgY2hlY2tfZGVjcnlwdChj
b25zdCBzdHJ1Y3QgbWVzaF9jcnlwdG9fdGVzdCAqa2V5cykNCj4gIAkJCQlwYWNrZXQsICZwa3Rf
bGVuKTsNCj4gIAkJdmVyaWZ5X2RhdGEoIlRyYW5zcG9ydERhdGEiLCA5LCBrZXlzLT50cmFuc19w
a3RbaV0sIHBhY2tldCArIDksDQo+ICAJCQkJCQkJCXBheWxvYWRfbGVuKTsNCj4gLQkJbWVzaF9j
cnlwdG9fcGFja2V0X2VuY29kZShwYWNrZXQsIHBrdF9sZW4sIGVuY19rZXksDQo+IC0JCQkJCQlr
ZXlzLT5pdl9pbmRleCwgcHJpdl9rZXkpOw0KPiArCQltZXNoX2NyeXB0b19wYWNrZXRfZW5jb2Rl
KHBhY2tldCwgcGt0X2xlbiwga2V5cy0+aXZfaW5kZXgsDQo+ICsJCQkJCQkJZW5jX2tleSwgcHJp
dl9rZXkpOw0KPiAgCQltZXNoX2NyeXB0b19wYWNrZXRfbGFiZWwocGFja2V0LCBwa3RfbGVuLCBr
ZXlzLT5pdl9pbmRleCwgbmlkKTsNCj4gIA0KPiAgCQl2ZXJpZnlfZGF0YSgiRW5jb2RlZC1QYWNr
ZXQiLCAwLCBrZXlzLT5wYWNrZXRbaV0sIHBhY2tldCwNCj4gQEAgLTE2NjYsMzkgKzE2NjEsNDUg
QEAgc3RhdGljIHZvaWQgY2hlY2tfZGVjcnlwdChjb25zdCBzdHJ1Y3QgbWVzaF9jcnlwdG9fdGVz
dCAqa2V5cykNCj4gIAkJCQkJCQlhcHBfbXNnX2xlbiAtIDgpOw0KPiAgCQlhcHBfbWljNjQgPSBs
X2dldF9iZTY0KGFwcF9tc2cgKyBhcHBfbXNnX2xlbiAtIDgpOw0KPiAgDQo+IC0JCW1lc2hfY3J5
cHRvX2FwcGxpY2F0aW9uX2RlY3J5cHQoDQo+IC0JCQkJa2V5c19haWQgfCAoa2V5cy0+YWtmID8g
S0VZX0lEX0FLRiA6IDApLA0KPiAtCQkJCXNlcVplcm8sIG5ldF9zcmMsDQo+IC0JCQkJbmV0X2Rz
dCwga2V5cy0+aXZfaW5kZXgsDQo+IC0JCQkJa2V5cy0+YWtmID8gYXBwX2tleSA6IGRldl9rZXks
DQo+ICsJCW1lc2hfY3J5cHRvX3BheWxvYWRfZGVjcnlwdCgNCj4gIAkJCQlhYWQsIGFhZF9sZW4s
DQo+ICAJCQkJYXBwX21zZywgYXBwX21zZ19sZW4sDQo+IC0JCQkJYXBwX21zZywgJmNhbGNfYXBw
X21pYzY0LA0KPiAtCQkJCXNpemVvZihjYWxjX2FwcF9taWM2NCkpOw0KPiArCQkJCXRydWUsDQo+
ICsJCQkJbmV0X3NyYywgbmV0X2RzdCwNCj4gKwkJCQlrZXlzLT5ha2YgPyBrZXlzX2FpZCB8IEtF
WV9JRF9BS0YgOiBBUFBfQUlEX0RFViwNCj4gKwkJCQlzZXFaZXJvLA0KPiArCQkJCWtleXMtPml2
X2luZGV4LA0KPiArCQkJCWFwcF9tc2csDQo+ICsJCQkJa2V5cy0+YWtmID8gYXBwX2tleSA6IGRl
dl9rZXkpOw0KPiArDQo+ICsJCWNhbGNfYXBwX21pYzY0ID0gbF9nZXRfYmU2NChhcHBfbXNnICsg
YXBwX21zZ19sZW4gLSA4KTsNCj4gIA0KPiAgCQl2ZXJpZnlfZGF0YSgiUGF5bG9hZCIsIDAsIGtl
eXMtPmFwcF9tc2csIGFwcF9tc2csDQo+ICAJCQkJCQkJYXBwX21zZ19sZW4gLSA4KTsNCj4gIAkJ
dmVyaWZ5X3VpbnQ2NCgiQXBwbGljYXRpb25NSUMiLCBhcHBfbXNnX2xlbiAtIDgsIGFwcF9taWM2
NCwNCj4gLQkJCQkJCQkJY2FsY19hcHBfbWljNjQpOw0KPiArCQkJCQkJYXBwX21pYzY0IF4gY2Fs
Y19hcHBfbWljNjQpOw0KPiAgCX0gZWxzZSBpZiAoIWtleXMtPmN0bCkgew0KPiAgCQl2ZXJpZnlf
ZGF0YSgiRW5jcnlwdGVkUGF5bG9hZCIsIDAsIGtleXMtPmVuY19tc2csIGFwcF9tc2csDQo+ICAJ
CQkJCQkJYXBwX21zZ19sZW4gLSA0KTsNCj4gIAkJYXBwX21pYzMyID0gbF9nZXRfYmUzMihhcHBf
bXNnICsgYXBwX21zZ19sZW4gLSA0KTsNCj4gIA0KPiAtCQltZXNoX2NyeXB0b19hcHBsaWNhdGlv
bl9kZWNyeXB0KA0KPiAtCQkJCWtleXNfYWlkIHwgKGtleXMtPmFrZiA/IEtFWV9JRF9BS0YgOiAw
KSwNCj4gLQkJCQlzZXFaZXJvLCBuZXRfc3JjLA0KPiAtCQkJCW5ldF9kc3QsIGtleXMtPml2X2lu
ZGV4LA0KPiAtCQkJCWtleXMtPmFrZiA/IGFwcF9rZXkgOiBkZXZfa2V5LA0KPiArCQltZXNoX2Ny
eXB0b19wYXlsb2FkX2RlY3J5cHQoDQo+ICAJCQkJYWFkLCBhYWRfbGVuLA0KPiAgCQkJCWFwcF9t
c2csIGFwcF9tc2dfbGVuLA0KPiAtCQkJCWFwcF9tc2csICZjYWxjX2FwcF9taWMzMiwNCj4gLQkJ
CQlzaXplb2YoY2FsY19hcHBfbWljMzIpKTsNCj4gKwkJCQlmYWxzZSwNCj4gKwkJCQluZXRfc3Jj
LCBuZXRfZHN0LA0KPiArCQkJCWtleXMtPmFrZiA/IGtleXNfYWlkIHwgS0VZX0lEX0FLRiA6IEFQ
UF9BSURfREVWLA0KPiArCQkJCXNlcVplcm8sDQo+ICsJCQkJa2V5cy0+aXZfaW5kZXgsDQo+ICsJ
CQkJYXBwX21zZywNCj4gKwkJCQlrZXlzLT5ha2YgPyBhcHBfa2V5IDogZGV2X2tleSk7DQo+ICsN
Cj4gKwkJY2FsY19hcHBfbWljMzIgPSBsX2dldF9iZTY0KGFwcF9tc2cgKyBhcHBfbXNnX2xlbiAt
IDQpOw0KPiAgDQo+ICAJCXZlcmlmeV9kYXRhKCJQYXlsb2FkIiwgMCwga2V5cy0+YXBwX21zZywg
YXBwX21zZywNCj4gIAkJCQkJCQlhcHBfbXNnX2xlbiAtIDQpOw0KPiAgCQl2ZXJpZnlfdWludDMy
KCJBcHBsaWNhdGlvbk1JQyIsIGFwcF9tc2dfbGVuIC0gNCwgYXBwX21pYzMyLA0KPiAtCQkJCQkJ
CQljYWxjX2FwcF9taWMzMik7DQo+ICsJCQkJCQlhcHBfbWljMzIgXiBjYWxjX2FwcF9taWMzMik7
DQo+ICAJfQ0KPiAgDQo+ICBkb25lOg0K
